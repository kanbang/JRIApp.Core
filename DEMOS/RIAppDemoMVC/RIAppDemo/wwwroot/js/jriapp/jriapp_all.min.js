var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__createBinding=this&&this.__createBinding||(Object.create?function(n,t,i,r){r===undefined&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){r===undefined&&(r=i);n[r]=t[i]}),__exportStar=this&&this.__exportStar||function(n,t){for(var i in n)i==="default"||Object.prototype.hasOwnProperty.call(t,i)||__createBinding(t,n,i)};define("jriapp_shared/consts",["require","exports"],function(n,t){"use strict";var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});t.DUMY_ERROR=t.APP_NAME=t.SIDE=t.BRACKETS=t.DEBUG_LEVEL=void 0,function(n){n[n.NONE=0]="NONE";n[n.NORMAL=1]="NORMAL";n[n.HIGH=2]="HIGH"}(i=t.DEBUG_LEVEL||(t.DEBUG_LEVEL={})),function(n){n[n.ROUND=0]="ROUND";n[n.CURLY=1]="CURLY";n[n.SQUARE=2]="SQUARE"}(r=t.BRACKETS||(t.BRACKETS={})),function(n){n[n.BOTH=0]="BOTH";n[n.LEFT=1]="LEFT";n[n.RIGHT=2]="RIGHT"}(u=t.SIDE||(t.SIDE={}));t.APP_NAME="app";t.DUMY_ERROR="DUMMY_ERROR"});define("jriapp_shared/utils/ipromise",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PromiseState=void 0;var i;(function(n){n[n.Pending=0]="Pending";n[n.ResolutionInProgress=1]="ResolutionInProgress";n[n.Resolved=2]="Resolved";n[n.Rejected=3]="Rejected"})(i=t.PromiseState||(t.PromiseState={}))});define("jriapp_shared/int",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TPriority=t.DebugLevel=t.Config=void 0;t.Config=jriapp_config||{};t.DebugLevel=t.Config.debugLevel?t.Config.debugLevel:0;var i;(function(n){n[n.Normal=0]="Normal";n[n.AboveNormal=1]="AboveNormal";n[n.High=2]="High"})(i=t.TPriority||(t.TPriority={}))});define("jriapp_shared/utils/checks",["require","exports"],function(n,t){"use strict";function i(n){return n===null||n===r}function e(n){return i(n)?!1:typeof n=="function"||typeof n=="object"&&n instanceof Function}function u(n){return i(n)?!1:typeof n=="string"||typeof n=="object"&&n instanceof String}function o(n){return i(n)?!1:typeof n=="number"||typeof n=="object"&&n instanceof Number}var f,r,s;Object.defineProperty(t,"__esModule",{value:!0});t.Checks=void 0;f=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;r=void 0;s=function(){function n(){}return n.isHasProp=function(n,t){return n?t in n:!1},n.isNull=function(n){return n===null},n.isUndefined=function(n){return n===r},n.isObject=function(n){return i(n)?!1:typeof n=="object"},n.isPlainObject=function(n){if(!!n&&typeof n=="object"){var t=Object.getPrototypeOf(n);return t===Object.prototype||t===null}return!1},n.isBoolean=function(n){return i(n)?!1:typeof n=="boolean"||typeof n=="object"&&n instanceof Boolean},n.isDate=function(n){return i(n)?!1:typeof n=="object"&&n instanceof Date},n.isNumeric=function(n){return o(n)||u(n)&&!isNaN(Number(n))},n.isBoolString=function(n){return i(n)?!1:n==="true"||n==="false"},n.isGuid=function(n){return u(n)&&f.test(n)},n.isArray=function(n){return n?Array.isArray(n):!1},n.isThenable=function(n){return n?typeof n=="object"&&e(n.then):!1},n._undefined=r,n.isNt=i,n.isString=u,n.isFunc=e,n.isNumber=o,n}();t.Checks=s});define("jriapp_shared/utils/strutils",["require","exports","jriapp_shared/utils/checks"],function(n,t,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});t.StringUtils=void 0;var u=void 0,e=!!"".trim,o=[" ","\t","\r","\n"],f="String format has invalid expression value: ",h=i.Checks.isFunc,c=i.Checks.isNt,s=function(){function n(){}return n.endsWith=function(n,t){return!n||!t?!1:n.substr(n.length-t.length)===t},n.startsWith=function(n,t){return!n||!t?!1:n.substr(0,t.length)===t},n.fastTrim=function(n){return n?e?n.trim():r(n,o,0):""},n.trim=function(n,t,i){var u,f;if(t===void 0&&(t=null),i===void 0&&(i=0),!n)return"";if(i===0&&!t&&e)return n.trim();var s=n.length,l=t?t:o,r=0,h=s,c;if(i===0||i===1)for(u=0;u<s;u+=1)if(c=n.charAt(u),l.indexOf(c)>-1)r=u+1;else break;if(i===0||i===2)for(f=s-1;f>=r;f-=1)if(c=n.charAt(f),l.indexOf(c)>-1)h=f;else break;return r===0&&h===s?n:h>r?n.substring(r,h):""},n.ltrim=function(n,t){return r(n,t,1)},n.rtrim=function(n,t){return r(n,t,2)},n.format=function(n){for(var r,t,u,i,y,e,a=[],o=1;o<arguments.length;o++)a[o-1]=arguments[o];for(r="",t=0;;){if(u=n.indexOf("{",t),i=n.indexOf("}",t),u<0&&i<0){r+=n.slice(t);break}if(i>0&&(i<u||u<0)){if(n.charAt(i+1)!=="}")throw new Error(f+n);r+=n.slice(t,i+1);t=i+2;continue}if(r+=n.slice(t,u),t=u+1,n.charAt(t)==="{"){r+="{";t++;continue}if(i<0)throw new Error(f+n);var s=n.substring(t,i),l=s.indexOf(":"),v=parseInt(l<0?s:s.substring(0,l),10);if(isNaN(v))throw new Error(f+n);y=l<0?"":s.substring(l+1);e=a[v];c(e)&&(e="");r+=h(e.format)?e.format(y):e.toString();t=i+1}return r},n.formatNumber=function(n,t,i,r){var e,o,h;n=(n+"").replace(/[^0-9+-Ee.]/g,"");var c=isFinite(+n)?+n:0,l=i===u?".":i,a=r===u?",":r,s=isFinite(+t)?Math.abs(t):0,f=[""],v=function(n,t){var i=Math.pow(10,t);return""+Math.round(n*i)/i};if(t===null||t===u?(f=(""+c).split("."),s=2):f=(s?v(c,s):""+Math.round(c)).split("."),o="",h=f[0].length,h>3){for(e=0;e<h;e+=1)o=o+f[0].charAt(e),e<h-1&&(h-e-1)%3==0&&(o=o+a);f[0]=o}return(f[1]||"").length<s&&(f[1]=f[1]||"",f[1]+=new Array(s-f[1].length+1).join("0")),f.join(l)},n.stripNonNumeric=function(n){var r,i,t;for(n+="",r=/^\d|\.|-$/,i="",t=0;t<n.length;t++)r.test(n.charAt(t))&&(n.charAt(t)==="."&&i.indexOf(".")!==-1||n.charAt(t)==="-"&&i.length!==0||(i+=n.charAt(t)));return i},n.padLeft=function(n,t,i){if(n||(n=""),i=i||" ",n.length>=t)return n;var r=new Array(t).join(i[0]);return(r+n).slice(-t)},n.fastPadLeft=function(n,t){return(n||(n=""),n.length>=t.length)?n:(t+n).slice(-t.length)},n.trimQuotes=function(n){var r,u;if(!n)return"";var f=n.length,i=0,e=f,t;for(r=0;r<f;r+=1)if(t=n.charAt(r),t===" "||t==="'"||t==='"')i=r+1;else break;for(u=f-1;u>=i;u-=1)if(t=n.charAt(u),t===" "||t==="'"||t==='"')e=u;else break;return i===0&&e===f?n:e>i?n.substring(i,e):""},n.trimBrackets=function(n){var r,u;if(!n)return"";var f=n.length,i=0,e=f,t;for(r=0;r<f;r+=1)if(t=n.charAt(r),t===" "||t==="[")i=r+1;else break;for(u=f-1;u>=i;u-=1)if(t=n.charAt(u),t===" "||t==="]")e=u;else break;return i===0&&e===f?n:e>i?n.substring(i,e):""},n}();t.StringUtils=s;r=s.trim});define("jriapp_shared/utils/coreutils",["require","exports","jriapp_shared/utils/strutils","jriapp_shared/utils/checks"],function(n,t,i,r){"use strict";function f(){return Object.create(null)}function o(n,t){var r,f,u,i,s;if(!n)return n;if(k(n))for(r=[],u=n.length,i=0;i<u;i+=1)r.push(o(n[i],null));else if(e(n))for(r=t||{},f=nt(n),u=f.length,i=0;i<u;i+=1)s=f[i],r[s]=o(n[s],null);else r=n;return r}function a(n){for(var h,r,t,l,v,f,e,a,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];if(s(n))throw new TypeError("extend: Cannot convert first argument to object");for(h=Object(n),r=0;r<o.length;r++)if(t=o[r],t!==u&&t!==null)for(l=c(Object(t)),v=l.length,f=0;f<v;f++)e=l[f],a=tt(t,e),a!==u&&a.enumerable&&(h[e]=t[e]);return h}function v(n,t){var f,o,i;if(s(n)&&(n={}),!e(t))return n;for(f=c(t),o=f.length,i=0;i<o;i+=1){var r=f[i],h=n[r],u=t[r];e(u)?n[r]=v(h,u):d(u)&&(n[r]=u)}return n}var y,p;Object.defineProperty(t,"__esModule",{value:!0});t.CoreUtils=void 0;var w=r.Checks.isHasProp,u=r.Checks._undefined,b=r.Checks.isBoolean,k=r.Checks.isArray,e=r.Checks.isPlainObject,s=r.Checks.isNt,d=r.Checks.isString,h=i.StringUtils.format,g=i.StringUtils.fastTrim,nt=Object.getOwnPropertyNames,tt=Object.getOwnPropertyDescriptor,c=Object.keys,it="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),l=f();y="an Object with the name: {0} is already registered and can not be overwritten";p=function(){function n(){}return n.getNewID=function(n){n===void 0&&(n="*");var t=l[n]||0;return l[n]=t+1,n==="*"?t.toString(36):n+"_"+t.toString(36)},n.setValue=function(n,t,i,r){var o,c;r===void 0&&(r=!1);var s=t.split("."),l=s.length,e=n;for(o=0;o<l-1;o+=1)e[s[o]]||(e[s[o]]=f()),e=e[s[o]];if(c=s[l-1],!!r&&e[c]!==u)throw new Error(h(y,t));e[c]=i},n.getValue=function(n,t){for(var f=t.split("."),i,e=n,r=0;r<f.length;r+=1){if(i=e[f[r]],i===u)return null;e=i}return i},n.removeValue=function(n,t){for(var e,o,i=t.split("."),r=n,f=0;f<i.length-1;f+=1){if(!r[i[f]])return null;r=r[i[f]]}return e=i[i.length-1],o=r[e],o!==u&&delete r[e],o},n.uuid=function(n,t){var i,f=it,r=[],e=Math.random,u;if(t=t||f.length,!n)for(u=void 0,r[8]=r[13]=r[18]=r[23]="-",r[14]="4",i=0;i<36;i+=1)r[i]||(u=0|e()*16,r[i]=f[i===19?u&3|8:u&15]);else for(i=0;i<n;i+=1)r[i]=f[0|e()*t];return r.join("")},n.parseBool=function(n){if(b(n))return n;var t=g(n).toLowerCase();if(t==="false")return!1;if(t==="true")return!0;throw new Error(h("parseBool, argument: {0} is not a valid boolean string",n));},n.round=function(n,t){return parseFloat(n.toFixed(t))},n.merge=function(n,t){return(t||(t={}),!n)?t:a(t,n)},n.memoize=function(n){var t=f();return function(){for(var i,r=[],u=0;u<arguments.length;u++)r[u]=arguments[u];return i="__dummy",!!r&&r.length>0&&(i=r.join(":")),i in t?t[i]:(t[i]=n.apply(void 0,r),t[i])}},n.forEach=function(n,t){if(n)for(var i in n)t(i,n[i])},n.toArray=function(n){var t=[],i;if(!n)return t;for(i in n)t.push(n[i]);return t},n.pipe=function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return r=i.reduce(function(n,t){return function(i){return t(n(i))}},function(n){return n}),function(){for(var i=[],t=0;t<arguments.length;t++)i[t]=arguments[t];return r(n.apply(void 0,i))}},n.compose=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];return i.reduce(function(n,t){return function(i){return n(t(i))}},n)},n.getTimeZoneOffset=function(){var n=new Date,t=n.getTimezoneOffset();return function(){return t}}(),n.hasProp=w,n.clone=o,n.extend=a,n.Indexer=f,n.assignStrings=v,n}();t.CoreUtils=p});define("jriapp_shared/lang",["require","exports","jriapp_shared/utils/coreutils"],function(n,t,i){"use strict";function u(n,t){return r.assignStrings(n,t)}var r;Object.defineProperty(t,"__esModule",{value:!0});t.STRS=t.ERRS=t.assign=void 0;r=i.CoreUtils;t.assign=u;t.ERRS={ERR_OBJ_ALREADY_REGISTERED:"Object with the name: {0} is already registered and can not be overwritten",ERR_OPTIONS_ALREADY_REGISTERED:"Options with the name: {0} are already registered and can not be overwritten",ERR_APP_NEED_JQUERY:"The project is dependent on JQuery and can not function properly without it",ERR_ASSERTION_FAILED:'The Assertion "{0}" failed',ERR_BINDING_CONTENT_NOT_FOUND:"BindingContent is not found",ERR_DBSET_READONLY:"TDbSet: {0} is readOnly and can not be edited",ERR_DBSET_INVALID_FIELDNAME:"TDbSet: {0} has no field with the name: {1}",ERR_FIELD_READONLY:"Field is readOnly and can not be edited",ERR_FIELD_ISNOT_NULLABLE:"Field must not be empty",ERR_FIELD_WRONG_TYPE:"Value {0} has a wrong datatype. It must have {1} datatype.",ERR_FIELD_MAXLEN:"Value exceeds maximum field length: {0}",ERR_FIELD_DATATYPE:"Unknown field data type: {0}",ERR_FIELD_REGEX:"Value {0} is not validated for correctness",ERR_FIELD_RANGE:"Value {0} is outside the allowed range {1}",ERR_EVENT_INVALID:"Invalid event name: {0}",ERR_EVENT_INVALID_FUNC:"Invalid event function value",ERR_MODULE_NOT_REGISTERED:"Module: {0} is not registered",ERR_MODULE_ALREDY_REGISTERED:"Module: {0} is already registered",ERR_PROP_NAME_EMPTY:"Empty property name parameter",ERR_PROP_NAME_INVALID:'The object does not have a property with a name: "{0}"',ERR_GLOBAL_SINGLTON:"There must be only one instance of Global object",ERR_TEMPLATE_ALREADY_REGISTERED:"TEMPLATE with the name: {0} is already registered",ERR_TEMPLATE_NOTREGISTERED:"TEMPLATE with the name: {0} is not registered",ERR_TEMPLATE_GROUP_NOTREGISTERED:"TEMPLATE's group: {0} is not registered",ERR_TEMPLATE_HAS_NO_ID:"TEMPLATE inside SCRIPT tag must have an ID attribute",ERR_OPTIONS_HAS_NO_ID:"OPTIONS inside SCRIPT tag must have an ID attribute",ERR_CONVERTER_NOTREGISTERED:"Converter: {0} is not registered",ERR_OPTIONS_NOTREGISTERED:"Options: {0} is not registered",ERR_JQUERY_DATEPICKER_NOTFOUND:"Application is dependent on JQuery.UI.datepicker",ERR_PARAM_INVALID:"Parameter: {0} has invalid value: {1}",ERR_PARAM_INVALID_TYPE:"Parameter: {0} has invalid type. It must be {1}",ERR_KEY_IS_EMPTY:"Key value must not be empty",ERR_KEY_IS_NOTFOUND:"Can not find an item with the key: {0}",ERR_ITEM_IS_ATTACHED:"Operation invalid. The reason: Item already has been attached",ERR_ITEM_IS_DETACHED:"Operation invalid. The reason: Item is detached",ERR_ITEM_IS_NOTFOUND:"Operation invalid. The reason: Item is not found",ERR_ITEM_NAME_COLLISION:'The "{0}" TDbSet\'s field name: "{1}" is invalid, because a property with that name already exists on the entity',ERR_DICTKEY_IS_NOTFOUND:"Dictionary keyName: {0} does not exist in item's properties",ERR_DICTKEY_IS_EMPTY:"Dictionary key property: {0} must be not empty",ERR_CONV_INVALID_DATE:"Cannot parse string value: {0} to a valid Date",ERR_CONV_INVALID_NUM:"Cannot parse string value: {0} to a valid Numeric",ERR_QUERY_NAME_NOTFOUND:"Can not find Query with the name: {0}",ERR_QUERY_BETWEEN:'"BETWEEN" Query operator expects two values',ERR_QUERY_OPERATOR_INVALID:"Invalid query operator {0}",ERR_OPER_REFRESH_INVALID:"Refresh operation can not be done with items in Detached or Added State",ERR_CALC_FIELD_DEFINE:'Field: "{0}" definition error: Calculated fields can be dependent only on items fields',ERR_CALC_FIELD_SELF_DEPEND:'Field: "{0}" definition error: Calculated fields can not be dependent on themselves',ERR_DOMAIN_CONTEXT_INITIALIZED:"DbContext already initialized",ERR_DOMAIN_CONTEXT_NOT_INITIALIZED:"DbContext is not initialized",ERR_SVC_METH_PARAM_INVALID:"Invalid parameter {0} value {1} for service method: {2} invocation",ERR_DB_LOAD_NO_QUERY:"Query parameter is not supplied",ERR_DBSET_NAME_INVALID:"Invalid dbSet Name: {0}",ERR_APP_NAME_NOT_UNIQUE:"Application instance with the name: {0} already exists",ERR_ELVIEW_NOT_REGISTERED:"Can not find registered element view with the name: {0}",ERR_ELVIEW_NOT_CREATED:"Can not create element view for element with Tag Name: {0}",ERR_BIND_TARGET_EMPTY:"Binding target is empty",ERR_BIND_TGTPATH_INVALID:"Binding targetPath has invalid value: {0}",ERR_BIND_MODE_INVALID:"Binding mode has invalid value: {0}",ERR_BIND_TARGET_INVALID:"Binding target must be a descendant of BaseObject",ERR_EXPR_BRACES_INVALID:"Expression {0} has no closing braces",ERR_APP_SETUP_INVALID:"Application's setUp method parameter must be a valid function",ERR_GRID_DATASRC_INVALID:"DataGrid's datasource must be a descendant of Collection type",ERR_COLLECTION_CHANGETYPE_INVALID:"Invalid Collection change type value: {0}",ERR_GRID_COLTYPE_INVALID:"Invalid Column type type value: {0}",ERR_PAGER_DATASRC_INVALID:"Pager datasource must be a descendant of Collection type",ERR_STACKPNL_DATASRC_INVALID:"StackPanel datasource must be a descendant of Collection type",ERR_STACKPNL_TEMPLATE_INVALID:"StackPanel templateID is not provided in the options",ERR_LISTBOX_DATASRC_INVALID:"ListBox datasource must be a descendant of Collection type",ERR_DATAFRM_DCTX_INVALID:"DataForm's dataContext must be a descendant of BaseObject type",ERR_DCTX_HAS_NO_FIELDINFO:"DataContext has no getFieldInfo method",ERR_TEMPLATE_ID_INVALID:"Element can not be found by its TemplateID: {0}",ERR_ITEM_DELETED_BY_ANOTHER_USER:"The record have been deleted by another user",ERR_ACCESS_DENIED:"The access is denied. Please, ask administrator to assign user rights to your account",ERR_CONCURRENCY:"The record has been modified by another user. Please, refresh record before editing",ERR_VALIDATION:"Data validation error",ERR_SVC_VALIDATION:"Data validation error: {0}",ERR_SVC_ERROR:"Service error: {0}",ERR_UNEXPECTED_SVC_ERROR:"Unexpected service error: {0}",ERR_ASSOC_NAME_INVALID:"Invalid association name: {0}",ERR_DATAVIEW_DATASRC_INVALID:"TDataView datasource must not be null and should be descendant of Collection type",ERR_DATAVIEW_FILTER_INVALID:"TDataView fn_filter option must be valid function which accepts entity and returns boolean value"};t.STRS={PAGER:{firstText:"<<",lastText:">>",previousText:"<",nextText:">",pageInfo:"Rows from <span class='ria-pager-info-num'>{0}<\/span> to <span class='ria-pager-info-num'>{1}<\/span> of <span class='ria-pager-info-num'>{2}<\/span>",firstPageTip:"to first page",prevPageTip:"back to page {0}",nextPageTip:"next to page {0}",lastPageTip:"last page",showingTip:"showing result {0} to {1} of {2}",showTip:"show result {0} to {1} of {2}"},VALIDATE:{errorInfo:"Validation errors:",errorField:"field:"},TEXT:{txtEdit:"Edit",txtAddNew:"Add new",txtDelete:"Delete",txtCancel:"Cancel",txtOk:"Ok",txtRefresh:"Refresh",txtAskDelete:"Are you sure, you want to delete row?",txtSubmitting:"Submitting data ...",txtSave:"Save",txtClose:"Close",txtField:"Field"}}});define("jriapp_shared/collection/const",["require","exports"],function(n,t){"use strict";var i,r,u,f,e,o,s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.VALS_VERSION=t.ITEM_STATUS=t.COLL_CHANGE_OPER=t.COLL_CHANGE_REASON=t.COLL_CHANGE_TYPE=t.FILTER_TYPE=t.SORT_ORDER=t.FIELD_TYPE=t.DATA_TYPE=t.DATE_CONVERSION=void 0,function(n){n[n.None=0]="None";n[n.ServerLocalToClientLocal=1]="ServerLocalToClientLocal";n[n.UtcToClientLocal=2]="UtcToClientLocal"}(i=t.DATE_CONVERSION||(t.DATE_CONVERSION={})),function(n){n[n.None=0]="None";n[n.String=1]="String";n[n.Bool=2]="Bool";n[n.Integer=3]="Integer";n[n.Decimal=4]="Decimal";n[n.Float=5]="Float";n[n.DateTime=6]="DateTime";n[n.Date=7]="Date";n[n.Time=8]="Time";n[n.Guid=9]="Guid";n[n.Binary=10]="Binary"}(r=t.DATA_TYPE||(t.DATA_TYPE={})),function(n){n[n.None=0]="None";n[n.ClientOnly=1]="ClientOnly";n[n.Calculated=2]="Calculated";n[n.Navigation=3]="Navigation";n[n.RowTimeStamp=4]="RowTimeStamp";n[n.Object=5]="Object";n[n.ServerCalculated=6]="ServerCalculated"}(u=t.FIELD_TYPE||(t.FIELD_TYPE={})),function(n){n[n.ASC=0]="ASC";n[n.DESC=1]="DESC"}(f=t.SORT_ORDER||(t.SORT_ORDER={})),function(n){n[n.Equals=0]="Equals";n[n.Between=1]="Between";n[n.StartsWith=2]="StartsWith";n[n.EndsWith=3]="EndsWith";n[n.Contains=4]="Contains";n[n.Gt=5]="Gt";n[n.Lt=6]="Lt";n[n.GtEq=7]="GtEq";n[n.LtEq=8]="LtEq";n[n.NotEq=9]="NotEq"}(e=t.FILTER_TYPE||(t.FILTER_TYPE={})),function(n){n[n.Remove=0]="Remove";n[n.Add=1]="Add";n[n.Reset=2]="Reset";n[n.Remap=3]="Remap"}(o=t.COLL_CHANGE_TYPE||(t.COLL_CHANGE_TYPE={})),function(n){n[n.None=0]="None";n[n.PageChange=1]="PageChange";n[n.Sorting=2]="Sorting";n[n.Refresh=3]="Refresh"}(s=t.COLL_CHANGE_REASON||(t.COLL_CHANGE_REASON={})),function(n){n[n.None=0]="None";n[n.Fill=1]="Fill";n[n.AddNew=2]="AddNew";n[n.Remove=3]="Remove";n[n.Commit=4]="Commit";n[n.Sort=5]="Sort"}(h=t.COLL_CHANGE_OPER||(t.COLL_CHANGE_OPER={})),function(n){n[n.None=0]="None";n[n.Added=1]="Added";n[n.Updated=2]="Updated";n[n.Deleted=3]="Deleted"}(c=t.ITEM_STATUS||(t.ITEM_STATUS={})),function(n){n[n.Current=0]="Current";n[n.Temporary=1]="Temporary";n[n.Original=2]="Original"}(l=t.VALS_VERSION||(t.VALS_VERSION={}))});define("jriapp_shared/collection/int",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ITEM_EVENTS=t.PROP_NAME=void 0;t.PROP_NAME={isEditing:"isEditing",currentItem:"currentItem",count:"count",totalCount:"totalCount",pageCount:"pageCount",pageSize:"pageSize",pageIndex:"pageIndex",isUpdating:"isUpdating",isLoading:"isLoading",isRefreshing:"isRefreshing"};var i;(function(n){n.errors_changed="errors_changed";n.destroyed="destroyed"})(i=t.ITEM_EVENTS||(t.ITEM_EVENTS={}))});define("jriapp_shared/utils/sysutils",["require","exports","jriapp_shared/lang","jriapp_shared/utils/checks","jriapp_shared/utils/strutils"],function(n,t,i,r,u){"use strict";function b(){return!1}function k(){return!1}function d(){return!1}function g(n){return!!n&&n.isPropertyBag}var c,f;Object.defineProperty(t,"__esModule",{value:!0});t.SysUtils=void 0;var e=r.Checks.isFunc,l=r.Checks.isHasProp,a=r.Checks.isArray,o=r.Checks.isNt,y=r.Checks._undefined,v=u.StringUtils.startsWith,s=u.StringUtils.fastTrim,h=u.StringUtils.trimBrackets,p=u.StringUtils.format,w=u.StringUtils.trimQuotes;c=function(){function n(){}return n.isEditable=function(n){return f.isBaseObj(n)&&l(n,"isEditing")&&e(n.beginEdit)&&e(n.endEdit)&&e(n.cancelEdit)},n.isSubmittable=function(n){return f.isBaseObj(n)&&l(n,"isCanSubmit")&&e(n.submitChanges)},n.isErrorNotification=function(n){if(!n||!e(n.getIErrorNotification))return!1;var t=n.getIErrorNotification();return!!t&&e(t.getIErrorNotification)},n.isValidatable=function(n){return n?"validationErrors"in n:!1},n.getErrorNotification=function(n){return n?!!n._aspect&&f.isErrorNotification(n._aspect)?n._aspect.getIErrorNotification():f.isErrorNotification(n)?n.getIErrorNotification():null:null},n.getEditable=function(n){return n?!!n._aspect&&f.isEditable(n._aspect)?n._aspect:f.isEditable(n)?n:null:null},n.getSubmittable=function(n){return n?!!n._aspect&&f.isSubmittable(n._aspect)?n._aspect:f.isSubmittable(n)?n:null:null},n.getBraceLen=function(n,t,r){var f,u=0,e,s,o=0,a=n.length,h,c,l,v;switch(r){case 0:h="(";c=")";break;case 1:h="{";c="}";break;case 2:h="[";c="]"}for(f=t;f<a;f+=1)if(e=n.charAt(f),s)switch(e){case"'":case'"':s===e?(l=f+1,v=l<a?n.charAt(l):null,v===e?(f+=1,u+=2):(s=null,u+=1)):u+=1;break;default:o>0&&(u+=1)}else switch(e){case"'":case'"':s=e;u+=1;break;case h:o+=1;u+=1;break;case c:if(o-=1,u+=1,o===0)return u;break;default:o>0&&(u+=1)}if(o!==0)throw new Error(p(i.ERRS.ERR_EXPR_BRACES_INVALID,n));return u},n.getPathParts=function(n){var e;if(!n)return[];for(var r=0,o,i,u=[],h=n.length,t=0;t<h;t+=1){r<0&&(r=t);o=n.charAt(t);switch(o){case".":if(i=s(n.substring(r,t)),!i&&u.length===0)throw new Error("Invalid property path: "+n);!i||u.push(i);r=-1;break;case"[":if(i=s(n.substring(r,t)),!i||u.push(i),e=f.getBraceLen(n,t,2),i=w(n.substring(t+1,t+e-1)),!i)throw new Error("Invalid property path: "+n);u.push("["+i+"]");t+=e-1;r=-1}}return r>-1&&r<t&&(i=s(n.substring(r,t)),!i||u.push(i)),u},n.getProp=function(n,t){if(!t)return n;if(f.isBaseObj(n)&&n.getIsStateDirty())return y;if(v(t,"[")){if(f.isCollection(n))return t=h(t),f.getItemByProp(n,t);if(a(n))return t=h(t),n[parseInt(t,10)];if(f.isPropBag(n))return n.getProp(t)}return n[t]},n.setProp=function(n,t,i){if(!t)throw new Error("Invalid operation: Empty Property name");if(!f.isBaseObj(n)||!n.getIsStateDirty()){if(v(t,"[")){if(a(n)){t=h(t);n[parseInt(t,10)]=i;return}if(f.isPropBag(n)){n.setProp(t,i);return}}n[t]=i}},n.resolveOwner=function(n,t){var r;if(!t)return n;var u=f.getPathParts(t),e=u.length-1,i=n;for(r=0;r<e;r+=1)if(i=f.getProp(i,u[r]),o(i))return i;return i},n.resolvePath=function(n,t){return f.resolvePath2(n,f.getPathParts(t))},n.resolvePath2=function(n,t){var i,r;if(o(n)||!t||t.length===0)return n;for(i=n,r=0;r<t.length;r+=1)if(i=f.getProp(i,t[r]),o(i))return i;return i},n.raiseProp=function(n,t){var i=f.getPathParts(t),u=i[i.length-1],r;i.length>1?(r=f.resolveOwner(n,t),!f.isBaseObj(r)||r.objEvents.raiseProp(u)):n.objEvents.raiseProp(u)},n.isBinding=function(){return!1},n.isPropBag=g,n.isCollection=k,n.getItemByProp=function(){return null},n.isValidationError=d,n.isBaseObj=b,n}();t.SysUtils=c;f=c});define("jriapp_shared/errors",["require","exports","jriapp_shared/consts","jriapp_shared/utils/sysutils","jriapp_shared/utils/coreutils","jriapp_shared/lang"],function(n,t,i,r,u,f){"use strict";var s,h,c,o;Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=t.AggregateError=t.AbortError=t.DummyError=t.BaseError=void 0;var l=r.SysUtils,a=u.CoreUtils.Indexer,e=function(){function n(n){this._message=n||"Error"}return n.prototype.toString=function(){return this._message},Object.defineProperty(n.prototype,"isDummy",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),n}();t.BaseError=e;s=function(n){function t(t){var r=n.call(this,i.DUMY_ERROR)||this;return r._origError=t,r}return __extends(t,n),Object.defineProperty(t.prototype,"isDummy",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"origError",{get:function(){return this._origError},enumerable:!1,configurable:!0}),t}(e);t.DummyError=s;h=function(n){function t(t){var r=n.call(this,i.DUMY_ERROR)||this;return r._reason=t||"Operation Aborted",r}return __extends(t,n),Object.defineProperty(t.prototype,"isDummy",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reason",{get:function(){return this._reason},enumerable:!1,configurable:!0}),t}(e);t.AbortError=h;c=function(n){function t(t){var i=n.call(this,"AggregateError")||this;return i._errors=t||[],i}return __extends(t,n),Object.defineProperty(t.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._errors.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){for(var f,i,h,r,e,n,o=a(),u=0,s=this._errors;u<s.length;u++)n=s[u],!n||(f="",f=n instanceof t?n.message:n instanceof Error?n.message:n.message?""+n.message:""+n,o[f]="");for(i="",h=Object.keys(o),r=0,e=h;r<e.length;r++)n=e[r],!i||(i+="\r\n"),i+=""+n;return i||(i="Aggregate Error"),i},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"AggregateError: \r\n"+this.message},t}(e);t.AggregateError=c;l.isValidationError=function(n){return!!n&&n instanceof o};o=function(n){function t(t,i){var u=this,r=f.ERRS.ERR_VALIDATION+"\r\n";return t.forEach(function(n,t){t>0&&(r=r+"\r\n");r=n.fieldName?r+" "+f.STRS.TEXT.txtField+": '"+n.fieldName+"'  "+n.errors.join(", "):r+n.errors.join(", ")}),u=n.call(this,r)||this,u._validations=t,u._item=i,u}return __extends(t,n),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"validations",{get:function(){return this._validations},enumerable:!1,configurable:!0}),t}(e);t.ValidationError=o});define("jriapp_shared/utils/error",["require","exports","jriapp_shared/consts","jriapp_shared/errors","jriapp_shared/utils/coreutils"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ERROR=void 0;var f=u.CoreUtils.Indexer,e=function(){function n(){}return n.addHandler=function(t,i){n._handlers[t]=i},n.removeHandler=function(t){delete n._handlers[t]},n.handleError=function(t,r,u){if(n.checkIsDummy(r))return!0;var f,e=!1;return f=n._handlers[i.APP_NAME],!f||(f===t?f=null:e=f.handleError(r,u)),e||(f=n._handlers["*"],!f||(f===t?f=null:e=f.handleError(r,u))),e},n.throwDummy=function(t){if(n.checkIsDummy(t))throw t;else throw new r.DummyError(t);},n.checkIsDummy=function(n){return!!n&&!!n.isDummy},n.checkIsAbort=function(n){return!!n&&n instanceof r.AbortError},n.reThrow=function(t,i){if(i)return n.throwDummy(t);throw t;},n.abort=function(n){throw new r.AbortError(n);},n._handlers=f(),n}();t.ERROR=e});define("jriapp_shared/utils/debug",["require","exports","jriapp_shared/int"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEBUG=void 0;var r=function(){function n(){}return n.checkStartDebugger=function(){i.DebugLevel===2},n.isDebugging=function(){return i.DebugLevel>0},n}();t.DEBUG=r});define("jriapp_shared/utils/eventhelper",["require","exports","jriapp_shared/lang","jriapp_shared/utils/checks","jriapp_shared/utils/strutils","jriapp_shared/utils/coreutils","jriapp_shared/utils/debug"],function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EventHelper=void 0;var h=f.CoreUtils.Indexer,c=r.Checks.isFunc,s=u.StringUtils.format,l=e.DEBUG,a=function(){function n(){}return n.Create=function(){return{}},n.Node=function(n,t){return{fn:n,context:t?t:null}},n.count=function(n){var u,f,t,i,r;if(!n)return 0;for(f=0,i=0;i<=2;++i)if(t=n[i],!!t)for(u=Object.keys(t),r=0;r<u.length;++r)f+=t[u[r]].length;return f},n.append=function(n,t,i,r){var u,f;r===void 0&&(r=0);i||(i="*");u=n[r];u||(n[r]=u=h());f=u[i];f||(u[i]=f=[]);f.push(t)},n.remove=function(n,t){var f,i,r,u;if(n)for(t||(t="*"),r=0;r<=2;++r)if(i=n[r],!!i)if(t==="*")for(f=Object.keys(i),u=0;u<f.length;++u)delete i[f[u]];else delete i[t]},n.toArray=function(n){var f,t,i,e,r,o,u;if(!n)return[];for(f=[],t=2;t>=0;t-=1)if(i=n[t],!!i)for(e=Object.keys(i),r=0;r<e.length;++r)for(o=i[e[r]],u=0;u<o.length;++u)f.push(o[u]);return f},n}(),o=a,v=function(){function n(){}return n.removeNS=function(n,t){var r,i;if(n)for(t||(t="*"),r=Object.keys(n),i=0;i<r.length;i+=1)t==="*"?delete n[r[i]]:o.remove(n[r[i]],t)},n.add=function(n,t,r,u,f,e){if(!n){l.checkStartDebugger();throw new Error(s(i.ERRS.ERR_ASSERTION_FAILED,"ev is a valid object"));}if(!c(r))throw new Error(i.ERRS.ERR_EVENT_INVALID_FUNC);if(!t)throw new Error(s(i.ERRS.ERR_EVENT_INVALID,"[Empty]"));var a=t,v=u?""+u:"*",h=n[a],y=o.Node(r,f);h||(n[a]=h=o.Create());o.append(h,y,v,e)},n.remove=function(t,i,r){if(!t)return null;var u=r?""+r:"*";i?u==="*"?delete t[i]:o.remove(t[i],u):n.removeNS(t,u)},n.count=function(n,t){return n?t?o.toArray(n[t]).length:0:0},n.raise=function(n,t,i,r){var f,s,u,e;if(t&&!!i)for(f=o.toArray(t[i]),s=f.length,u=0;u<s;u++)e=f[u],e.fn.apply(e.context,[n,r])},n.raiseProp=function(t,i,r,u){if(i&&!!r){var f=r==="*";f||n.raise(t,i,"0*",u);n.raise(t,i,"0"+r,u)}},n}();t.EventHelper=v});define("jriapp_shared/object",["require","exports","jriapp_shared/lang","jriapp_shared/utils/sysutils","jriapp_shared/utils/coreutils","jriapp_shared/utils/checks","jriapp_shared/utils/error","jriapp_shared/utils/eventhelper"],function(n,t,i,r,u,f,e,o){"use strict";function b(n){return new h(n)}var p,w,h,a;Object.defineProperty(t,"__esModule",{value:!0});t.BaseObject=t.ObjectEvents=t.dummyEvents=t.createObjectEvents=t.OBJ_EVENTS=t.ObjState=t.objSignature=void 0;var v=f.Checks.isHasProp,s=o.EventHelper,y=r.SysUtils,l=u.CoreUtils.Indexer,c={signature:"BaseObject"};t.objSignature=c;y.isBaseObj=function(n){return!!n&&n.__objSig===c},function(n){n[n.None=0]="None";n[n.Disposing=1]="Disposing";n[n.Disposed=2]="Disposed"}(p=t.ObjState||(t.ObjState={})),function(n){n.error="error";n.disposed="disposed"}(w=t.OBJ_EVENTS||(t.OBJ_EVENTS={}));t.createObjectEvents=b;t.dummyEvents={canRaise:function(){return!1},on:function(){throw new Error("Object disposed");},off:function(){return void 0},offNS:function(){return void 0},raise:function(){return void 0},raiseProp:function(){return void 0},onProp:function(){throw new Error("Object disposed");},offProp:function(){return void 0},addOnDisposed:function(){throw new Error("Object disposed");},offOnDisposed:function(){throw new Error("Object disposed");},addOnError:function(){throw new Error("Object disposed");},offOnError:function(){throw new Error("Object disposed");},get owner(){return null}};h=function(){function n(n){this._events=null;this._owner=n}return n.prototype.canRaise=function(n){return!!this._events&&s.count(this._events,n)>0},n.prototype.on=function(n,t,i,r,u){this._events||(this._events=l());s.add(this._events,n,t,i,r,u)},n.prototype.off=function(n,t){s.remove(this._events,n,t);n||t||(this._events=null)},n.prototype.offNS=function(n){this.off(null,n)},n.prototype.raise=function(n,t){if(!n)throw new Error(i.ERRS.ERR_EVENT_INVALID);s.raise(this._owner,this._events,n,t)},n.prototype.raiseProp=function(n){if(!n)throw new Error(i.ERRS.ERR_PROP_NAME_EMPTY);s.raiseProp(this._owner,this._events,n,{property:n})},n.prototype.onProp=function(n,t,r,u,f){if(!n)throw new Error(i.ERRS.ERR_PROP_NAME_EMPTY);this._events||(this._events=l());s.add(this._events,"0"+n,t,r,u,f)},n.prototype.offProp=function(n,t){this._owner.getIsDisposed()||(n?s.remove(this._events,"0"+n,t):s.removeNS(this._events,t))},n.prototype.addOnDisposed=function(n,t,i,r){this.on("disposed",n,t,i,r)},n.prototype.offOnDisposed=function(n){this.off("disposed",n)},n.prototype.addOnError=function(n,t,i,r){this.on("error",n,t,i,r)},n.prototype.offOnError=function(n){this.off("error",n)},Object.defineProperty(n.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),n}();t.ObjectEvents=h;a=function(){function n(){this._objState=0;this._objEvents=null}return n.prototype.setDisposing=function(){this._objState=1},n.prototype._createObjEvents=function(){return new h(this)},n.prototype.isHasProp=function(n){return v(this,n)},n.prototype.handleError=function(n,t){var r,i;return e.ERROR.checkIsDummy(n)?!0:(n.message||(n=new Error("Error: "+n)),r={error:n,source:t,isHandled:!1},this.objEvents.raise("error",r),i=r.isHandled,i||(i=e.ERROR.handleError(this,n,t)),i)},n.prototype.getIsDisposed=function(){return this._objState===2},n.prototype.getIsStateDirty=function(){return this._objState!==0},n.prototype.dispose=function(){if(this._objState!==2)try{!this._objEvents||(this._objEvents.raise("disposed",{}),this._objEvents.off(),this._objEvents=null)}finally{this._objState=2}},Object.defineProperty(n.prototype,"objEvents",{get:function(){return this._objState===2?t.dummyEvents:(this._objEvents||(this._objEvents=this._createObjEvents()),this._objEvents)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"__objSig",{get:function(){return c},enumerable:!1,configurable:!0}),n}();t.BaseObject=a});define("jriapp_shared/utils/queue",["require","exports","jriapp_shared/utils/error","jriapp_shared/utils/promise","jriapp_shared/utils/coreutils"],function(n,t,i,r,u){"use strict";function s(n){n===void 0&&(n=0);var t=[],i=f(),h=null,u=1,s={cancel:function(n){var t=i[n];!t||(t.func=null)},enque:function(r){var c=u,l;return u+=1,l={taskId:c,func:r},t.push(l),i[c]=l,h||(h=setTimeout(function(){var r=t,n;h=null;t=[];u>o&&(u=1);try{r.forEach(function(n){try{!n.func||n.func()}catch(t){e.handleError(s,t,s)}})}finally{for(i=f(),n=0;n<t.length;n+=1)i[t[n].taskId]=t[n]}},n)),c},execAsync:function(n){var t=r.createDefer(!0),i=function(){try{t.resolve(n())}catch(i){t.reject(i)}};return s.enque(i),t.promise()}};return s}Object.defineProperty(t,"__esModule",{value:!0});t.createQueue=void 0;var f=u.CoreUtils.Indexer,e=i.ERROR,o=999999e5;t.createQueue=s});define("jriapp_shared/utils/promise",["require","exports","jriapp_shared/utils/error","jriapp_shared/errors","jriapp_shared/utils/checks","jriapp_shared/utils/queue","jriapp_shared/utils/ipromise"],function(n,t,i,r,u,f,e){"use strict";function s(n){return new o(null,n).deferred()}function g(){return s(!0)}function h(){return v||(v=new tt),v}function y(n){var t=[],i=s().resolve(null),r=n.reduce(function(n,i){return n.then(function(){return i}).then(function(n){return t.push(n),n})},i);return r.then(function(){return t})}function p(n){return new o(function(t,i){n.forEach(function(n){return n.then(t).then(c,i)})})}function nt(n){return n.reduce(function(n,t){return n.then(function(n){return t().then(function(t){return n.concat(t)})})},o.resolve([]))}function a(n,t){n?t():h().enque(t)}var w,k;Object.defineProperty(t,"__esModule",{value:!0});t.AbortablePromise=t.CancellationTokenSource=t.StatefulPromise=t.promiseSerial=t.race=t.whenAll=t.getTaskQueue=t.createSyncDefer=t.createDefer=void 0;__exportStar(e,t);var c=u.Checks._undefined,l=u.Checks.isFunc,d=u.Checks.isThenable,b=u.Checks.isArray,v=null;t.createDefer=s;t.createSyncDefer=g;t.getTaskQueue=h;t.whenAll=y;t.race=p;t.promiseSerial=nt;var tt=function(){function n(){this._queue=f.createQueue(0)}return n.prototype.enque=function(n){return this._queue.enque(n)},n.prototype.cancel=function(n){this._queue.cancel(n)},n}(),it=function(){function n(n,t,i){this._isSync=n;this._successCB=t;this._errorCB=i;this._deferred=new o(null,n).deferred()}return n.prototype.resolve=function(n,t){var i=this;if(!l(this._successCB)){this._deferred.resolve(n);return}t?a(this._isSync,function(){return i._dispatch(i._successCB,n)}):this._dispatch(this._successCB,n)},n.prototype.reject=function(n,t){var i=this;if(!l(this._errorCB)){this._deferred.reject(n);return}t?a(this._isSync,function(){return i._dispatch(i._errorCB,n)}):this._dispatch(this._errorCB,n)},n.prototype._dispatch=function(n,t){try{var i=n(t);this._deferred.resolve(i)}catch(r){this._deferred.reject(r)}},Object.defineProperty(n.prototype,"deferred",{get:function(){return this._deferred},enumerable:!1,configurable:!0}),n}(),rt=function(){function n(n,t){t===void 0&&(t=!1);this._promise=n;this._isSync=t;this._value=c;this._error=c;this._state=0;this._stack=[]}return n.prototype._resolve=function(n){var t=this,i=!0,r;try{if(d(n)){if(n===this._promise)throw new TypeError("recursive resolution");r=n.then;this._state=1;r.call(n,function(n){i&&(i=!1,t._resolve(n))},function(n){i&&(i=!1,t._reject(n))})}else this._state=1,a(this._isSync,function(){var r,i;for(t._state=2,t._value=n,r=t._stack.length,i=0;i<r;i++)t._stack[i].resolve(n,!1);t._stack.splice(0,r)})}catch(u){i&&this._reject(u)}return this},n.prototype._reject=function(n){var t=this;return this._state=1,a(this._isSync,function(){var r,i;for(t._state=3,t._error=n,r=t._stack.length,i=0;i<r;i++)t._stack[i].reject(n,!1);t._stack.splice(0,r)}),this},n.prototype._then=function(n,t){if(!l(n)&&!l(t))return this._promise;var i=new it(this._isSync,n,t);switch(this._state){case 0:case 1:this._stack.push(i);break;case 2:i.resolve(this._value,!0);break;case 3:i.reject(this._error,!0)}return i.deferred.promise()},n.prototype.resolve=function(n){return this._state!==0?this.promise():this._resolve(n).promise()},n.prototype.reject=function(n){return this._state!==0?this.promise():this._reject(n).promise()},n.prototype.promise=function(){return this._promise},n.prototype.state=function(){return this._state},n}(),o=function(){function n(n,t){t===void 0&&(t=!1);var i=new rt(this,t);this._deferred=i;!n||h().enque(function(){n(function(n){return i.resolve(n)},function(n){return i.reject(n)})})}return n.prototype.then=function(n,t){return this._deferred._then(n,t)},n.prototype.catch=function(n){return this._deferred._then(c,n)},n.prototype.finally=function(t){return this._deferred._then(function(n){return t(),n},function(i){return t(),n.reject(i)})},n.all=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return n.length===1&&b(n[0])?y(n[0]):y(n)},n.race=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return n.length===1&&b(n[0])?p(n[0]):p(n)},n.reject=function(n,t){var i=s(t);return i.reject(n),i.promise()},n.resolve=function(n,t){var i=s(t);return i.resolve(n),i.promise()},n.prototype.state=function(){return this._deferred.state()},n.prototype.deferred=function(){return this._deferred},n}();t.StatefulPromise=o;w=function(){function n(){this._callbacks=[];this._isCancelled=!1;this._reason=""}return n.prototype._cancel=function(){var t=this._callbacks,n;this._callbacks=[];n=this._reason;h().enque(function(){for(var u,i=0,r=t;i<r.length;i++)u=r[i],u(n)})},n.prototype.register=function(n){this._callbacks.push(n);this._isCancelled&&this._cancel()},n.prototype.cancel=function(n){this._isCancelled||(this._isCancelled=!0,this._reason=n,this._cancel())},Object.defineProperty(n.prototype,"isCancelled",{get:function(){return this._isCancelled},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"token",{get:function(){return this},enumerable:!1,configurable:!0}),n}();t.CancellationTokenSource=w;k=function(n){function t(t){var u=n.call(this,null,!1)||this;if(u._tokenSource=null,u._aborted=!1,!!t){u._tokenSource=new w;var r=u,f=r.deferred(),e=r._tokenSource;r.catch(function(n){!!r._tokenSource&&i.ERROR.checkIsAbort(n)&&r._tokenSource.cancel()}).finally(function(){r._tokenSource=null});h().enque(function(){t(function(n){return f.resolve(n)},function(n){return f.reject(n)},e.token)})}return u}return __extends(t,n),t.prototype.abort=function(n){var t=this;t._aborted||(t._aborted=!0,t.deferred().reject(new r.AbortError(n)))},t}(o);t.AbortablePromise=k});define("jriapp_shared/utils/debounce",["require","exports","jriapp_shared/utils/promise","jriapp_shared/utils/error"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Debounce=void 0;var f=r.ERROR,u=window,e=function(){function n(n){n===void 0&&(n=0);this._timer=null;this._interval=n;this._fn=null}return n.prototype.dispose=function(){this.cancel();this._timer=void 0},n.prototype.enque=function(n){var t=this,r;if(!this.getIsDisposed()){if(!n)throw new Error("Debounce: Invalid Operation");this._fn=n;!this._interval||!this._timer||(clearTimeout(this._timer),this._timer=null);this._timer||(r=function(){var n=t._fn;if(t._timer=null,t._fn=null,!!n)try{n()}catch(i){f.handleError(u,i,u)}},this._timer=this._interval?setTimeout(r,this._interval):i.getTaskQueue().enque(r))}},n.prototype.cancel=function(){!this._timer||(this._interval?clearTimeout(this._timer):i.getTaskQueue().cancel(this._timer));this._timer=null;this._fn=null},Object.defineProperty(n.prototype,"interval",{get:function(){return this._interval},enumerable:!1,configurable:!0}),n.prototype.getIsDisposed=function(){return this._timer===void 0},n}();t.Debounce=e});define("jriapp_shared/utils/jsonbag",["require","exports","jriapp_shared/object","jriapp_shared/utils/coreutils","jriapp_shared/utils/strutils","jriapp_shared/utils/sysutils","jriapp_shared/utils/checks","jriapp_shared/utils/debounce","jriapp_shared/errors"],function(n,t,i,r,u,f,e,o,s){"use strict";var v;Object.defineProperty(t,"__esModule",{value:!0});t.JsonBag=void 0;var y=r.CoreUtils.forEach,p=r.CoreUtils.getValue,w=r.CoreUtils.setValue,h=r.CoreUtils.Indexer,b=u.StringUtils.startsWith,c=u.StringUtils.trimBrackets,k=e.Checks.isArray,d=e.Checks._undefined,l=f.SysUtils,a;(function(n){n.errors_changed="errors_changed";n.validate_bag="validate_bag";n.validate_field="validate_field"})(a||(a={}));v=function(n){function t(t,i){var r=n.call(this)||this;return r._json=void 0,r._val=h(),r._saveVal=null,r._debounce=new o.Debounce,r.resetJson(t),r._jsonChanged=i,r._errors=h(),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._debounce.dispose(),this._jsonChanged=null,this._json=d,this._val=h(),n.prototype.dispose.call(this))},t.prototype.isHasProp=function(t){return b(t,"[")?!0:n.prototype.isHasProp.call(this,t)},t.prototype.addOnValidateBag=function(n,t,i){this.objEvents.on("validate_bag",n,t,i)},t.prototype.offOnValidateBag=function(n){this.objEvents.off("validate_bag",n)},t.prototype.addOnValidateField=function(n,t,i){this.objEvents.on("validate_field",n,t,i)},t.prototype.offOnValidateField=function(n){this.objEvents.off("validate_field",n)},t.prototype.addOnErrorsChanged=function(n,t,i){this.objEvents.on("errors_changed",n,t,i)},t.prototype.offOnErrorsChanged=function(n){this.objEvents.off("errors_changed",n)},t.prototype.onChanged=function(){var n=this;this._debounce.enque(function(){!n._jsonChanged||n._jsonChanged(n._json)})},t.prototype.resetJson=function(n){n===void 0&&(n=null);this._json!==n&&(this._json=n,this._val=n?JSON.parse(n):{},this.objEvents.raiseProp("json"),this.objEvents.raiseProp("val"),this.objEvents.raiseProp("[*]"))},t.prototype.updateJson=function(){var n=JSON.stringify(this._val);return n!==this._json?(this._json=n,this.onChanged(),this.objEvents.raiseProp("json"),!0):!1},t.prototype._validateBag=function(){var n={bag:this,result:[]};return this.objEvents.raise("validate_bag",n),!n.result?[]:n.result},t.prototype._validateField=function(n){var t={bag:this,fieldName:n,errors:[]};return this.objEvents.raise("validate_field",t),!!t.errors&&t.errors.length>0?{fieldName:n,errors:t.errors}:null},t.prototype._onErrorsChanged=function(){this.objEvents.raise("errors_changed",{})},t.prototype._addErrors=function(n){for(var i,u=this,t=0,r=n;t<r.length;t++)i=r[t],u._addError(i.fieldName,i.errors,!0);this._onErrorsChanged()},t.prototype._addError=function(n,t,i){if(n||(n="*"),!(k(t)&&t.length>0)){this._removeError(n,i);return}var r=this._errors;r[n]=t;i||this._onErrorsChanged()},t.prototype._removeError=function(n,t){var i=this._errors;return i?(n||(n="*"),!i[n])?!1:(delete i[n],t||this._onErrorsChanged(),!0):!1},t.prototype._removeAllErrors=function(){this._errors=h();this._onErrorsChanged()},t.prototype.getIsHasErrors=function(){return!!this._errors&&Object.keys(this._errors).length>0},t.prototype.getFieldErrors=function(n){var t=this._errors,i;return t?(i=n,n||(n="*"),!t[n])?[]:(n==="*"&&(i=null),[{fieldName:i,errors:t[n]}]):[]},t.prototype.getAllErrors=function(){var n=this._errors,t;return n?(t=[],y(n,function(i){var r=null;i!=="*"&&(r=i);t.push({fieldName:r,errors:n[i]})}),t):[]},t.prototype.getIErrorNotification=function(){return this},t.prototype.beginEdit=function(){return this.isEditing?!1:(this._saveVal=JSON.stringify(this._val),!0)},t.prototype.endEdit=function(){if(this.isEditing){this._removeAllErrors();var n=this._validateBag();return(n.length>0&&this._addErrors(n),this.getIsHasErrors())?!1:(this._saveVal=null,this.updateJson(),!0)}return!1},t.prototype.cancelEdit=function(){return this.isEditing?(this._val=JSON.parse(this._saveVal),this._saveVal=null,this._removeAllErrors(),this.objEvents.raiseProp("[*]"),!0):!1},Object.defineProperty(t.prototype,"isEditing",{get:function(){return!!this._saveVal},enumerable:!1,configurable:!0}),t.prototype.getProp=function(n){var t=c(n);return p(this._val,t)},t.prototype.setProp=function(n,t){var e=this.getProp(n),f,r,i;if(e!==t)try{if(f=c(n),w(this._val,f,t,!1),l.raiseProp(this,n),this._removeError(n),r=this._validateField(n),!!r&&r.errors.length>0)throw new s.ValidationError([r],this);}catch(u){i=void 0;i=l.isValidationError(u)?u:new s.ValidationError([{fieldName:n,errors:[u.message]}],this);this._addError(n,i.validations[0].errors);throw i;}},Object.defineProperty(t.prototype,"isPropertyBag",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"val",{get:function(){return this._val},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"json",{get:function(){return this._json},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"JsonBag"},t}(i.BaseObject);t.JsonBag=v});define("jriapp_shared/utils/logger",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOGGER=void 0;var i=function(){function n(){}return n.log=function(n){console.log(n)},n.warn=function(n){console.warn(n)},n.error=function(n){console.error(n)},n}();t.LOGGER=i});define("jriapp_shared/utils/asyncutils",["require","exports","jriapp_shared/utils/promise","jriapp_shared/utils/checks"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AsyncUtils=void 0;var u=r.Checks.isString,f=r.Checks.isFunc,e=i.whenAll,o=i.race,s=i.getTaskQueue,h=i.createDefer,c=function(){function n(){}return n.createDeferred=function(n){return h(n)},n.reject=function(n,t){return i.StatefulPromise.reject(n,t)},n.resolve=function(n,t){return i.StatefulPromise.resolve(n,t)},n.promiseSerial=function(n){return i.promiseSerial(n)},n.whenAll=function(n){return e(n)},n.race=function(n){return o(n)},n.getTaskQueue=function(){return s()},n.delay=function(n,t){return t===void 0&&(t=0),new i.StatefulPromise(function(i,r){setTimeout(function(){try{f(n)?i(n()):i(n)}catch(t){r(t)}},t)},!0)},n.parseJSON=function(t){return n.delay(function(){return u(t)?JSON.parse(t):t})},n}();t.AsyncUtils=c});define("jriapp_shared/utils/http",["require","exports","jriapp_shared/utils/strutils","jriapp_shared/errors","jriapp_shared/utils/coreutils","jriapp_shared/utils/promise"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HttpUtils=void 0;var o=u.CoreUtils.forEach,e=u.CoreUtils.merge,s=u.CoreUtils.Indexer,h=i.StringUtils.startsWith,c=i.StringUtils.fastTrim,l=function(){function n(){}return n.isStatusOK=function(n){var t=c(""+n);return t.length===3&&h(t,"2")},n._getXMLRequest=function(t,i,u,f){var c,s=new XMLHttpRequest,h;return s.open(i,t,!0),s.responseType="text",(c=u.token)===null||c===void 0?void 0:c.register(function(){s.abort()}),s.onload=function(){var i=""+s.status,f;i==="200"?(f=s.response,u.resolve(f)):n.isStatusOK(i)?u.reject(new r.DummyError(new Error('Status: "'+i+'" loading from URL: "'+t+'"'))):u.reject(new Error('Error: "'+i+'" to load from URL: "'+t+'"'))},s.onerror=function(){u.reject(new Error('Error: "'+s.status+'" to load from URL: "'+t+'"'))},s.ontimeout=function(){u.reject(new Error('Error: "Request Timeout" to load from URL: "'+t+'"'))},s.onabort=function(){u.reject(new Error('HTTP Request Operation Aborted for URL: "'+t+'"'))},s.timeout=n.ajaxTimeOut*1e3,h=e(n.defaultHeaders),h=e(f,h),o(h,function(n,t){s.setRequestHeader(n,t)}),s},n.postAjax=function(t,i,r){var u=e(r,{"Content-Type":"application/json; charset=utf-8"});return new f.AbortablePromise(function(r,f,e){var o=n._getXMLRequest(t,"POST",{resolve:r,reject:f,token:e},u);o.send(i)})},n.getAjax=function(t,i){return new f.AbortablePromise(function(r,u,f){var e=n._getXMLRequest(t,"GET",{resolve:r,reject:u,token:f},i);e.send(null)})},n.defaultHeaders=s(),n.ajaxTimeOut=600,n}();t.HttpUtils=l});define("jriapp_shared/utils/arrhelper",["require","exports","jriapp_shared/utils/coreutils"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ArrayHelper=void 0;var u=i.CoreUtils.toArray,r=i.CoreUtils.Indexer,f=function(){function n(){}return n.clone=function(n){return n.length===1?[n[0]]:Array.apply(null,n)},n.fromList=function(n){return n?[].slice.call(n):[]},n.merge=function(n){return n?[].concat.apply([],n):[]},n.distinct=function(n){var i,f,t;if(!n)return[];for(i=r(),f=n.length,t=0;t<f;t+=1)i[""+n[t]]=n[t];return u(i)},n.toMap=function(n,t){var u=r(),f,i;if(!n)return u;for(f=n.length,i=0;i<f;i+=1)u[t(n[i])]=n[i];return u},n.remove=function(n,t){var i=n.indexOf(t);return i>-1&&n.splice(i,1),i},n.removeIndex=function(n,t){var i=t>-1&&n.length>t;return n.splice(t,1),i},n.insert=function(n,t,i){n.splice(i,0,t)},n}();t.ArrayHelper=f});define("jriapp_shared/utils/dates",["require","exports","jriapp_shared/utils/strutils","jriapp_shared/utils/checks","jriapp_shared/lang"],function(n,t,i,r,u){"use strict";function s(n,t){if(t===void 0&&(t="YYYYMMDD"),!n)return null;var i=moment(n,t);if(!i.isValid())throw new Error(o(u.ERRS.ERR_CONV_INVALID_DATE,n));return i.toDate()}function h(n,t){return(t===void 0&&(t="YYYYMMDD"),e(n))?"":moment(n).format(t)}function f(n,t,i){return moment(n).add(t,i).toDate()}var e,o,l,c;Object.defineProperty(t,"__esModule",{value:!0});t.DateUtils=t.TIME_KIND=void 0;e=r.Checks.isNt;o=i.StringUtils.format,function(n){n.YEAR="year";n.MONTH="month";n.WEEK="week";n.DAY="day";n.HOUR="hour";n.MINUTE="minute";n.SECOND="second"}(l=t.TIME_KIND||(t.TIME_KIND={}));c=function(){function n(){}return n.isValid=function(n,t){if(t===void 0&&(t="YYYYMMDD"),!n)return!1;var i=moment(n,t);return i.isValid()},n.strToDatePartial=function(n){return function(t){return s(t,n)}},n.dateToStrPartial=function(n){return function(t){return h(t,n)}},n.addPartial1=function(n){return function(t,i){return f(t,i,n)}},n.addPartial2=function(n){return function(t){return function(i){return f(i,t,n)}}},n.addPartial3=function(n){return function(t){return function(i){return f(t,i,n)}}},n.trim=function(n){return moment(n).startOf("day").toDate()},n.today=function(){return moment().startOf("day").toDate()},n.now=function(){return new Date},n.yesterday=function(n){return moment(n).startOf("day").add(-1,"day").toDate()},n.tomorrow=function(n){return moment(n).startOf("day").add(1,"day").toDate()},n.startOf=function(n,t){return moment(t).startOf(n).toDate()},n.endOf=function(n,t){return moment(t).endOf(n).toDate()},n.strToDate=s,n.dateToStr=h,n.add=f,n}();t.DateUtils=c});define("jriapp_shared/utils/utils",["require","exports","jriapp_shared/utils/coreutils","jriapp_shared/utils/debug","jriapp_shared/utils/error","jriapp_shared/utils/logger","jriapp_shared/utils/sysutils","jriapp_shared/utils/asyncutils","jriapp_shared/utils/http","jriapp_shared/utils/strutils","jriapp_shared/utils/checks","jriapp_shared/utils/arrhelper","jriapp_shared/utils/promise","jriapp_shared/utils/dates"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Utils=void 0;var y=function(){function n(){}return n.check=c.Checks,n.str=h.StringUtils,n.arr=l.ArrayHelper,n.http=s.HttpUtils,n.core=i.CoreUtils,n.async=o.AsyncUtils,n.err=u.ERROR,n.log=f.LOGGER,n.debug=r.DEBUG,n.sys=e.SysUtils,n.queue=a.getTaskQueue(),n.dates=v.DateUtils,n}();t.Utils=y});define("jriapp_shared/utils/waitqueue",["require","exports","jriapp_shared/object","jriapp_shared/utils/coreutils"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WaitQueue=void 0;var f=r.CoreUtils.getNewID,u=r.CoreUtils.Indexer,e=r.CoreUtils.extend,o=function(n){function t(t){var i=n.call(this)||this;return i._uniqueID=f("wq"),i._owner=t,i._queue=u(),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._owner.objEvents.offNS(this.uniqueID),this._queue=u(),this._owner=null,n.prototype.dispose.call(this))},t.prototype._checkQueue=function(n,t){var s,r,i,h,l,a;if(this._owner&&!this._owner.getIsStateDirty()&&(s=this,r=this._queue[n],r&&r.length!==0)){for(var f=null,e={group:null,tasks:[]},o=[],c=[],u=0;u<r.length;u+=1)if(i=r[u],i.predicate(t))if(i.group||e.tasks.length!==0)!i.group||(e.group||(e.group=i.group),e.group===i.group&&e.tasks.push(i));else{f=i;break}if(!f)while(e.tasks.length>0)i=e.tasks.pop(),f||(f=i),f.lastWins?o.length===0&&o.push(i):o.push(i),c.push(i);else o.push(f),c.push(f);try{if(o.length>0){for(u=r.length;u>0;)u-=1,c.indexOf(r[u])>-1&&r.splice(u,1);for(h=0,l=o;h<l.length;h++){a=l[h];try{a.action.apply(s._owner,a.args)}catch(v){s._owner.handleError(v,s)}}}}finally{r.length===0&&(delete this._queue[n],this._owner.objEvents.offProp(n,this.uniqueID))}}},t.prototype.enQueue=function(n){var r=e({prop:"",groupName:null,predicate:null,action:null,actionArgs:[],lastWins:!1},n),i=this,t,u,f;if(this._owner){if(t=r.prop,u=this._queue[t],!u){u=[];this._queue[t]=u;this._owner.objEvents.onProp(t,function(){setTimeout(function(){i.getIsStateDirty()||i._checkQueue(t,i._owner[t])},0)},i.uniqueID)}f={predicate:r.predicate,action:r.action,group:r.groupName,lastWins:r.lastWins,args:r.actionArgs?r.actionArgs:[]};u.push(f);i._checkQueue(t,i._owner[t]);setTimeout(function(){i.getIsStateDirty()||i._checkQueue(t,i._owner[t])},0)}},t.prototype.toString=function(){return"WaitQueue "+this._uniqueID},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.WaitQueue=o});define("jriapp_shared/collection/utils",["require","exports","jriapp_shared/utils/utils","jriapp_shared/lang"],function(n,t,i,r){"use strict";function o(n){return n<10?"0"+n:""+n}function nt(n){return""+n.getFullYear()+"-"+o(n.getMonth()+1)+"-"+o(n.getDate())+"T"+o(n.getHours())+":"+o(n.getMinutes())+":"+o(n.getSeconds())+"."+(n.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}function c(n,t,i,r){var e,u,o,f;if(t.fieldType===5){if(e=i(t,n,r),!!t.nested&&t.nested.length>0)for(u=void 0,o=t.nested.length,f=0;f<o;f+=1)u=t.nested[f],u.fieldType===5?c(n+"."+u.fieldName,u,i,e):i(u,n+"."+u.fieldName,e)}else i(t,n,r)}Object.defineProperty(t,"__esModule",{value:!0});t.CollUtils=t.fn_walkField=t.ValueUtils=void 0;var l=i.Utils,s=l.core,a=s.getTimeZoneOffset,p=s.parseBool,w=s.getValue,h=s.setValue,u=l.str.format,f=l.check,b=f._undefined,v=f.isArray,e=f.isDate,y=f.isString,k=f.isBoolean,d=f.isNumber,g=f.isNt;t.ValueUtils={valueToDate:function(n,t,i){if(!n)return null;var f=new Date(n),e=a();f.setMinutes(f.getMinutes()+e);switch(t){case 0:break;case 1:f.setMinutes(f.getMinutes()+i);f.setMinutes(f.getMinutes()-e);break;case 2:f.setMinutes(f.getMinutes()-e);break;default:throw new Error(u(r.ERRS.ERR_PARAM_INVALID,"dtcnv",t));}return f},dateToValue:function(n,t,i){if(n===null)return null;if(!e(n))throw new Error(u(r.ERRS.ERR_PARAM_INVALID,"dt",n));var f=a();switch(t){case 0:break;case 1:n.setMinutes(n.getMinutes()+f);n.setMinutes(n.getMinutes()-i);break;case 2:n.setMinutes(n.getMinutes()+f);break;default:throw new Error(u(r.ERRS.ERR_PARAM_INVALID,"dtcnv",t));}return nt(n)},compareVals:function(n,t,i){if(n===null&&t!==null||n!==null&&t===null)return!1;switch(i){case 6:case 7:case 8:return e(n)&&e(t)?n.getTime()===t.getTime():!1;default:return n===t}},stringifyValue:function(n,i,f,o){function c(n){return e(n)?t.ValueUtils.dateToValue(n,i,o):v(n)?JSON.stringify(n):y(n)?n:JSON.stringify(n)}var s=null,h;if(g(n))return s;h=!1;switch(f){case 0:s=c(n);h=!0;break;case 1:case 9:y(n)&&(s=n,h=!0);break;case 2:k(n)&&(s=JSON.stringify(n),h=!0);break;case 3:case 4:case 5:d(n)&&(s=JSON.stringify(n),h=!0);break;case 6:case 7:case 8:e(n)&&(s=t.ValueUtils.dateToValue(n,i,o),h=!0);break;case 10:v(n)&&(s=JSON.stringify(n),h=!0);break;default:throw new Error(u(r.ERRS.ERR_PARAM_INVALID,"dataType",f));}if(!h)throw new Error(u(r.ERRS.ERR_FIELD_WRONG_TYPE,n,f));return s},parseValue:function(n,i,f,e){var o=null;if(n===b||n===null)return o;switch(i){case 0:o=n;break;case 1:case 9:o=n;break;case 2:o=p(n);break;case 3:o=parseInt(n,10);break;case 4:case 5:o=parseFloat(n);break;case 6:case 7:case 8:o=t.ValueUtils.valueToDate(n,f,e);break;case 10:o=JSON.parse(n);break;default:throw new Error(u(r.ERRS.ERR_PARAM_INVALID,"dataType",i));}return o}};t.fn_walkField=c;t.CollUtils={getObjectField:function(n,t){var i=t.filter(function(t){return t.fieldName===n});if(!i||i.length!==1)throw new Error(u(r.ERRS.ERR_ASSERTION_FAILED,"arrFlds.length === 1"));return i[0]},walkField:function(n,t,i){c(n.fieldName,n,t,i)},walkFields:function(n,t,i){for(var r=0;r<n.length;r+=1)c(n[r].fieldName,n[r],t,i)},getPKFields:function(n){for(var i,r=[],u=n.length,t=0;t<u;t+=1)i=n[t],i.isPrimaryKey>0&&r.push(i);return r.sort(function(n,t){return n.isPrimaryKey-t.isPrimaryKey})},initVals:function(n,i){return t.CollUtils.walkFields(n,function(n,t){n.fieldType===5?h(i,t,{}):n.fieldType===3||n.fieldType===2||h(i,t,null)}),i},copyVals:function(n,i,r){return t.CollUtils.walkFields(n,function(n,t){if(n.fieldType===5)h(r,t,{});else if(!(n.fieldType===3||n.fieldType===2)){var u=w(i,t);h(r,t,u)}}),r},objToVals:function(n,i){return i?t.CollUtils.copyVals(n,i,{}):t.CollUtils.initVals(n,{})},cloneVals:function(n,i){return t.CollUtils.copyVals(n,i,{})}}});define("jriapp_shared/collection/base",["require","exports","jriapp_shared/object","jriapp_shared/lang","jriapp_shared/utils/waitqueue","jriapp_shared/utils/utils","jriapp_shared/collection/utils","jriapp_shared/errors"],function(n,t,i,r,u,f,e,o){"use strict";var d,v,y;Object.defineProperty(t,"__esModule",{value:!0});t.BaseCollection=t.Errors=void 0;var s=f.Utils,c=s.core,p=c.forEach,g=c.getTimeZoneOffset,nt=c.getNewID,h=c.Indexer,w=s.str,tt=w.format,it=w.startsWith,a=s.check,b=a._undefined,k=a.isArray,rt=a.isUndefined,l=s.sys,ut=e.ValueUtils.stringifyValue,ft=e.CollUtils.getObjectField;l.isCollection=function(n){return!!n&&n instanceof y},function(n){n.begin_edit="beg_edit";n.end_edit="end_edit";n.before_begin_edit="before_be";n.before_end_edit="before_ee";n.collection_changed="coll_changed";n.fill="fill";n.item_deleting="item_deleting";n.item_adding="item_adding";n.item_added="item_added";n.validate_field="validate_field";n.validate_item="validate_item";n.current_changing="current_changing";n.page_changing="page_changing";n.errors_changed="errors_changed";n.status_changed="status_changed";n.clearing="clearing";n.cleared="cleared";n.commit_changes="commit_changes"}(d||(d={}));v=function(){function n(n){this._errors=h();this._owner=n}return n.prototype.clear=function(){this._errors=h()},n.prototype.validateItem=function(n){var t={item:n,result:[]};return this._owner._getInternal().validateItem(t)},n.prototype.validateItemField=function(n,t){var i={item:n,fieldName:t,errors:[]};return this._owner._getInternal().validateItemField(i)},n.prototype.addErrors=function(n,t){var i=this;t.forEach(function(t){i.addError(n,t.fieldName,t.errors,!0)});this.onErrorsChanged(n)},n.prototype.addError=function(n,t,i,r){if(t||(t="*"),!(k(i)&&i.length>0)){this.removeError(n,t,r);return}this._errors[n._key]||(this._errors[n._key]=h());var u=this._errors[n._key];if(u[t]=i,!r)this.onErrorsChanged(n)},n.prototype.removeError=function(n,t,i){var r=this._errors[n._key];if(r&&(t||(t="*"),r[t])&&(delete r[t],Object.keys(r).length===0&&delete this._errors[n._key],!i))this.onErrorsChanged(n)},n.prototype.removeAllErrors=function(n){var t=this._errors[n._key];if(t){delete this._errors[n._key];this.onErrorsChanged(n)}},n.prototype.getErrors=function(n){return this._errors[n._key]},n.prototype.onErrorsChanged=function(n){var t={item:n};this._owner._getInternal().onErrorsChanged(t);n._aspect.raiseErrorsChanged()},n.prototype.getItemsWithErrors=function(){var t=this,n=[];return p(this._errors,function(i){var r=t._owner.getItemByKey(i);n.push(r)}),n},n}();t.Errors=v;y=function(n){function t(){var t=n.call(this)||this,i=t;return t._uniqueID=nt("coll"),t._options={enablePaging:!1,pageSize:50},t._isLoading=!1,t._isUpdating=!1,t._EditingItem=null,t._perms={canAddRow:!0,canEditRow:!0,canDeleteRow:!0,canRefreshRow:!1},t._totalCount=0,t._pageIndex=0,t._items=[],t._itemsByKey=h(),t._currentPos=-1,t._errors=new v(t),t._pkInfo=null,t._waitQueue=new u.WaitQueue(t),t._internal={setIsLoading:function(n){i._setIsLoading(n)},getEditingItem:function(){return i._getEditingItem()},getStrValue:function(n,t){return i._getStrValue(n,t)},onBeforeEditing:function(n,t,r){i._onBeforeEditing(n,t,r)},onEditing:function(n,t,r){i._onEditing(n,t,r)},onCommitChanges:function(n,t,r,u){i._onCommitChanges(n,t,r,u)},onItemDeleting:function(n){return i._onItemDeleting(n)},onErrorsChanged:function(n){i.objEvents.raise("errors_changed",n)},validateItemField:function(n){return i.objEvents.raise("validate_field",n),!!n.errors&&n.errors.length>0?{fieldName:n.fieldName,errors:n.errors}:null},validateItem:function(n){return i.objEvents.raise("validate_item",n),!!n.result&&n.result.length>0?n.result:[]}},t}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._waitQueue.dispose(),this._waitQueue=null,this.clear(),n.prototype.dispose.call(this))},t.getEmptyFieldInfo=function(n){return{fieldName:n,isPrimaryKey:0,dataType:0,isNullable:!0,maxLength:-1,isReadOnly:!1,isAutoGenerated:!1,allowClientDefault:!1,dateConversion:0,fieldType:1,isNeedOriginal:!1,range:null,regex:null,nested:null,dependentOn:null,fullName:null}},t.prototype._isOwnsItems=function(){return!0},t.prototype._setInternal=function(n){this._internal=n},t.prototype._updatePermissions=function(n){this._perms=n},t.prototype._getPKFieldInfos=function(){if(!!this._pkInfo)return this._pkInfo;var n=this.getFieldMap(),t=[];return p(n,function(i){n[i].isPrimaryKey>0&&t.push(n[i])}),t.sort(function(n,t){return n.isPrimaryKey-t.isPrimaryKey}),this._pkInfo=t,this._pkInfo},t.prototype._checkCurrentChanging=function(){try{this.endEdit()}catch(n){s.err.reThrow(n,this.handleError(n,this))}},t.prototype._onCurrentChanging=function(n){this._checkCurrentChanging(n);this.objEvents.raise("current_changing",{newCurrent:n})},t.prototype._onCurrentChanged=function(){this.objEvents.raiseProp("currentItem")},t.prototype._onCountChanged=function(){this.objEvents.raiseProp("count")},t.prototype._onEditingChanged=function(){this.objEvents.raiseProp("isEditing")},t.prototype._onItemStatusChanged=function(n,t){this.objEvents.raise("status_changed",{item:n,oldStatus:t,key:n._key})},t.prototype._onCollectionChanged=function(n){this.objEvents.raise("coll_changed",n)},t.prototype._onFillEnd=function(n){this.objEvents.raise("fill",n)},t.prototype._onItemAdding=function(n){var t={item:n,isCancel:!1};this.objEvents.raise("item_adding",t);t.isCancel&&s.err.throwDummy(new Error("operation canceled"))},t.prototype._onItemAdded=function(n){var t={item:n,isAddNewHandled:!1};this.objEvents.raise("item_added",t)},t.prototype._addNew=function(n){try{this.endEdit()}catch(t){s.err.reThrow(t,this.handleError(t,this))}if(!!this.getItemByKey(n._key))throw new Error(r.ERRS.ERR_ITEM_IS_ATTACHED);var i=this._appendItem(n);return this._onAddNew(n),this._onCountChanged(),this._onCurrentChanging(n),this._currentPos=i,this._onCurrentChanged(),i},t.prototype._onAddNew=function(n){n._aspect._setIsAttached(!0);var t={changeType:1,reason:0,oper:2,items:[n],new_key:n._key};this._onCollectionChanged(t)},t.prototype._onRemoved=function(n){try{this._onCollectionChanged({changeType:0,reason:0,oper:3,items:[n],old_key:n._key})}finally{this._onCountChanged()}},t.prototype._onPageSizeChanged=function(){},t.prototype._onPageChanging=function(){var n={page:this.pageIndex,isCancel:!1};if(this.objEvents.raise("page_changing",n),!n.isCancel)try{this.endEdit()}catch(t){s.err.reThrow(t,this.handleError(t,this))}return!n.isCancel},t.prototype._onPageChanged=function(){},t.prototype._setCurrentItem=function(n){var t=this,u=t._currentPos,f,e,i;if(!n){u!==-1&&(t._onCurrentChanging(null),t._currentPos=-1,t._onCurrentChanged());return}if(n._aspect.isDetached)throw new Error(r.ERRS.ERR_ITEM_IS_DETACHED);if(f=t.getItemByKey(n._key),!f)throw new Error(r.ERRS.ERR_ITEM_IS_NOTFOUND);if(e=t.getItemByPos(u),i=t._items.indexOf(n),i<0)throw new Error(r.ERRS.ERR_ITEM_IS_NOTFOUND);(u!==i||e!==n)&&(t._onCurrentChanging(n),t._currentPos=i,t._onCurrentChanged())},t.prototype._getEditingItem=function(){return this._EditingItem},t.prototype._getStrValue=function(n,t){var i=t.dateConversion,r=g();return ut(n,i,t.dataType,r)},t.prototype._onBeforeEditing=function(n,t,i){this._isUpdating||(t?this.objEvents.raise("before_be",{item:n}):this.objEvents.raise("before_ee",{item:n,isCanceled:i}))},t.prototype._onEditing=function(n,t,i){if(!this._isUpdating)if(t)this._EditingItem=n,this.objEvents.raise("beg_edit",{item:n}),this._onEditingChanged(),!n||n._aspect.objEvents.raiseProp("isEditing");else{var r=this._EditingItem;this._EditingItem=null;this.objEvents.raise("end_edit",{item:n,isCanceled:i});this._onEditingChanged();!r||r._aspect.objEvents.raiseProp("isEditing")}},t.prototype._onCommitChanges=function(n,t,i,r){this.objEvents.raise("commit_changes",{item:n,isBegin:t,isRejected:i,status:r})},t.prototype._validateItem=function(n){var t={item:n,result:[]};return this.objEvents.raise("validate_item",t),!!t.result&&t.result.length>0?t.result:[]},t.prototype._validateItemField=function(n,t){var i={item:n,fieldName:t,errors:[]};return this.objEvents.raise("validate_field",i),!!i.errors&&i.errors.length>0?{fieldName:t,errors:i.errors}:null},t.prototype._onItemDeleting=function(n){return this.objEvents.raise("item_deleting",n),!n.isCancel},t.prototype._clear=function(n,t){var i,r,u,f;if(this.objEvents.raise("clearing",{reason:n}),this.cancelEdit(),this.rejectChanges(),this._EditingItem=null,this.currentItem=null,i=this._items,this._errors.clear(),this._items=[],this._itemsByKey=h(),this._isOwnsItems()){for(r=0,u=i;r<u.length;r++)f=u[r],f._aspect._setIsAttached(!1);i.length>0&&s.queue.enque(function(){for(var r,n=0,t=i;n<t.length;n++)r=t[n],r.dispose()})}t!==1&&this._onCollectionChanged({changeType:2,reason:n,oper:t,items:[]});this.objEvents.raise("cleared",{reason:n});this._onCountChanged()},t.prototype._replaceItems=function(n,t,i){var r,f,u;for(this._clear(n,t),this._items=i,r=0,f=i;r<f.length;r++)u=f[r],this._itemsByKey[u._key]=u,u._aspect._setIsAttached(!0)},t.prototype._appendItem=function(n){return this._items.push(n),this._itemsByKey[n._key]=n,this._items.length-1},t.prototype._remapItem=function(n,t,i){if(!t)throw new Error(r.ERRS.ERR_KEY_IS_EMPTY);delete this._itemsByKey[n];i._aspect._setKey(t);this._itemsByKey[t]=i},t.prototype._removeItem=function(n){var i=n._key,t;if(!this.getItemByKey(i))return-1;if(t=s.arr.remove(this._items,n),t<0)throw new Error(r.ERRS.ERR_ITEM_IS_NOTFOUND);return this._onRemoved(n),delete this._itemsByKey[i],t},t.prototype._resetCurrent=function(n){var i=this.getItemByPos(n),t=this._currentPos;t===n&&(i||(this._currentPos=t-1),this._onCurrentChanged());t>n&&(this._currentPos=t-1,this._onCurrentChanged())},t.prototype._waitForProp=function(n,t,i){this._waitQueue.enQueue({prop:n,groupName:i,predicate:function(n){return!n},action:t,actionArgs:[],lastWins:!!i})},t.prototype._setIsLoading=function(n){this._isLoading!==n&&(this._isLoading=n,this.objEvents.raiseProp("isLoading"))},t.prototype._getInternal=function(){return this._internal},t.prototype._getSortFn=function(n,t){var i=1;return t===1&&(i=-1),function(t,r){for(var e=0,u,f,s,h=n.length,o=0;o<h;o+=1)if(s=n[o],u=l.resolvePath(t,s),f=l.resolvePath(r,s),u===b&&(u=null),f===b&&(f=null),e=u===null&&f!==null?-1*i:u!==null&&f===null?i:u<f?-1*i:u>f?i:0,e!==0)return e;return e}},t.prototype.isHasProp=function(t){if(it(t,"[")){var i=l.getProp(this,t);return!rt(i)}return n.prototype.isHasProp.call(this,t)},t.prototype.getFieldInfo=function(n){var i=n.split("."),f=this.getFieldMap(),t=f[i[0]],u;if(!t)throw new Error("getFieldInfo - the Collection: "+this.toString()+" does not have field: "+n);if(i.length===1)return t;if(t.fieldType===5){for(u=1;u<i.length;u+=1)t=ft(i[u],t.nested);return t}throw new Error(tt(r.ERRS.ERR_PARAM_INVALID,"fieldName",n));},t.prototype.getFieldNames=function(){return this.getFieldInfos().map(function(n){return n.fieldName})},t.prototype.cancelEdit=function(){this.isEditing&&this._EditingItem._aspect.cancelEdit()},t.prototype.endEdit=function(){var n;this.isEditing&&(n=this._EditingItem,!n._aspect.endEdit()&&n._aspect.getIsHasErrors()&&(this.handleError(new o.ValidationError(n._aspect.getAllErrors(),n),n),this.cancelEdit()))},t.prototype.getItemsWithErrors=function(){return this._errors.getItemsWithErrors()},t.prototype.addNew=function(){var n,t;n=this._createNew();this._onItemAdding(n);this._addNew(n);try{this.currentItem=n;n._aspect.beginEdit();this._onItemAdded(n)}catch(i){t=this.handleError(i,this);n._aspect.cancelEdit();s.err.reThrow(i,t)}return n},t.prototype.getItemByPos=function(n){return n<0||n>=this._items.length?null:this._items[n]},t.prototype.getItemByKey=function(n){if(!n)throw new Error(r.ERRS.ERR_KEY_IS_EMPTY);return this._itemsByKey[n]},t.prototype.findByPK=function(){for(var s,t,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(arguments.length===0)return null;var r=this,u=r._getPKFieldInfos(),e=[],o,f=[];if(f=n.length===1&&k(n[0])?n[0]:n,f.length!==u.length)return null;for(s=u.length,t=0;t<s;t+=1)e.push(r._getStrValue(f[t],u[t]));return o=e.join(";"),r.getItemByKey(o)},t.prototype.moveFirst=function(n){var i=0,r=this._currentPos,t;return r===i?!1:(t=this.getItemByPos(i),!t)?!1:!!n&&t._aspect.isDeleted?this.moveNext(!0):(this._onCurrentChanging(t),this._currentPos=i,this._onCurrentChanged(),!0)},t.prototype.movePrev=function(n){var i=-1,r=this._currentPos,t=this.getItemByPos(r);return(!t||(i=r-1),t=this.getItemByPos(i),!t)?!1:!!n&&t._aspect.isDeleted?(this._currentPos=i,this.movePrev(!0)):(this._onCurrentChanging(t),this._currentPos=i,this._onCurrentChanged(),!0)},t.prototype.moveNext=function(n){var i=-1,r=this._currentPos,t=this.getItemByPos(r);return(!t||(i=r+1),t=this.getItemByPos(i),!t)?!1:!!n&&t._aspect.isDeleted?(this._currentPos=i,this.moveNext(!0)):(this._onCurrentChanging(t),this._currentPos=i,this._onCurrentChanged(),!0)},t.prototype.moveLast=function(n){var i=this._items.length-1,r=this._currentPos,t;return r===i?!1:(t=this.getItemByPos(i),!t)?!1:!!n&&t._aspect.isDeleted?this.movePrev(!0):(this._onCurrentChanging(t),this._currentPos=i,this._onCurrentChanged(),!0)},t.prototype.goTo=function(n){var i=this._currentPos,t;return i===n?!1:(t=this.getItemByPos(n),!t)?!1:(this._onCurrentChanging(t),this._currentPos=n,this._onCurrentChanged(),!0)},t.prototype.forEach=function(n,t){this._items.forEach(n,t)},t.prototype.removeItem=function(n){if(!n._aspect.isDetached&&this.getItemByKey(n._key))try{var t=this._removeItem(n);this._errors.removeAllErrors(n);n._aspect._setIsAttached(!1);this._resetCurrent(t)}finally{n.getIsStateDirty()||n.dispose()}},t.prototype.sort=function(n,t){return this.sortLocal(n,t)},t.prototype.sortLocal=function(n,t){var u=this._getSortFn(n,t),i=this,r=s.async.createDeferred();return this.waitForNotLoading(function(){var n=i.currentItem;i._setIsLoading(!0);try{i._items.sort(u);i._onCollectionChanged({changeType:2,reason:2,oper:5,items:[]})}finally{i._setIsLoading(!1);r.resolve()}i.currentItem=null;i.currentItem=n},"sorting"),r.promise()},t.prototype.rejectChanges=function(){},t.prototype.clear=function(){this._clear(0,0);this.totalCount=0},t.prototype.waitForNotLoading=function(n,t){this._waitForProp("isLoading",n,t)},t.prototype.toString=function(){return"BaseCollection"},t.prototype.addOnClearing=function(n,t,i,r){this.objEvents.on("clearing",n,t,i,r)},t.prototype.offOnClearing=function(n){this.objEvents.off("clearing",n)},t.prototype.addOnCleared=function(n,t,i,r){this.objEvents.on("cleared",n,t,i,r)},t.prototype.offOnCleared=function(n){this.objEvents.off("cleared",n)},t.prototype.addOnCollChanged=function(n,t,i,r){this.objEvents.on("coll_changed",n,t,i,r)},t.prototype.offOnCollChanged=function(n){this.objEvents.off("coll_changed",n)},t.prototype.addOnFill=function(n,t,i,r){this.objEvents.on("fill",n,t,i,r)},t.prototype.offOnFill=function(n){this.objEvents.off("fill",n)},t.prototype.addOnValidateField=function(n,t,i,r){this.objEvents.on("validate_field",n,t,i,r)},t.prototype.offOnValidateField=function(n){this.objEvents.off("validate_field",n)},t.prototype.addOnValidateItem=function(n,t,i,r){this.objEvents.on("validate_item",n,t,i,r)},t.prototype.offOnValidateItem=function(n){this.objEvents.off("validate_item",n)},t.prototype.addOnItemDeleting=function(n,t,i,r){this.objEvents.on("item_deleting",n,t,i,r)},t.prototype.offOnItemDeleting=function(n){this.objEvents.off("item_deleting",n)},t.prototype.addOnItemAdding=function(n,t,i,r){this.objEvents.on("item_adding",n,t,i,r)},t.prototype.offOnItemAdding=function(n){this.objEvents.off("item_adding",n)},t.prototype.addOnItemAdded=function(n,t,i,r){this.objEvents.on("item_added",n,t,i,r)},t.prototype.offOnItemAdded=function(n){this.objEvents.off("item_added",n)},t.prototype.addOnCurrentChanging=function(n,t,i,r){this.objEvents.on("current_changing",n,t,i,r)},t.prototype.offOnCurrentChanging=function(n){this.objEvents.off("current_changing",n)},t.prototype.addOnPageChanging=function(n,t,i,r){this.objEvents.on("page_changing",n,t,i,r)},t.prototype.offOnPageChanging=function(n){this.objEvents.off("page_changing",n)},t.prototype.addOnErrorsChanged=function(n,t,i,r){this.objEvents.on("errors_changed",n,t,i,r)},t.prototype.offOnErrorsChanged=function(n){this.objEvents.off("errors_changed",n)},t.prototype.addOnBeginEdit=function(n,t,i,r){this.objEvents.on("beg_edit",n,t,i,r)},t.prototype.offOnBeginEdit=function(n){this.objEvents.off("beg_edit",n)},t.prototype.addOnEndEdit=function(n,t,i,r){this.objEvents.on("end_edit",n,t,i,r)},t.prototype.offOnEndEdit=function(n){this.objEvents.off("end_edit",n)},t.prototype.addOnBeforeBeginEdit=function(n,t,i,r){this.objEvents.on("before_be",n,t,i,r)},t.prototype.offOnBeforeBeginEdit=function(n){this.objEvents.off("before_be",n)},t.prototype.addOnBeforeEndEdit=function(n,t,i,r){this.objEvents.on("before_ee",n,t,i,r)},t.prototype.removeBeforeOnEndEdit=function(n){this.objEvents.off("before_ee",n)},t.prototype.addOnCommitChanges=function(n,t,i,r){this.objEvents.on("commit_changes",n,t,i,r)},t.prototype.offOnCommitChanges=function(n){this.objEvents.off("commit_changes",n)},t.prototype.addOnStatusChanged=function(n,t,i,r){this.objEvents.on("status_changed",n,t,i,r)},t.prototype.offOnStatusChanged=function(n){this.objEvents.off("status_changed",n)},t.prototype.addOnPageIndexChanged=function(n,t,i){this.objEvents.onProp("pageIndex",n,t,i)},t.prototype.addOnPageSizeChanged=function(n,t,i){this.objEvents.onProp("pageSize",n,t,i)},t.prototype.addOnTotalCountChanged=function(n,t,i){this.objEvents.onProp("totalCount",n,t,i)},t.prototype.addOnCurrentChanged=function(n,t,i){this.objEvents.onProp("currentItem",n,t,i)},Object.defineProperty(t.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){return this.getItemByPos(this._currentPos)},set:function(n){this._setCurrentItem(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalCount",{get:function(){return this._totalCount},set:function(n){n!==this._totalCount&&(this._totalCount=n,this.objEvents.raiseProp("totalCount"),this.objEvents.raiseProp("pageCount"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSize",{get:function(){return this._options.pageSize},set:function(n){this._options.pageSize!==n&&(this._options.pageSize=n,this.objEvents.raiseProp("pageSize"),this._onPageSizeChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(n){if(n!==this._pageIndex&&this.isPagingEnabled){if(n<0)return;if(!this._onPageChanging())return;this._pageIndex=n;this._onPageChanged();this.objEvents.raiseProp("pageIndex")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{get:function(){var t=this.totalCount,i=this.pageSize,n;return t===0||i===0?0:(t%i==0?n=t/i:(n=t/i,n=Math.floor(n)+1),n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return!!this._EditingItem},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdating",{get:function(){return this._isUpdating},set:function(n){this._isUpdating!==n&&(this._isUpdating=n,this.objEvents.raiseProp("isUpdating"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"permissions",{get:function(){return this._perms},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.BaseCollection=y});define("jriapp_shared/collection/validation",["require","exports","jriapp_shared/lang","jriapp_shared/utils/utils"],function(n,t,i,r){"use strict";function p(n){for(var i=Object.keys(n),r=[],u=i.length,t=0;t<u;t+=1)r.push(n[i[t]]);return r}var h;Object.defineProperty(t,"__esModule",{value:!0});t.Validations=void 0;var f=r.Utils,c=f.core.Indexer,e=f.check,l=e.isGuid,a=e.isNumber,o=e.isString,v=e.isArray,s=e.isDate,y=e.isBoolean,u=f.str.format;h=function(){function n(){}return n._dtRangeToDate=function(n){var t=n.split("-");return new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10))},n.checkNumRange=function(n,t){var u=[],r=t.split(",");return!r[0]||n<parseFloat(r[0])&&u.push(f.str.format(i.ERRS.ERR_FIELD_RANGE,n,t)),!r[1]||n>parseFloat(r[1])&&u.push(f.str.format(i.ERRS.ERR_FIELD_RANGE,n,t)),u},n.checkDateRange=function(t,r){var e=[],u=r.split(",");return!u[0]||t<n._dtRangeToDate(u[0])&&e.push(f.str.format(i.ERRS.ERR_FIELD_RANGE,t,r)),!u[1]||t>n._dtRangeToDate(u[1])&&e.push(f.str.format(i.ERRS.ERR_FIELD_RANGE,t,r)),e},n.checkField=function(t,r,f){var e=[],h=r===null||o(r)&&!r,c;if(!h||t.isNullable||t.isReadOnly||f&&t.isAutoGenerated||e.push(i.ERRS.ERR_FIELD_ISNOT_NULLABLE),h)return e;switch(t.dataType){case 0:break;case 9:l(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Guid"));break;case 1:o(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"String"));t.maxLength>0&&r.length>t.maxLength&&e.push(u(i.ERRS.ERR_FIELD_MAXLEN,t.maxLength));!t.regex||(c=new RegExp(t.regex,"i"),c.test(r)||e.push(u(i.ERRS.ERR_FIELD_REGEX,r)));break;case 10:v(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Array"));t.maxLength>0&&r.length>t.maxLength&&e.push(u(i.ERRS.ERR_FIELD_MAXLEN,t.maxLength));break;case 2:y(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Boolean"));break;case 3:case 4:case 5:a(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Number"));!t.range||n.checkNumRange(Number(r),t.range).forEach(function(n){e.push(n)});break;case 6:case 7:s(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Date"));!t.range||n.checkDateRange(r,t.range).forEach(function(n){e.push(n)});break;case 8:s(r)||e.push(u(i.ERRS.ERR_FIELD_WRONG_TYPE,r,"Time"));break;default:e.push(u(i.ERRS.ERR_PARAM_INVALID,"dataType",t.dataType))}return e},n.distinct=function(n){var t,i,u;if(!n)return[];for(t=c(),i=0,u=n;i<u.length;i++){var r=u[i],e=r.fieldName?r.fieldName:"*",f=t[e];f?f.errors=f.errors.concat(r.errors):t[e]=r}return p(t)},n}();t.Validations=h});define("jriapp_shared/collection/aspect",["require","exports","jriapp_shared/object","jriapp_shared/utils/utils","jriapp_shared/collection/utils","jriapp_shared/errors","jriapp_shared/collection/validation"],function(n,t,i,r,u,f,e){"use strict";function w(n,t){var i,r;n&&(i=n.val,o.isEditable(i)&&i.isEditing&&i.cancelEdit(),r=o.getErrorNotification(i),!r||r.offOnErrorsChanged(t),n.isOwnIt&&o.isBaseObj(i)&&i.dispose())}function h(n){if(n.isDetached)throw new Error("Invalid operation. The item is detached");}var b;Object.defineProperty(t,"__esModule",{value:!0});t.ItemAspect=void 0;var c=r.Utils,l=c.core,s=l.forEach,a=l.getValue,v=l.setValue,k=l.Indexer,y=c.check.isNt,o=c.sys,d=c.err,g=u.CollUtils.cloneVals,nt=u.CollUtils.walkFields,p;(function(n){n[n.IsAttached=0]="IsAttached";n[n.IsEdited=1]="IsEdited";n[n.IsRefreshing=2]="IsRefreshing";n[n.IsCancelling=3]="IsCancelling"})(p||(p={}));b=function(n){function t(t,i,r,u){var f=n.call(this)||this;return f._coll=t,f._vals=i,f._key=r,f._status=u?1:0,f._tempVals=null,f._flags=0,f._valueBag=null,f._item=null,f}return __extends(t,n),t.prototype.dispose=function(){var t,i,r;this.getIsDisposed()||(this.setDisposing(),t=this._coll,i=this._item,!i||(this.cancelEdit(),this.isDetached||t.removeItem(i)),r=this._valueBag,this._valueBag=null,!r||s(r,function(n,i){w(i,t.uniqueID)}),this._flags=0,this._status=0,n.prototype.dispose.call(this))},t.prototype._onErrorsChanged=function(){this.objEvents.raise("errors_changed",{})},t.prototype._getFlag=function(n){return!!(this._flags&1<<n)},t.prototype._setFlag=function(n,t){n?this._flags|=1<<t:this._flags&=~(1<<t)},t.prototype._setIsEdited=function(n){this._setFlag(n,1)},t.prototype._setIsCancelling=function(n){this._setFlag(n,3)},t.prototype._cloneVals=function(){return g(this.coll.getFieldInfos(),this._vals)},t.prototype._beginEdit=function(){var t,i,n;if(h(this),t=this.coll,i=!1,t.isEditing){if(n=t._getInternal().getEditingItem(),n._aspect===this)return!1;try{n._aspect.endEdit();n._aspect.getIsHasErrors()&&(this.handleError(new f.ValidationError(n._aspect.getAllErrors(),n),n),n._aspect.cancelEdit())}catch(r){i=this.handleError(r,n);n._aspect.cancelEdit();d.reThrow(r,i)}}return this._storeVals(1),this.coll.currentItem=this.item,!0},t.prototype._endEdit=function(){var n;if(!this.isEditing)return!1;h(this);var i=this.coll,r=this,t=i.errors;return(t.removeAllErrors(this.item),n=this._validateFields(),n.length>0&&t.addErrors(r.item,n),this.getIsHasErrors())?!1:(this._tempVals=null,!0)},t.prototype._cancelEdit=function(){var c,n,u,t,i,f,l;if(!this.isEditing)return!1;h(this);var e=this.coll,r=this,a=r.item,s=[];for(e.errors.removeAllErrors(a),c=e.getFieldNames(),n=0,u=c;n<u.length;n++)t=u[n],r._getValue(t,1)!==r._getValue(t,0)&&s.push(t);for(this._restoreVals(1),i=0,f=s;i<f.length;i++)l=f[i],o.raiseProp(this.item,l);return!0},t.prototype._skipValidate=function(){return!1},t.prototype._validateItem=function(){return this.coll.errors.validateItem(this.item)},t.prototype._validateField=function(n){var r=this.getFieldInfo(n),o=this.coll.errors,u=a(this._vals,n);if(this._skipValidate(r,u))return null;var f=e.Validations.checkField(r,u,this.isNew),i=o.validateItemField(this.item,n),t={fieldName:n,errors:[]};return f.length>0&&(t.errors=f),!!i&&i.errors.length>0&&(t.errors=t.errors.concat(i.errors)),t.errors.length>0?t:null},t.prototype._validateFields=function(){var n=this,r=this.coll.getFieldInfos(),t=[],i;return nt(r,function(i,r){if(i.fieldType!==5){var u=n._validateField(r);!!u&&u.errors.length>0&&t.push(u)}}),i=n._validateItem(),e.Validations.distinct(t.concat(i))},t.prototype._setStatus=function(n){this._status=n},t.prototype._getValue=function(n,t){switch(t){case 0:return a(this._vals,n);case 1:if(!this._tempVals)throw new Error("Invalid Operation, no Stored Version: "+t);return a(this._tempVals,n);default:throw new Error("Invalid Operation, Unknown Version: "+t);}},t.prototype._setValue=function(n,t,i){switch(i){case 0:v(this._vals,n,t,!1);break;case 1:if(!this._tempVals)throw new Error("Invalid Operation, no Stored Version: "+i);v(this._tempVals,n,t,!1);break;default:throw new Error("Invalid Operation, Unknown Version: "+i);}},t.prototype._setVals=function(n){this._vals=n},t.prototype._storeVals=function(n){switch(n){case 1:this._tempVals=this._cloneVals();break;default:throw new Error("Invalid Operation, Unknown Version: "+n);}},t.prototype._restoreVals=function(n){switch(n){case 1:if(!this._tempVals)throw new Error("Invalid Operation, no Stored Version: "+n);this._setVals(this._tempVals);this._tempVals=null;break;default:throw new Error("Invalid Operation, Unknown Version: "+n);}},t.prototype._resetStatus=function(){this._status=0},t.prototype._setKey=function(n){this._key=n},t.prototype._setIsAttached=function(n){this._setFlag(n,0)},t.prototype._setIsRefreshing=function(n){this.isRefreshing!==n&&(this._setFlag(n,2),this.objEvents.raiseProp("isRefreshing"))},t.prototype.handleError=function(n,t){return this.coll.handleError(n,t)},t.prototype.raiseErrorsChanged=function(){this._onErrorsChanged()},t.prototype.getFieldInfo=function(n){return this.coll.getFieldInfo(n)},t.prototype.getFieldNames=function(){return this.coll.getFieldNames()},t.prototype.getErrorString=function(){var t=this.coll.errors.getErrors(this.item),n;return t?(n=[],s(t,function(t,i){for(var f,r=0,u=i;r<u.length;r++)f=u[r],n.push(t+": "+f)}),n.join("|")):""},t.prototype.submitChanges=function(){return c.async.reject("not implemented")},t.prototype.rejectChanges=function(){},t.prototype.beginEdit=function(){if(h(this),this.isEditing)return!1;var i=this.coll,n=i._getInternal(),t=this.item;n.onBeforeEditing(t,!0,!1);if(!this._beginEdit())return!1;n.onEditing(t,!0,!1);return!!this._valueBag&&this.isEditing&&s(this._valueBag,function(n,t){!!t&&o.isEditable(t.val)&&t.val.beginEdit()}),!0},t.prototype.endEdit=function(){var n;if(!this.isEditing)return!1;h(this);var r=this.coll,t=r._getInternal(),i=this.item;t.onBeforeEditing(i,!1,!1);if(n=!0,!this._valueBag||s(this._valueBag,function(t,i){!!i&&o.isEditable(i.val)&&(i.val.endEdit()||(n=!1))}),!n||!this._endEdit())return!1;t.onEditing(i,!1,!1);return this._setIsEdited(!0),!0},t.prototype.cancelEdit=function(){if(!this.isEditing)return!1;h(this);this._setIsCancelling(!0);try{var i=this.coll,n=i._getInternal(),t=this.item,r=this.isNew;n.onBeforeEditing(t,!1,!0);if(!this._valueBag||s(this._valueBag,function(n,t){!!t&&o.isEditable(t.val)&&t.val.cancelEdit()}),!this._cancelEdit())return!1;n.onEditing(t,!1,!0);!r||this.isEdited||this.getIsStateDirty()||this.dispose()}finally{this._setIsCancelling(!1)}return!0},t.prototype.deleteItem=function(){var t=this.coll,n;if(this.isDetached)return!1;n={item:this.item,isCancel:!1};t._getInternal().onItemDeleting(n);return n.isCancel?!1:(this.dispose(),!0)},t.prototype.getIsHasErrors=function(){var n=!!this.coll.errors.getErrors(this.item);return n||!this._valueBag||s(this._valueBag,function(t,i){if(!!i){var r=o.getErrorNotification(i.val);!!r&&r.getIsHasErrors()&&(n=!0)}}),n},t.prototype.addOnErrorsChanged=function(n,t,i){this.objEvents.on("errors_changed",n,t,i)},t.prototype.offOnErrorsChanged=function(n){this.objEvents.off("errors_changed",n)},t.prototype.getFieldErrors=function(n){var t=[],i=this.coll.errors.getErrors(this.item),r;return i?(r=n,n||(n="*"),!i[n])?t:(n==="*"&&(r=null),t.push({fieldName:r,errors:i[n]}),t):t},t.prototype.getAllErrors=function(){var n=[],t;return(!this._valueBag||s(this._valueBag,function(t,i){var r=o.getErrorNotification(i.val);!r||(n=n.concat(r.getAllErrors()))}),t=this.coll.errors.getErrors(this.item),!t)?n:(s(t,function(i){var r=null;i!=="*"&&(r=i);n.push({fieldName:r,errors:t[i]})}),n)},t.prototype.getIErrorNotification=function(){return this},t.prototype.setCustomVal=function(n,t,i){var s=this,r,u,e,f;if(i===void 0&&(i=!0),h(this),!this._valueBag){if(y(t))return;this._valueBag=k()}r=this._valueBag[n];u=this.coll;!r||r.val===t||w(r,u.uniqueID);y(t)?delete this._valueBag[n]:(e={val:t,isOwnIt:!!i},this._valueBag[n]=e,f=o.getErrorNotification(t),!f||f.addOnErrorsChanged(function(){s.raiseErrorsChanged()},u.uniqueID),this.isEditing&&o.isEditable(t)&&t.beginEdit())},t.prototype.getCustomVal=function(n){if(!this._valueBag)return null;var t=this._valueBag[n];return t?t.val:null},t.prototype.toString=function(){return"ItemAspect"},Object.defineProperty(t.prototype,"hasTempVals",{get:function(){return!!this._tempVals},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vals",{get:function(){return this._cloneVals()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item||(this._item=this.coll.itemFactory(this)),this._item},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coll",{get:function(){return this._coll},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdating",{get:function(){return this.coll.isUpdating},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){var n=this.coll._getInternal().getEditingItem();return!!n&&n._aspect===this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanSubmit",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHasChanges",{get:function(){return this._status!==0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNew",{get:function(){return this._status===1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDeleted",{get:function(){return this._status===3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEdited",{get:function(){return this._getFlag(1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDetached",{get:function(){return!this._getFlag(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRefreshing",{get:function(){return this._getFlag(2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCancelling",{get:function(){return this._getFlag(3)},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.ItemAspect=b});define("jriapp_shared/collection/item",["require","exports","jriapp_shared/object"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CollectionItem=void 0;var r=function(n){function t(t){var i=n.call(this)||this;return i.__aspect=t,i}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this.__aspect;t.getIsStateDirty()||t.dispose();n.prototype.dispose.call(this)}},Object.defineProperty(t.prototype,"_aspect",{get:function(){return this.__aspect},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_key",{get:function(){return this.__aspect.key},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"CollectionItem"},t}(i.BaseObject);t.CollectionItem=r});define("jriapp_shared/collection/list",["require","exports","jriapp_shared/utils/utils","jriapp_shared/lang","jriapp_shared/collection/utils","jriapp_shared/collection/base","jriapp_shared/collection/aspect","jriapp_shared/errors"],function(n,t,i,r,u,f,e,o){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0});t.BaseList=t.ListItemAspect=void 0;var s=i.Utils,h=s.core.Indexer,a=s.str.format,v=s.check.isArray,y=u.CollUtils.walkField,p=u.CollUtils.initVals,w=s.sys,c=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._setProp=function(n,t){var u;if(!this.isCancelling){var i,l=this.coll,f=this.item,h=this.getFieldInfo(n),c=l.errors;if(this._getProp(n)!==t)try{if(h.isReadOnly&&!(this.isNew&&h.allowClientDefault))throw new Error(r.ERRS.ERR_FIELD_READONLY);if(this._setValue(n,t,0),w.raiseProp(f,n),c.removeError(f,n),u=this._validateField(n),!!u&&u.errors.length>0)throw new o.ValidationError([u],this);}catch(e){i=s.sys.isValidationError(e)?e:new o.ValidationError([{fieldName:n,errors:[e.message]}],this);c.addError(f,n,i.validations[0].errors);throw i;}}},t.prototype._getProp=function(n){return this._getValue(n,0)},t.prototype.toString=function(){return this.item?this.item.toString()+"Aspect":"ListItemAspect"},Object.defineProperty(t.prototype,"list",{get:function(){return this.coll},enumerable:!1,configurable:!0}),t}(e.ItemAspect);t.ListItemAspect=c;l=function(n){function t(t){var i=n.call(this)||this;return i._fieldMap=h(),i._fieldInfos=[],i._newKey=0,!t||i._updateFieldMap(t),i}return __extends(t,n),t.prototype._updateFieldMap=function(n){var i=this,u,o,e,t;if(!v(n)||n.length===0)throw new Error(a(r.ERRS.ERR_PARAM_INVALID,"props",n));for(i._fieldMap=h(),i._fieldInfos=[],u=0,o=n;u<o.length;u++)e=o[u],t=f.BaseCollection.getEmptyFieldInfo(e.name),t.dataType=e.dtype,i._fieldMap[e.name]=t,i._fieldInfos.push(t),y(t,function(n,t){n.dependents=null;n.fullName=t})},t.prototype._clear=function(t,i){n.prototype._clear.call(this,t,i);this._newKey=0},t.prototype.createItem=function(n){var t=!n,i=t?p(this.getFieldInfos(),{}):n,r=this._getNewKey(),u=new c(this,i,r,t);return u.item},t.prototype._getNewKey=function(){var n="clkey_"+this._newKey;return this._newKey+=1,n},t.prototype._createNew=function(){return this.createItem(null)},t.prototype.getFieldMap=function(){return this._fieldMap},t.prototype.getFieldInfos=function(){return this._fieldInfos},t.prototype.fillItems=function(n,t){var f=this,e=[],r=[],u,o;n||(n=[]);try{for(!t||this.clear(),u=0,o=n;u<o.length;u++){var h=o[u],i=f.createItem(h),s=f.getItemByKey(i._key);s?r.push(s):(f._appendItem(i),e.push(i),r.push(i),i._aspect._setIsAttached(!0))}e.length>0&&this.objEvents.raiseProp("count")}finally{this._onCollectionChanged({changeType:2,reason:0,oper:1,items:r});this._onFillEnd({items:r,newItems:e,reason:0})}this.moveFirst()},t.prototype.getNewItems=function(){return this.items.filter(function(n){return n._aspect.isNew})},t.prototype.resetStatus=function(){for(var i,n=0,t=this.items;n<t.length;n++)i=t[n],i._aspect._resetStatus()},t.prototype.toArray=function(){return this.items.map(function(n){return n._aspect.vals})},t.prototype.toString=function(){return"BaseList"},t}(f.BaseCollection);t.BaseList=l});define("jriapp_shared/utils/anylist",["require","exports","jriapp_shared/utils/coreutils","jriapp_shared/utils/sysutils","jriapp_shared/utils/strutils","jriapp_shared/utils/debounce","jriapp_shared/collection/item","jriapp_shared/collection/validation","jriapp_shared/collection/list","jriapp_shared/errors"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var l,p;Object.defineProperty(t,"__esModule",{value:!0});t.AnyList=t.AnyValListItem=t.AnyItemAspect=void 0;var w=i.CoreUtils.getValue,b=i.CoreUtils.setValue,a=i.CoreUtils.Indexer,k=u.StringUtils.startsWith,v=u.StringUtils.trimBrackets,c=r.SysUtils,y=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype._validateField=function(n){return this.coll.errors.validateItemField(this.item,n)},t.prototype._cloneVals=function(){var t=n.prototype._cloneVals.call(this);return t.val=JSON.parse(JSON.stringify(t.val)),t},t.prototype._validateFields=function(){return o.Validations.distinct(this._validateItem())},t.prototype._getProp=function(n){return this._getValue(n,0)},t.prototype._setProp=function(n,t){this._getProp(n)!==t&&(this._setValue(n,t,0),c.raiseProp(this.item,n))},t.prototype.toString=function(){return"AnyItemAspect"},t}(s.ListItemAspect);t.AnyItemAspect=y;l=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.isHasProp=function(t){return k(t,"[")?!0:n.prototype.isHasProp.call(this,t)},t.prototype.getProp=function(n){var t=v(n);return w(this.val,t)},t.prototype.setProp=function(n,t){var o=this._aspect.coll,f=o.errors,s=this.getProp(n),e,r,i;if(s!==t)try{if(e=v(n),b(this.val,e,t,!1),c.raiseProp(this,n),f.removeError(this,n),r=this._aspect._validateField(n),!!r&&r.errors.length>0)throw new h.ValidationError([r],this);}catch(u){i=void 0;i=c.isValidationError(u)?u:new h.ValidationError([{fieldName:n,errors:[u.message]}],this);f.addError(this,n,i.validations[0].errors);throw i;}},Object.defineProperty(t.prototype,"val",{get:function(){return this._aspect._getProp("val")},set:function(n){this._aspect._setProp("val",n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPropertyBag",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this._aspect.list},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"AnyValListItem"},t}(e.CollectionItem);t.AnyValListItem=l;p=function(n){function t(t){var i=n.call(this,[{name:"val",dtype:0}])||this;return i._saveVal=null,i._onChanged=t,i._debounce=new f.Debounce,i.addOnBeginEdit(function(n,t){i._saveVal=JSON.stringify(t.item.val)}),i.addOnEndEdit(function(n,t){var r=t.item,u,f;if(t.isCanceled){i._saveVal=null;r.objEvents.raiseProp("[*]");return}u=i._saveVal;f=JSON.stringify(r.val);i._saveVal=null;u!==f&&i.onChanged()}),i.addOnCollChanged(function(n,t){switch(t.changeType){case 0:i.onChanged()}}),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._debounce.dispose(),this._onChanged=null,n.prototype.dispose.call(this))},t.prototype.itemFactory=function(n){return new l(n)},t.prototype.createItem=function(n){var i=!n,t=i?{val:a()}:n,r,u;return t.val||(t.val=a()),r=this._getNewKey(),u=new y(this,t,r,i),u.item},t.prototype.onChanged=function(){var n=this;this._debounce.enque(function(){if(!!n._onChanged){var t=n.items.map(function(n){return n.val});n._onChanged(t)}})},t.prototype.setValues=function(n){var t=n.map(function(n){return{val:n}});this.fillItems(t,!0)},t.prototype.toString=function(){return"AnyList"},t}(s.BaseList);t.AnyList=p});define("jriapp_shared/utils/jsonarray",["require","exports","jriapp_shared/object","jriapp_shared/utils/coreutils","jriapp_shared/utils/anylist"],function(n,t,i,r,u){"use strict";var e;Object.defineProperty(t,"__esModule",{value:!0});t.JsonArray=void 0;var o=r.CoreUtils.getNewID,s=r.CoreUtils.getValue,h=r.CoreUtils.setValue,f;(function(n){n.errors_changed="errors_changed";n.validate_bag="validate_bag";n.validate_field="validate_field"})(f||(f={}));e=function(n){function t(t,i){var r=n.call(this)||this;r._list=null;r._uniqueID=o("jsn");r._owner=t;r._pathToArray=i;r.owner.objEvents.onProp("val",function(){!r._list||r._list.setValues(r.getArray())},r._uniqueID);return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._owner.objEvents.offNS(this._uniqueID),this._list.dispose(),this._list=null,this._owner=null,n.prototype.dispose.call(this))},t.prototype.updateArray=function(n){h(this._owner.val,this._pathToArray,n,!1);this._owner.updateJson()},t.prototype.addOnValidateBag=function(n,t,i){this.objEvents.on("validate_bag",n,t,i)},t.prototype.offOnValidateBag=function(n){this.objEvents.off("validate_bag",n)},t.prototype.addOnValidateField=function(n,t,i){this.objEvents.on("validate_field",n,t,i)},t.prototype.offOnValidateField=function(n){this.objEvents.off("validate_field",n)},t.prototype._validateBag=function(n){var t={bag:n,result:[]};return this.objEvents.raise("validate_bag",t),!t.result?[]:t.result},t.prototype._validateField=function(n,t){var i={bag:n,fieldName:t,errors:[]};return this.objEvents.raise("validate_field",i),!!i.errors&&i.errors.length>0?{fieldName:t,errors:i.errors}:null},t.prototype.getArray=function(){if(!this._owner)return[];var n=s(this._owner.val,this._pathToArray);return n?n:[]},Object.defineProperty(t.prototype,"pathToArray",{get:function(){return this._pathToArray},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){var n=this;return!this._owner||this._list||(this._list=new u.AnyList(function(t){n.updateArray(t)}),this._list.addOnValidateField(function(t,i){var r=n._validateField(i.item,i.fieldName);!!r&&r.errors.length>0&&(i.errors=r.errors)},this._uniqueID),this._list.addOnValidateItem(function(t,i){var r=n._validateBag(i.item);i.result=r},this._uniqueID),this._list.setValues(this.getArray())),this._list},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.JsonArray=e});define("jriapp_shared/utils/weakmap",["require","exports"],function(n,t){"use strict";function f(){var n=window;return n.WeakMap||(n.WeakMap=u),new n.WeakMap}var i,r,u;Object.defineProperty(t,"__esModule",{value:!0});t.createWeakMap=void 0;i=void 0;r=(new Date).getTime()%1e9;t.createWeakMap=f;u=function(){function n(){this._name="_wm_"+(Math.random()*1e9>>>0)+(r+++"__")}return n.prototype.set=function(n,t){var i=n[this._name];return!i||i[0]!==n?Object.defineProperty(n,this._name,{value:[n,t],writable:!0}):i[1]=t,this},n.prototype.get=function(n){var t=n[this._name];return t?t[0]===n?t[1]:i:i},n.prototype.delete=function(n){var t=n[this._name],r;return t?(r=t[0]===n,t[0]=t[1]=i,r):!1},n.prototype.has=function(n){var t=n[this._name];return t?t[0]===n:!1},n}()});define("jriapp_shared/collection/dictionary",["require","exports","jriapp_shared/utils/utils","jriapp_shared/lang","jriapp_shared/collection/utils","jriapp_shared/collection/base","jriapp_shared/collection/list"],function(n,t,i,r,u,f,e){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0});t.BaseDictionary=void 0;var s=i.Utils,o=s.str.format,c=s.check.isNt,l=s.sys,a=u.CollUtils;l.getItemByProp=function(n,t){return n instanceof h?n.getItemByKey(t):n instanceof f.BaseCollection?n.getItemByPos(parseInt(t,10)):null};h=function(n){function t(t,i){var u=this,f;if(!t)throw new Error(o(r.ERRS.ERR_PARAM_INVALID,"keyName",t));if(u=n.call(this,i)||this,u._keyName=t,f=u.getFieldInfo(t),!f)throw new Error(o(r.ERRS.ERR_DICTKEY_IS_NOTFOUND,t));return f.isPrimaryKey=1,u}return __extends(t,n),t.prototype.createItem=function(n){var t=!n,i=t?a.initVals(this.getFieldInfos(),{}):n,u,f;if(t)u=this._getNewKey();else{if(c(i[this._keyName]))throw new Error(o(r.ERRS.ERR_DICTKEY_IS_EMPTY,this._keyName));u=""+i[this._keyName]}return f=new e.ListItemAspect(this,i,u,t),f.item},t.prototype._onItemAdded=function(t){var f,e,i,u;if(n.prototype._onItemAdded.call(this,t),f=t[this._keyName],e=this,c(f))throw new Error(o(r.ERRS.ERR_DICTKEY_IS_EMPTY,this._keyName));i=t._key;u=""+f;i!==u&&(e._remapItem(i,u,t),this._onCollectionChanged({changeType:3,reason:0,oper:4,items:[t],old_key:i,new_key:u}));this.objEvents.raiseProp("["+t._key+"]")},t.prototype._onRemoved=function(t){var i=t[this._keyName];n.prototype._onRemoved.call(this,t);this.objEvents.raiseProp("["+i+"]")},Object.defineProperty(t.prototype,"keyName",{get:function(){return this._keyName},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"BaseDictionary"},t}(e.BaseList);t.BaseDictionary=h});define("jriapp_shared/utils/lazy",["require","exports","jriapp_shared/utils/checks"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Lazy=void 0;var r=i.Checks.isNt,u=function(){function n(n){if(this._val=null,this._factory=n,!this._factory)throw new Error("Lazy: Invalid value factory");}return n.prototype.dispose=function(){this.IsValueCreated&&"dispose"in this._val&&this._val.dispose();this._val=void 0;this._factory=null},Object.defineProperty(n.prototype,"Value",{get:function(){if(this._val===null){if(this._val=this._factory(),r(this._val))throw new Error("Lazy: the value factory did'not returned an object");this._factory=null}return this._val},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"IsValueCreated",{get:function(){return!r(this._val)},enumerable:!1,configurable:!0}),n.prototype.getIsDisposed=function(){return this._val===void 0},n}();t.Lazy=u});define("jriapp_shared",["require","exports","jriapp_shared/consts","jriapp_shared/int","jriapp_shared/errors","jriapp_shared/object","jriapp_shared/utils/jsonbag","jriapp_shared/utils/jsonarray","jriapp_shared/utils/dates","jriapp_shared/utils/weakmap","jriapp_shared/lang","jriapp_shared/collection/base","jriapp_shared/collection/item","jriapp_shared/collection/aspect","jriapp_shared/collection/list","jriapp_shared/collection/dictionary","jriapp_shared/errors","jriapp_shared/utils/ipromise","jriapp_shared/utils/promise","jriapp_shared/utils/utils","jriapp_shared/utils/waitqueue","jriapp_shared/utils/debounce","jriapp_shared/utils/lazy"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VERSION=t.Lazy=t.Debounce=t.WaitQueue=t.Utils=t.CancellationTokenSource=t.AbortablePromise=t.StatefulPromise=t.ValidationError=t.BaseDictionary=t.BaseList=t.ListItemAspect=t.ItemAspect=t.CollectionItem=t.BaseCollection=t.LocaleERRS=t.LocaleSTRS=t.createWeakMap=void 0;__exportStar(i,t);__exportStar(r,t);__exportStar(u,t);__exportStar(f,t);__exportStar(e,t);__exportStar(o,t);__exportStar(s,t);Object.defineProperty(t,"createWeakMap",{enumerable:!0,get:function(){return h.createWeakMap}});Object.defineProperty(t,"LocaleSTRS",{enumerable:!0,get:function(){return c.STRS}});Object.defineProperty(t,"LocaleERRS",{enumerable:!0,get:function(){return c.ERRS}});Object.defineProperty(t,"BaseCollection",{enumerable:!0,get:function(){return l.BaseCollection}});Object.defineProperty(t,"CollectionItem",{enumerable:!0,get:function(){return a.CollectionItem}});Object.defineProperty(t,"ItemAspect",{enumerable:!0,get:function(){return v.ItemAspect}});Object.defineProperty(t,"ListItemAspect",{enumerable:!0,get:function(){return y.ListItemAspect}});Object.defineProperty(t,"BaseList",{enumerable:!0,get:function(){return y.BaseList}});Object.defineProperty(t,"BaseDictionary",{enumerable:!0,get:function(){return p.BaseDictionary}});Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return w.ValidationError}});__exportStar(b,t);Object.defineProperty(t,"StatefulPromise",{enumerable:!0,get:function(){return k.StatefulPromise}});Object.defineProperty(t,"AbortablePromise",{enumerable:!0,get:function(){return k.AbortablePromise}});Object.defineProperty(t,"CancellationTokenSource",{enumerable:!0,get:function(){return k.CancellationTokenSource}});Object.defineProperty(t,"Utils",{enumerable:!0,get:function(){return d.Utils}});Object.defineProperty(t,"WaitQueue",{enumerable:!0,get:function(){return g.WaitQueue}});Object.defineProperty(t,"Debounce",{enumerable:!0,get:function(){return nt.Debounce}});Object.defineProperty(t,"Lazy",{enumerable:!0,get:function(){return tt.Lazy}});t.VERSION="4.0.0"});var __spreadArray=this&&this.__spreadArray||function(n,t){for(var i=0,u=t.length,r=n.length;i<u;i++,r++)n[r]=t[i];return n},__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__createBinding=this&&this.__createBinding||(Object.create?function(n,t,i,r){r===undefined&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){r===undefined&&(r=i);n[r]=t[i]}),__exportStar=this&&this.__exportStar||function(n,t){for(var i in n)i==="default"||Object.prototype.hasOwnProperty.call(t,i)||__createBinding(t,n,i)};define("jriapp/consts",["require","exports"],function(n,t){"use strict";var i,r,u,f,e,o,s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0});t.SubscribeFlags=t.BindTo=t.BindScope=t.LOADER_GIF=t.ELVIEW_NM=t.KEYS=t.DATA_ATTR=t.STORE_KEY=t.BINDING_MODE=t.SERVICES=void 0,function(n){n.TOOLTIP_SVC="ITooltipService";n.DATEPICKER_SVC="IDatepicker";n.UIERRORS_SVC="IUIErrorsService"}(i=t.SERVICES||(t.SERVICES={})),function(n){n[n.OneTime=0]="OneTime";n[n.OneWay=1]="OneWay";n[n.TwoWay=2]="TwoWay";n[n.BackWay=3]="BackWay"}(r=t.BINDING_MODE||(t.BINDING_MODE={})),function(n){n.SVC="svc.";n.CONVERTER="cnv.";n.OBJECT="obj.";n.OPTION="opt.";n.LOADER="ldr.";n.TGROUP="tgrp."}(u=t.STORE_KEY||(t.STORE_KEY={})),function(n){n.DATA_BIND="data-bind";n.DATA_VIEW="data-view";n.DATA_VIEW_OPTIONS="data-view-options";n.DATA_EVENT_SCOPE="data-scope";n.DATA_ITEM_KEY="data-key";n.DATA_CONTENT="data-content";n.DATA_COLUMN="data-column";n.DATA_NAME="data-name";n.DATA_REQUIRE="data-require"}(f=t.DATA_ATTR||(t.DATA_ATTR={})),function(n){n[n.backspace=8]="backspace";n[n.tab=9]="tab";n[n.enter=13]="enter";n[n.esc=27]="esc";n[n.space=32]="space";n[n.pageUp=33]="pageUp";n[n.pageDown=34]="pageDown";n[n.end=35]="end";n[n.home=36]="home";n[n.left=37]="left";n[n.up=38]="up";n[n.right=39]="right";n[n.down=40]="down";n[n.del=127]="del"}(e=t.KEYS||(t.KEYS={})),function(n){n.DataForm="dataform"}(o=t.ELVIEW_NM||(t.ELVIEW_NM={})),function(n){n.Small="loader2.gif";n.Default="loader.gif"}(s=t.LOADER_GIF||(t.LOADER_GIF={})),function(n){n[n.Application=0]="Application";n[n.Template=1]="Template";n[n.DataForm=2]="DataForm"}(h=t.BindScope||(t.BindScope={})),function(n){n[n.Source=0]="Source";n[n.Target=1]="Target"}(c=t.BindTo||(t.BindTo={})),function(n){n[n.delegationOn=0]="delegationOn";n[n.click=1]="click";n[n.change=2]="change";n[n.keypress=3]="keypress";n[n.keydown=4]="keydown";n[n.keyup=5]="keyup";n[n.input=6]="input"}(l=t.SubscribeFlags||(t.SubscribeFlags={}))});define("jriapp/int",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ButtonCss=t.Config=void 0;t.Config=jriapp_config||{};var i=function(){function n(){}return n.Edit="jriapp-actions jriapp-edit",n.Delete="jriapp-actions jriapp-delete",n.OK="jriapp-actions jriapp-ok",n.Cancel="jriapp-actions jriapp-cancel",n}();t.ButtonCss=i});define("jriapp/parsing/int",["require","exports"],function(n,t){"use strict";var i,r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.THIS_LEN=t.DATES=t.PARSE_TYPE=t.TAG=t.TOKEN=t.spaceRX=t.getRX=void 0;t.getRX=/^get[(].+[)]$/g;t.spaceRX=/^\s+$/,function(n){n.DELIMETER1=":";n.DELIMETER2="=";n.COMMA=",";n.THIS="this.";n.PARAM="param";n.TARGET_PATH="targetPath";n.BIND="bind";n.GET="get";n.DATE="date";n.INJECT="inject"}(i=t.TOKEN||(t.TOKEN={})),function(n){n.NONE="";n.LITERAL="0";n.BIND="1";n.GET="2";n.DATE="3";n.INJECT="4";n.BRACE="5";n.INDEXER="6"}(r=t.TAG||(t.TAG={})),function(n){n[n.NONE=0]="NONE";n[n.BINDING=1]="BINDING";n[n.VIEW=2]="VIEW"}(u=t.PARSE_TYPE||(t.PARSE_TYPE={})),function(n){n.NOW="now";n.TODAY="today";n.TOMORROW="tomorrow";n.YESTERDAY="yesterday"}(f=t.DATES||(t.DATES={}));t.THIS_LEN=5});define("jriapp/parsing/helper",["require","exports","jriapp_shared","jriapp/parsing/int","jriapp/bootstrapper"],function(n,t,i,r,u){"use strict";function st(n){ut.isDebugging()&&(ut.checkStartDebugger(),ot.error(n))}var b,f,k,e;Object.defineProperty(t,"__esModule",{value:!0});t.Helper=t.Funcs=void 0;var l=i.Utils,v=l.check,d=v.isNumeric,g=v.isBoolString,a=v._undefined,h=v.isString,y=l.str,ft=y.format,o=y.fastTrim,p=y.startsWith,w=y.trimQuotes,nt=l.core,tt=nt.parseBool,et=nt.extend,s=i.DateUtils,it=i.Utils.sys,c=it.getBraceLen,rt=it.resolvePath,ut=l.debug,ot=l.log;b=function(){function n(){}return n.setKeyVal=function(n,t,i,r,u,f){if(t>-1&&t<i){var s=r.substring(t,i),e=f?s:o(s);if(!e)return;u?n.key+=e:n.val+=e}},n.getDate=function(n,t){if(n){var i=n.toLowerCase();if(p(i,"startof"))return s.startOf(i.substr(7));if(p(i,"endof"))return s.endOf(i.substr(5));switch(n.toLowerCase()){case"now":return s.now();case"today":return s.today();case"tomorrow":return s.tomorrow();case"yesterday":return s.yesterday();default:return s.strToDate(n,t)}}else return s.today()},n.getTag=function(n,t,i){var u=o(n.substring(t,i)),r="";switch(u){case"bind":r="1";break;case"get":r="2";break;case"inject":r="4";break;case"date":r="3";break;default:throw new Error('Unknown token: "'+u+'" in expression '+n);}return r},n.checkVal=function(n){var t,i,r;if(!n.key)return!1;if(!!n.val)switch(n.tag){case"3":if(t=f.getExprArgs(n.val),i=t.length>0?t[0]:a,h(i)){if(r=t.length>1?t[1]:"YYYYMMDD",!h(r))throw new Error("Invalid expression with key: "+n.key+" val: "+n.val);n.val=f.getDate(i,r)}else{if(!!i)throw new Error("Invalid expression with key: "+n.key+" val: "+n.val);n.val=f.getDate(a,a)}break;case"":d(n.val)?n.val=Number(n.val):g(n.val)&&(n.val=tt(n.val))}return!0},n.getKeyVals=function(n){for(var u,s,l=[],i={tag:"",key:"",val:""},e=!0,r=-1,k=n.length,d,a,v,h,y,p,b,g,t=0;t<k;t+=1)if(r<0&&(r=t),u=n.charAt(t),s)switch(u){case"'":case'"':s===u&&(b=t+1,g=b<k?n.charAt(b):null,g===u?(f.setKeyVal(i,r,t+1,n,e,!0),t+=1,r=-1):(f.setKeyVal(i,r,t,n,e,!0),s=null,r=-1))}else switch(u){case"'":case'"':f.setKeyVal(i,r,t,n,e,!1);s=u;r=t+1;i.tag===""&&(i.tag="0");break;case"(":if(!e&&r<t){if(d=f.getTag(n,r,t),a=c(n,t,0),f.setKeyVal(i,t+1,t+a-1,n,e,!1),i.tag!=="")throw new Error("Invalid tag: "+o(n.substring(r,t))+" and value: "+i.val+" in expression: "+n);i.tag=d;t+=a-1;r=-1}else throw new Error('Invalid: "'+u+'" in expression '+n);break;case"[":if(f.setKeyVal(i,r,t,n,e,!1),v=c(n,t,2),h=w(n.substring(t+1,t+v-1)),!h)throw new Error('Invalid: "'+u+'" in expression '+n);if(e)i.key+="["+h+"]";else{if(i.val+="["+h+"]",i.tag!=="")throw new Error("Invalid value: "+i.val+" in expression: "+n);i.tag="6"}t+=v-1;r=-1;break;case"{":if(e)throw new Error('Invalid: "'+u+'" in expression '+n);else{if(y=o(n.substring(r,t)),!!y)throw new Error('Invalid word: "'+y+'{" in expression '+n);if(p=c(n,t,1),i.val=n.substring(t+1,t+p-1),i.tag!=="")throw new Error("Invalid value: "+i.val+' after brace "{" in expression: '+n);i.tag="5";t+=p-1;r=-1}break;case",":f.setKeyVal(i,r,t,n,e,!1);r=-1;l.push(i);i={tag:"",key:"",val:""};e=!0;break;case":":case"=":if(f.setKeyVal(i,r,t,n,e,!1),i.tag!==""||!e)throw new Error('Invalid "'+u+'" at the start of: '+n.substring(t)+" in expression: "+n);r=-1;e=!1;break;case")":case"}":case"]":throw new Error('Invalid: "'+u+'" in expression '+n);default:if(i.tag!==""&&i.tag!=="6"&&u!=="\t"&&u!==" "&&u!=="\n"&&u!=="\r")throw new Error('Invalid: "'+u+'" at the start of: '+n.substring(t)+" in expression: "+n);}return f.setKeyVal(i,r,t,n,e,!1),l.push(i),l.filter(function(n){return f.checkVal(n)})},n.reduceKeyVal=function(n,t,i,r){var l=!1,o,p=t===2||t===1,s,c;if(p&&n.tag==="1"&&(o=f.getExprArgs(n.val),l=o.length>0),l)switch(t){case 2:if(s=i||u.bootstrapper.app,o.length>1)if(h(o[1])){if(s=rt(u.bootstrapper.app,o[1]),!s)throw new Error("Invalid source in the bind expression, see key: "+n.key+"   val: "+n.val);}else throw new Error("Invalid second parameter in the bind expression, see key: "+n.key+"   val: "+n.val);if(h(o[0])){if(c=rt(s,o[0]),c===a)throw new Error("The bind expression returns UNDEFINED value, see key: "+n.key+"   val: "+n.val);r[n.key]=c}else throw new Error("Invalid bind expression, see key: "+n.key+"   val: "+n.val);break;case 1:o.length>0&&n.key==="param"&&(r[n.key]=o,r.isBind=!0);break;default:r[n.key]=n.val}else switch(n.tag){case"5":r[n.key]=e.parseOption(t,n.val,i);break;case"2":r[n.key]=e.parseGetExpr(0,n.val,i);break;case"4":var v=f.getExprArgs(n.val),y=v[0],w=v.slice(1);if(h(y))r[n.key]=e.getSvc.apply(e,__spreadArray([y],w));else throw new Error("Invalid expression with key: "+n.key+"   val: "+n.val);break;default:r[n.key]=n.val}},n.getExprArgs=function(n){for(var u,s,l=[],i=-1,f=!1,v=n.length,r="",a,p,t=0;t<v;t+=1)if(i<0&&(i=t),u=n.charAt(t),s)switch(u){case"'":case'"':s===u&&(a=t+1,p=a<v?n.charAt(a):null,p===u?(r+=n.substring(i,t+1),t+=1,i=t+1):(r+=n.substring(i,t),s=null,i=t+1))}else switch(u){case"'":case'"':s=u;r+=n.substring(i,t);i=t+1;break;case",":if(f&&(r!=""||o(n.substring(i,t))!=""))throw new Error("Invalid expression arguments: "+n);f?f=!1:(r+=n.substring(i,t),l.push(r));i=-1;r="";break;case"{":if(o(r)!=="")throw new Error("Invalid expression arguments: "+n);var y=c(n,t,1),w=n.substring(t+1,t+y-1),b=e.parseOption(0,w,null);l.push(b);t+=y-1;i=-1;r="";f=!0}if(i>-1){if(f&&(r!=""||o(n.substring(i,t))!=""))throw new Error("Invalid expression arguments: "+n);r+=n.substring(i,t);l.push(r)}return l.map(function(n){return h(n)?o(n):n})},n}();t.Funcs=b;f=b;k=function(){function n(){}return n.getCurlyBraceParts=function(n){for(var u,e=[],s=n.length,f,t=0;t<s;t+=1){u=n.charAt(t);switch(u){case"{":f=c(n,t,1);e.push(o(n.substr(t+1,f-2)));t+=f-1;break;default:if(!r.spaceRX.test(u))throw new Error(ft(i.LocaleERRS.ERR_EXPR_BRACES_INVALID,n));}}return e},n.getBraceContent=function(n,t){var u,f=0,s=n.length,r,i,e;switch(t){case 0:r="(";break;case 1:r="{";break;case 2:r="["}for(i=0;i<s;i+=1)if(f<0&&(f=i),u=n.charAt(i),u===r)return e=c(n,i,t),o(n.substr(i+1,e-2));throw new Error("Invalid Expression: "+n);},n.getSvc=function(n){for(var e,i,t,o,f=[],r=1;r<arguments.length;r++)f[r-1]=arguments[r];for(e=[],i=0;i<f.length;++i)t=f[i],e[i]=d(t)?Number(t):g(t)?tt(t):t;return(o=u.bootstrapper.app).getSvc.apply(o,__spreadArray([w(n)],e))},n.isGetExpr=function(n){return!!n&&r.getRX.test(n)},n.getGetParts=function(n){var t=f.getExprArgs(n);return t.map(function(t){if(!h(t))throw new Error("Invalid get expression: "+n);return o(e.getOptions(o(t)))})},n.getOptions=function(n){return u.bootstrapper.app.getOptions(w(n))},n.parseGetExpr=function(n,t,i){var r=e.getGetParts(t);return e.parseOptions(n,r,i)},n.parseOptions=function(n,t,i){for(var o,s,h=t[0],c=t.slice(1),r=e.parseOption(n,h,i)||{},u=0,f=c;u<f.length;u++)o=f[u],s=e.parseOption(n,o,i),r=et(r,s);return r},n.parseOption=function(n,t,i){var h=n===1?{targetPath:"",sourcePath:"",to:"",target:null,source:null,mode:"OneWay",converter:null,param:null,isBind:!1}:{},l,v,s,c,u;if(t=o(t),e.isGetExpr(t))return l=e.getBraceContent(t,0),e.parseGetExpr(n,l,i);for(v=f.getKeyVals(t),s=0,c=v;s<c.length;s++){u=c[s];n===1&&!u.val&&p(u.key,"this.")&&(u.val=u.key.substr(r.THIS_LEN),u.key="targetPath");try{f.reduceKeyVal(u,n,i,h)}catch(y){h[u.key]=a;st(y)}}return h},n}();t.Helper=k;e=k});define("jriapp/utils/parser",["require","exports","jriapp_shared","jriapp/parsing/helper"],function(n,t,i,r){"use strict";function e(n,t){var r,i;if(c(t,"{")&&l(t,"}"))for(r=y(t),i=0;i<r.length;i+=1)n.push(f(r[i]));else n.push(t)}function o(n){var i=[],u,o,t,r,s;if(a(n))for(u=v(n,0),o=p(u),t=0,r=o;t<r.length;t++)s=r[t],e(i,f(s));else e(i,f(n));return i}function s(n,t,i){var r=o(t);return w(n,r,i)}function k(n,t,i){return t.map(function(t){return b(n,t,i)})}var h;Object.defineProperty(t,"__esModule",{value:!0});t.Parser=void 0;var u=i.Utils.str,f=u.fastTrim,c=u.startsWith,l=u.endsWith,a=r.Helper.isGetExpr,v=r.Helper.getBraceContent,y=r.Helper.getCurlyBraceParts,p=r.Helper.getGetParts,w=r.Helper.parseOptions,b=r.Helper.parseOption;h=function(){function n(){}return n.parseOptions=function(n){return s(0,n,null)},n.parseBindings=function(n){for(var u,f,t=[],i=0,r=n;i<r.length;i++)u=r[i],f=o(u),t.push.apply(t,f);return k(1,t,null)},n.parseViewOptions=function(n,t){return s(2,n,t)},n}();t.Parser=h});define("jriapp/elview",["require","exports","jriapp_shared","jriapp/bootstrapper","jriapp/utils/parser"],function(n,t,i,r,u){"use strict";function l(n){return new y(n)}function h(n){return new a(n)}Object.defineProperty(t,"__esModule",{value:!0});t.createElViewRegister=t.createElViewFactory=void 0;var f=i.Utils,e=f.core.Indexer,s=f.str.format,c=u.Parser,o=i.LocaleERRS;t.createElViewFactory=l;t.createElViewRegister=h;var a=function(){function n(n){this._exports=e();this._next=n}return n.prototype.dispose=function(){this._exports=e()},n.prototype.registerElView=function(n,t){if(r.getObject(this,n))throw new Error(f.str.format(o.ERR_OBJ_ALREADY_REGISTERED,n));else r.registerObject(this,n,t)},n.prototype.getElViewType=function(n){var t=r.getObject(this,n);return t||!this._next||(t=this._next.getElViewType(n)),t},n.prototype.getData=function(){return this._exports},n}(),v=function(){function n(){this._weakmap=i.createWeakMap()}return n.prototype.dispose=function(){},n.prototype.getElView=function(n){return this._weakmap.get(n)},n.prototype.setElView=function(n,t){t?this._weakmap.set(n,t):this._weakmap.delete(n)},n}(),y=function(n){function t(t){var i=n.call(this)||this;return i._store=new v,i._register=h(t),i}return __extends(t,n),t.prototype.dispose=function(){this._store&&(this._store.dispose(),this._register.dispose(),this._store=null,this._register=null,n.prototype.dispose.call(this))},t.prototype.createElView=function(n){var t,e,r=n.el,h=n.options,u=n.name,i,f;if(!!u&&(t=this._register.getElViewType(u),!t))throw new Error(s(o.ERR_ELVIEW_NOT_REGISTERED,u));if(!t){i=r.nodeName.toLowerCase();f=void 0;switch(i){case"input":f=r.getAttribute("type");i=i+":"+f;t=this._register.getElViewType(i);break;default:t=this._register.getElViewType(i)}if(!t)throw new Error(s(o.ERR_ELVIEW_NOT_CREATED,i));}try{e=new t(r,h||{})}catch(c){this._store.setElView(r,null);throw c;}return e},t.prototype.getElView=function(n){return this.store.getElView(n)},t.prototype.getElementViewInfo=function(n,t){var r,u,i;return t===void 0&&(t=null),r=null,n.hasAttribute("data-view")&&(i=n.getAttribute("data-view"),!i||i==="default"||(r=i)),n.hasAttribute("data-view-options")?(i=n.getAttribute("data-view-options"),u=c.parseViewOptions(i,t)):u=e(),{el:n,name:r,options:u}},Object.defineProperty(t.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"register",{get:function(){return this._register},enumerable:!1,configurable:!0}),t}(i.BaseObject)});define("jriapp/content",["require","exports","jriapp_shared"],function(n,t,i){"use strict";function e(){return new f}var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.createContentFactoryList=void 0;r=i.LocaleERRS;t.createContentFactoryList=e;u=function(){function n(){}return n.prototype.getContentType=function(){throw new Error(r.ERR_BINDING_CONTENT_NOT_FOUND);},n.prototype.isExternallyCachable=function(){return!1},n}();f=function(){function n(){this._factory=new u}return n.prototype.addFactory=function(n){this._factory=n(this._factory)},n.prototype.getContentType=function(n){return this._factory.getContentType(n)},n.prototype.isExternallyCachable=function(n){return this._factory.isExternallyCachable(n)},n}()});define("jriapp/defaults",["require","exports","jriapp_shared","jriapp/int"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Defaults=void 0;var u=i.Utils,f=u.str.endsWith,e=function(n){function t(){var t=n.call(this)||this;return t._dateFormat="DD.MM.YYYY",t._dateTimeFormat="DD.MM.YYYY HH:mm:ss",t._timeFormat="HH:mm:ss",t._imagesPath="",t._decimalPoint=",",t._thousandSep=" ",t._decPrecision=2,t}return __extends(t,n),t.prototype.toString=function(){return"Defaults"},Object.defineProperty(t.prototype,"dateFormat",{get:function(){return this._dateFormat},set:function(n){this._dateFormat!==n&&(this._dateFormat=n,this.objEvents.raiseProp("dateFormat"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(n){this._timeFormat!==n&&(this._timeFormat=n,this.objEvents.raiseProp("timeFormat"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dateTimeFormat",{get:function(){return this._dateTimeFormat},set:function(n){this._dateTimeFormat!==n&&(this._dateTimeFormat=n,this.objEvents.raiseProp("dateTimeFormat"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imagesPath",{get:function(){return this._imagesPath},set:function(n){n||(n="");this._imagesPath!==n&&(this._imagesPath=f(n,"/")?n:n+"/",this.objEvents.raiseProp("imagesPath"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"decimalPoint",{get:function(){return this._decimalPoint},set:function(n){this._decimalPoint!==n&&(this._decimalPoint=n,this.objEvents.raiseProp("decimalPoint"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"thousandSep",{get:function(){return this._thousandSep},set:function(n){this._thousandSep!==n&&(this._thousandSep=n,this.objEvents.raiseProp("thousandSep"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"decPrecision",{get:function(){return this._decPrecision},set:function(n){this._decPrecision!==n&&(this._decPrecision=n,this.objEvents.raiseProp("decPrecision"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ButtonsCSS",{get:function(){return r.ButtonCss},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Defaults=e});define("jriapp/utils/tloader",["require","exports","jriapp_shared"],function(n,t,i){"use strict";function k(n,t){var i="ldr."+t;return o(n.getData(),i)}function l(n,t,i){if(!v(i))throw new Error(u(f.ERR_ASSERTION_FAILED,"loader must be a Function"));var r="ldr."+t,e={loader:i,owner:n};s(n.getData(),r,e,!0)}function d(n,t,i){var r="tgrp."+t;s(n.getData(),r,i,!0)}function g(n,t){var i="tgrp."+t;return o(n.getData(),i)}function nt(n){var t=n.split(".");if(t.length>2)throw new Error("Invalid template name: "+n);return t.length===1?"":t[0]}var a;Object.defineProperty(t,"__esModule",{value:!0});t.TemplateLoader=t.registerTemplateGroup=t.registerLoader=t.getLoader=void 0;var r=i.Utils,v=r.check.isFunc,e=r.core,o=e.getValue,s=e.setValue,u=r.str.format,h=r.async,y=h.createDeferred,p=h.reject,f=i.LocaleERRS,w=r.debug,b=r.log,c;(function(n){n.loaded="loaded"})(c||(c={}));t.getLoader=k;t.registerLoader=l;t.registerTemplateGroup=d;a=function(n){function t(){var t=n.call(this)||this,r=t;return t._promises=[],t._waitQueue=new i.WaitQueue(r),t}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this;t._promises=[];!t._waitQueue||(t._waitQueue.dispose(),t._waitQueue=null);n.prototype.dispose.call(this)}},t.prototype.addOnLoaded=function(n,t){this.objEvents.on("loaded",n,t)},t.prototype.offOnLoaded=function(n){this.objEvents.off("loaded",n)},t.prototype.waitForNotLoading=function(n,t){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(n){return!n},action:n,actionArgs:t})},t.prototype._onLoaded=function(n,t){this.objEvents.raise("loaded",{html:n,owner:t})},t.prototype.loadTemplatesAsync=function(n,t){var i=this,u=t(),e=i.isLoading,f;return i._promises.push(u),i.isLoading!==e&&i.objEvents.raiseProp("isLoading"),f=u.then(function(t){i._onLoaded(t,n)}),f.finally(function(){r.arr.remove(i._promises,u);i.isLoading||i.objEvents.raiseProp("isLoading")}),f},t.prototype.getTemplateLoader=function(n,t){var o=this,e=n.getTemplateLoaderInfo(t),r,i;if(!e){if(r=nt(t),r){if(i=g(n,r),!i)throw new Error(u(f.ERR_TEMPLATE_GROUP_NOTREGISTERED,r));return function(){i.promise||(i.promise=o.loadTemplatesAsync(i.owner,i.loader));var r=y(!0);return i.promise.then(function(){var o=n.getTemplateLoaderInfo(t),e,s,h;if(!o){e=u(f.ERR_TEMPLATE_NOTREGISTERED,t);s=p(e,!0);l(i.owner,t,function(){return s});w.isDebugging()&&b.error(e);throw new Error(e);}h=o.loader();h.then(function(n){r.resolve(n)},function(n){r.reject(n)})}).catch(function(n){r.reject(n)}),r.promise()}}return null}return e.loader},Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._promises.length>0},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.TemplateLoader=a});define("jriapp/utils/domevents",["require","exports","jriapp_shared"],function(n,t,i){"use strict";function b(n){return n?s(n.matchElement):!1}var a;Object.defineProperty(t,"__esModule",{value:!0});t.DomEvents=t.EventWrap=void 0;var r=i.Utils,u=r.check,s=u.isFunc,v=u.isString,y=u.isNt,h=r.arr,c=r.str.format,p=r.debug,f=i.LocaleERRS,l=function(){function n(n,t){this._ev=n;this._target=t;this._cancelBubble=!1}return Object.defineProperty(n.prototype,"type",{get:function(){return this._ev.type},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){return this._target},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bubbles",{get:function(){return this._ev.bubbles},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"defaultPrevented",{get:function(){return this._ev.defaultPrevented},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cancelable",{get:function(){return this._ev.cancelable},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isTrusted",{get:function(){return this._ev.isTrusted},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"returnValue",{get:function(){return this._ev.returnValue},set:function(n){this._ev.returnValue=n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"srcElement",{get:function(){return this._ev.srcElement},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"eventPhase",{get:function(){return this._ev.eventPhase},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cancelBubble",{get:function(){return this._cancelBubble},set:function(n){!n||(this._cancelBubble=n,this._ev.stopPropagation())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"timeStamp",{get:function(){return this._ev.timeStamp},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentTarget",{get:function(){return this._ev.currentTarget},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"originalEvent",{get:function(){return this._ev},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AT_TARGET",{get:function(){return this._ev.AT_TARGET},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"BUBBLING_PHASE",{get:function(){return this._ev.BUBBLING_PHASE},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"CAPTURING_PHASE",{get:function(){return this._ev.CAPTURING_PHASE},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){this._ev.preventDefault()},n.prototype.stopPropagation=function(){this._ev.stopPropagation();this._cancelBubble=!0},n.prototype.stopImmediatePropagation=function(){this._ev.stopImmediatePropagation()},n}();t.EventWrap=l;var w=function(){function n(){}return n.Node=function(n,t,i){return{fn:n,name:t,useCapture:i}},n.add=function(t,i,r,u,e){if(!t){p.checkStartDebugger();throw new Error(c(f.ERR_ASSERTION_FAILED,"ev is a valid object"));}if(!s(r))throw new Error(f.ERR_EVENT_INVALID_FUNC);if(!i)throw new Error(c(f.ERR_EVENT_INVALID,"[Empty]"));var h=u?""+u:"*",o=t[h],l=n.Node(r,i,e);o||(t[h]=o=[]);o.push(l)},n.getNS=function(n,t){var i,r,u;if(!n)return[];if(i=[],r=n[t],!r)return i;for(u=0;u<r.length;++u)i.push(r[u]);return i},n.removeNS=function(n,t,i){var f,r,e,u;if(!n)return[];if(f=[],r=n[i],!r)return f;if(!t)return delete n[i],r;for(e=[],u=0;u<r.length;++u)r[u].name===t?f.push(r[u]):e.push(r[u]);return e.length>0?n[i]=e:delete n[i],f},n.remove=function(t,i,r){var f,e,o,u;if(!t)return[];if(f=r?""+r:"*",e=[],f==="*"){for(o=Object.keys(t),u=0;u<o.length;++u)e.push(n.removeNS(t,i,o[u]));return h.merge(e)}return n.removeNS(t,i,f)},n.toArray=function(t){var r,u,i;if(!t)return[];for(r=Object.keys(t),u=[],i=0;i<r.length;++i)u.push(n.getNS(t,r[i]));return h.merge(u)},n.getDelegateListener=function(n,t,i){return function(r){for(var u=r.target,f;!!u&&u!==n;){if(t(u)&&(f=new l(r,u),i.apply(u,[f]),f.cancelBubble))return;u=u.parentElement}}},n}(),e=w,o=i.createWeakMap();a=function(){function n(){}return n.on=function(n,t,i,r){var u=o.get(n),f,s=!1;u||(u={},o.set(n,u));!r||(v(r)?f=r:b(r)?(f=r.nmspace,i=e.getDelegateListener(n,r.matchElement,i)):(f=r.nmspace,s=!!r.useCapture));e.add(u,t,i,f,s);n.addEventListener(t,i,s)},n.off=function(n,t,i,r){var h=o.get(n),s,f,u;if(h)for(s=e.remove(h,t,i),f=0;f<s.length;f+=1)u=s[f],(y(r)||r===u.useCapture)&&n.removeEventListener(u.name,u.fn,u.useCapture)},n.offNS=function(t,i){n.off(t,null,i)},n}();t.DomEvents=a});define("jriapp/utils/dom",["require","exports","jriapp_shared","jriapp/utils/domevents"],function(n,t,i,r){"use strict";function w(n){for(var t=u.createDocumentFragment(),i=null;!!(i=n.firstChild);)t.appendChild(i);return t}var y;Object.defineProperty(t,"__esModule",{value:!0});t.DomUtils=void 0;var o=i.Utils,c=o.arr.fromList,f=o.str.fastTrim,l=window,u=l.document,a=i.Utils.queue,s=o.core.Indexer,p="classList"in window.document.documentElement,e=i.createWeakMap(),h=!1,v=function(){var i=[],f=u.documentElement.doScroll,r="DOMContentLoaded",n=(f?/^loaded|^c/:/^loaded|^i|^c/).test(u.readyState),t;return n||(t=function(){u.removeEventListener(r,t);n=!0;for(var f=null;f=i.shift();)a.enque(f)},u.addEventListener(r,t)),function(t){n?a.enque(t):i.push(t)}}();v(function(){h="content"in u.createElement("template")});y=function(){function n(){}return n.isTemplateTagAvailable=function(){return h},n.getData=function(n,t){var i=e.get(n);if(i)return i[t]},n.setData=function(n,t,i){var r=e.get(n);r||(r=s(),e.set(n,r));r[t]=i},n.removeData=function(n,t){var i=e.get(n);i&&(t?delete i[t]:e.delete(n))},n.isContained=function(n,t){if(!n)return!1;var i=t.contains;if(!!i)return i.call(t,n);while(!!(n=n.parentNode))if(n===t)return!0;return!1},n.getDocFragment=function(n){var t;return h?(t=u.createElement("template"),t.innerHTML=n,t.content):(t=u.createElement("div"),t.innerHTML=n,w(t))},n.fromHTML=function(n){var t=u.createElement("div");return t.innerHTML=n,c(t.children)},n.queryAll=function(n,t){var i=n.querySelectorAll(t);return c(i)},n.queryOne=function(n,t){return n.querySelector(t)},n.append=function(n,t){var i,r,u;if(t)for(i=0,r=t;i<r.length;i++)u=r[i],n.appendChild(u)},n.prepend=function(n,t){if(t){var i=null;(i=n.firstChild)?n.insertBefore(t,i):n.appendChild(t)}},n.removeNode=function(n){if(n){var t=n.parentNode;!t||t.removeChild(n)}},n.insertAfter=function(n,t){var i=t.parentNode;i.lastChild===t?i.appendChild(n):i.insertBefore(n,t.nextSibling)},n.insertBefore=function(n,t){var i=t.parentNode;return i.insertBefore(n,t)},n.wrap=function(n,t){var i=n.parentElement,r=n.nextSibling;i&&(t.appendChild(n),r?i.insertBefore(t,r):i.appendChild(t))},n.unwrap=function(n){var i=n.parentElement,t,r;i&&(t=i.parentElement,r=i.nextSibling,t)&&(t.removeChild(i),r?t.insertBefore(n,r):t.appendChild(n))},n.getClassMap=function(n){var r=s(),u,i,t;if(!n||(u=n.className,!u))return r;for(i=u.split(" "),t=0;t<i.length;t+=1)i[t]=f(i[t]),!i[t]||(r[i[t]]=t);return r},n.setClasses=function(t,i){var o,l,u,r,a;if(t.length&&i.length){var h=[],e=[],c=!1;for(i.forEach(function(n){var t,i,o,r,u;if(n&&(t=f(n),t)&&(i=n.charAt(0),(i=="+"||i=="-")&&(t=f(n.substr(1))),t))for(o=t.split(" "),r=0;r<o.length;r+=1)u=f(o[r]),!u||(i!="-"?h.push(u):t==="*"?c=!0:e.push(u))}),c&&(e=[]),o=0;o<t.length;o+=1){for(l=t[o],u=n.getClassMap(l),c&&(u=s()),r=0;r<e.length;r+=1)delete u[e[r]];for(r=0;r<h.length;r+=1)u[h[r]]=r+1e3;a=Object.keys(u);l.className=a.join(" ")}}},n.setClass=function(t,i,r){var h,o,u,s,c,e,l;if(r===void 0&&(r=!1),t.length){if(!i){if(r)for(u=0;u<t.length;u+=1)t[u].className="";return}for(h=i.split(" "),e=0;e<h.length;e+=1)h[e]=f(h[e]);if(o=h.filter(function(n){return!!n}),p&&o.length===1)for(u=0;u<t.length;u+=1)s=t[u],r?s.classList.remove(o[0]):s.classList.add(o[0]);else for(u=0;u<t.length;u+=1){for(s=t[u],c=n.getClassMap(s),e=0;e<o.length;e+=1)r?delete c[o[e]]:c[o[e]]=e+1e3;l=Object.keys(c);s.className=l.join(" ")}}},n.addClass=function(t,i){n.setClass(t||[],i,!1)},n.removeClass=function(t,i){n.setClass(t||[],i,!0)},n.window=l,n.document=u,n.ready=v,n.events=r.DomEvents,n}();t.DomUtils=y});define("jriapp/utils/path",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/int"],function(n,t,i,r,u){"use strict";function w(){for(var i,u,n,o,s=t.frameworkJS,f=v.fromList(h.scripts),r=0;r<f.length;r+=1)if(i=f[r],!!i.src&&(u=e.getUrlParts(i.src),n=p(u.pathname,["/"]),!!u.pathname&&(n=n.toLowerCase(),!!n&&n.lastIndexOf(s)>-1)))return o=i.src,e.getParentUrl(o);return null}var l,a,f,e;Object.defineProperty(t,"__esModule",{value:!0});t.PathHelper=t.frameworkJS=void 0;var s=i.Utils,h=r.DomUtils.document,v=s.arr,o=s.str,y=o.format,c=o.ltrim,p=o.rtrim;t.frameworkJS=u.Config.frameworkJS||"jriapp.js";l="css";a="img";f={};e=function(){function n(){}return n.appendBust=function(t){var i=u.Config.bust;return i?n.appendSearch(t,i):t},n.appendSearch=function(t,i){i=c(i,["?"," "]);var u=n.getUrlParts(t),r=c(u.search,["?"," "]);return!!r&&r.lastIndexOf(i)>-1?t:r?t+"&"+i:t+"?"+i},n.getNormalizedUrl=function(t){return n._anchor.href=t,n._anchor.href},n.getUrlParts=function(t){var i=n._anchor;return i.href=t,i.host||(i.href=i.href),{protocol:i.protocol,host:i.host,hostname:i.hostname,port:i.port,pathname:i.pathname,hash:i.hash,search:i.search}},n.getParentUrl=function(n){var t="";return n.charAt(n.length-1)==="/"?(t=n.slice(0,n.lastIndexOf("/")),t=t.slice(0,t.lastIndexOf("/"))+"/"):t=n.slice(0,n.lastIndexOf("/"))+"/",t},n.getFrameworkPath=function(){var n=f.root;if(n||(!u.Config.frameworkPath||(n=u.Config.frameworkPath.replace(/\/?$/,"/")),n||(n=w()),!n||(f.root=n)),!n)throw new Error(y("Can not resolve {0} framework path",name));return n},n.getFrameworkCssPath=function(){var t=f.css;return t||(t=n.getFrameworkPath()+[l,"/"].join(""),f.css=t),t},n.getFrameworkImgPath=function(){var t=f.img;return t||(t=n.getFrameworkPath()+[a,"/"].join(""),f.img=t),t},n._anchor=h.createElement("a"),n}();t.PathHelper=e});define("jriapp/utils/sloader",["require","exports","jriapp_shared","jriapp_shared/utils/asyncutils","jriapp/utils/dom","jriapp/utils/path"],function(n,t,i,r,u,f){"use strict";function b(){return o||(o=new c),o}function h(n){var i,r,t;if(!n)return s(void 0,!0);if(n.length===1)return n[0];for(i=0,r=n.length,t=0;t<r;t+=1)n[t].state()===2&&++i;return i===r?s(void 0,!0):l(n)}function k(n){var t=e.createElement("link");return t.rel="stylesheet",t.type="text/css",t.href=n,t}var c;Object.defineProperty(t,"__esModule",{value:!0});t.createCssLoader=t.frameworkCss=void 0;var s=r.AsyncUtils.resolve,l=r.AsyncUtils.whenAll,a=r.AsyncUtils.createDeferred,v=i.Utils,y=u.DomUtils,p=v.arr,e=y.document,w=e.head||e.getElementsByTagName("head")[0],o=null;t.frameworkCss="jriapp.css";t.createCssLoader=b;c=function(){function n(){this._loadedCSS={}}return n.prototype.isStyleSheetLoaded=function(n){for(var i,r=f.PathHelper.getUrlParts(n),u=p.fromList(e.styleSheets),t=0;t<u.length;t+=1)if(i=f.PathHelper.getUrlParts(u[t].href),i.hostname===r.hostname&&i.pathname===r.pathname)return!0;return!1},n.prototype.loadByLink=function(n,t){var i=k(n);i.onload=function(){t(null)};i.onerror=function(){t("Error loading: "+n)};w.appendChild(i)},n.prototype.load=function(n,t){this.loadByLink(n,t)},n.ensureCssExt=function(n){return n.search(/\.(css|less|scss)$/i)===-1?n+".css":n},n.prototype.loadStyle=function(n){var r,t,i;return(n=f.PathHelper.appendBust(n),r=f.PathHelper.getNormalizedUrl(n),t=this._loadedCSS[r],!!t)?t:(i=a(!0),t=i.promise(),this.isStyleSheetLoaded(n))?(i.resolve(n),this._loadedCSS[r]=t,t):(this.load(n,function(t){t?i.reject(t):i.resolve(n)}),this._loadedCSS[r]=t,t)},n.prototype.loadStyles=function(n){for(var i=[],t=0;t<n.length;t+=1)i.push(this.loadStyle(n[t]));return h(i)},n.prototype.loadOwnStyle=function(i){i=i||t.frameworkCss;var r=f.PathHelper.getFrameworkCssPath()+n.ensureCssExt(i);return this.loadStyle(r)},n.prototype.whenAllLoaded=function(){for(var u,t=this._loadedCSS,f=Object.keys(t),i=[],n=0,r=f;n<r.length;n++)u=r[n],i.push(t[u]);return h(i)},n}()});define("jriapp/bootstrapper",["require","exports","jriapp_shared","jriapp/elview","jriapp/content","jriapp/defaults","jriapp/utils/tloader","jriapp/utils/sloader","jriapp/utils/path","jriapp/utils/dom","jriapp_shared/utils/queue","jriapp/parsing/helper"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function ct(n,t,i){var r="cnv."+t;if(d(n,r))throw new Error(ft(k.ERR_OBJ_ALREADY_REGISTERED,t));else g(n,r,i)}function li(n,t){var i="cnv."+t;return d(n,i)}function lt(n,t,i){var r="svc."+t;g(n,r,i)}function at(n,t){var i="svc."+t;return pt(n,i)}function vt(n,t){for(var e,i,u,f=[],r=2;r<arguments.length;r++)f[r-2]=arguments[r];if(e="svc."+t,i=d(n,e),!i)return null;if(u=rt(i)?i.apply(void 0,f):i,!u)throw new Error("The factory for service: "+t+" have not returned the service");return u}function yt(n,t){var i="opt."+t;return d(n,i)}function g(n,t,i){ti(n.getData(),t,i,!0)}function pt(n,t){return ii(n.getData(),t)}function d(n,t){return ni(n.getData(),t)}function ai(n,t,i){var r="opt."+t;g(n,r,i)}function vi(n){for(var i,v,y,r,o,s,h,u,c,l,f,a=ri(n.children),t=[],e=0,p=a.length;e<p;e+=1)if(i=a[e].getAttribute("data-require"),!!i)if(ui(i))for(v=ei(i,0),y=fi(v),r=0,o=y;r<o.length;r++)s=o[r],!s||t.push.apply(t,s.split(","));else t.push.apply(t,i.split(","));if(t.length===0)return t;for(h=tt(),u=0,c=t;u<c.length;u++)l=c[u],!l||(f=et(l),!f||(h[f]=f));return Object.keys(h)}var ci,ht,it;Object.defineProperty(t,"__esModule",{value:!0});t.bootstrapper=t.Bootstrapper=t.getObject=t.unregisterObject=t.registerObject=t.getOptions=t.getSvc=t.unregisterSvc=t.registerSvc=t.getConverter=t.registerConverter=t.StartupState=t.selectableProviderWeakMap=t.subscribeWeakMap=void 0;var p=i.Utils,a=h.DomUtils,b=a.window,v=b.document,rt=p.check.isFunc,nt=p.async,wt=nt.createDeferred,bt=nt.delay,kt=nt.resolve,w=p.core,dt=w.forEach,gt=w.getNewID,ni=w.getValue,ti=w.setValue,ii=w.removeValue,tt=w.Indexer,ri=p.arr.fromList,ut=p.str,ft=ut.format,et=ut.fastTrim,y=p.err,k=i.LocaleERRS,ui=l.Helper.isGetExpr,fi=l.Helper.getGetParts,ei=l.Helper.getBraceContent;t.subscribeWeakMap=i.createWeakMap();t.selectableProviderWeakMap=i.createWeakMap(),function(){var n=a.window,t,r,u;"Promise"in n||(n.Promise=i.StatefulPromise);n.requestAnimationFrame||(t=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||n.msRequestAnimationFrame,r=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.webkitCancelRequestAnimationFrame||n.msCancelAnimationFrame,t&&r||(u=c.createQueue(40),t=u.enque,r=u.cancel),n.requestAnimationFrame=t,n.cancelAnimationFrame=r)}();var oi='script[type="text/x-template"]',si='script[type="text/x-options"]',ot=o.createCssLoader(),hi={click:1,change:2,keypress:3,keydown:4,keyup:5,input:6},st;(function(n){n.load="load";n.unload="unload";n.initialized="initialize"})(st||(st={})),function(n){n[n.None=0]="None";n[n.Initializing=1]="Initializing";n[n.Initialized=2]="Initialized";n[n.Ready=3]="Ready";n[n.Error=4]="Error";n[n.Disposed=5]="Disposed"}(ci=t.StartupState||(t.StartupState={}));ht=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.on=function(t,i,r,u,f){var e=this.owner,o=this,s=e.state===3,h=e.state===2||e.state===3;t==="load"&&s||t==="initialize"&&h?p.queue.enque(function(){i.apply(o,[o,{}])}):n.prototype.on.call(this,t,i,r,u,f)},t}(i.ObjectEvents);t.registerConverter=ct;t.getConverter=li;t.registerSvc=lt;t.unregisterSvc=at;t.getSvc=vt;t.getOptions=yt;t.registerObject=g;t.unregisterObject=pt;t.getObject=d;it=function(n){function o(){var i=n.call(this)||this,o=i;if(!!t.bootstrapper)throw new Error(k.ERR_GLOBAL_SINGLTON);return i._bootState=0,i._app=null,i._selectedControl=null,i._uniqueID=gt("app"),i._extraData=tt(),i._moduleInits=[],i._templateLoader=null,i._templateLoader=new e.TemplateLoader,i._templateLoader.addOnLoaded(function(n,t){o._onTemplateLoaded(t.html,t.owner)}),i._templateLoader.objEvents.addOnError(function(n,t){return o.handleError(t.error,t.source)}),i._elViewRegister=r.createElViewRegister(null),i._contentFactory=u.createContentFactoryList(),i._internal={initialize:function(){return o._initialize()},registerApp:function(n){o._registerApp(n)},unregisterApp:function(n){o._unregisterApp(n)}},i._defaults=new f.Defaults,i.defaults.imagesPath=s.PathHelper.getFrameworkImgPath(),ot.loadOwnStyle(),y.addHandler("*",i),i}return __extends(o,n),o._initFramework=function(){a.ready(function(){t.bootstrapper._getInternal().initialize()})},o.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this;t.objEvents.off();t._destroyApp();t._extraData=tt();t._templateLoader!==null&&(t._templateLoader.dispose(),t._templateLoader=null);t._elViewRegister.dispose();t._elViewRegister=null;t._contentFactory=null;t._moduleInits=[];a.events.offNS(v,this._uniqueID);a.events.offNS(b,this._uniqueID);b.onerror=null;y.removeHandler("*");this._bootState=5;n.prototype.dispose.call(this)}},o.prototype._bindGlobalEvents=function(){var u=this,n=this,r=t.subscribeWeakMap,f=t.selectableProviderWeakMap;a.events.on(v,"click",function(t){for(var i=t.target,r;!!i&&i!==v;){if(r=f.get(i),!!r){n.selectedControl=r;return}i=i.parentElement}n.selectedControl=null},this._uniqueID);dt(hi,function(n,t){var i="handle_"+n;a.events.on(v,n,function(n){var t=r.get(n.target);rt(t[i])&&(n.cancelBubble=!!t[i](n.originalEvent))},{nmspace:u._uniqueID,matchElement:function(n){var i=r.get(n);return!!i&&!!i.isSubscribed(t)}})});a.events.on(v,"keydown",function(t){if(!!n._selectedControl){var i=n._selectedControl.selectable;if(!!i)i.onKeyDown(t.which,t)}},this._uniqueID);a.events.on(v,"keyup",function(t){if(!!n._selectedControl){var i=n._selectedControl.selectable;if(!!i)i.onKeyUp(t.which,t)}},this._uniqueID);a.events.on(b,"beforeunload",function(){n.objEvents.raise("unload",{})},this._uniqueID);b.onerror=function(n,t,r){return!!n&&n.toString().indexOf(i.DUMY_ERROR)>-1?!0:(alert("Error: "+n+"\nURL: "+t+"\nLine Number: "+r),!1)}},o.prototype._onTemplateLoaded=function(n,t){var i=v.createElement("div");i.innerHTML=n;this._processOptions(t,i);this._processTemplates(t,i)},o.prototype._processOptions=function(n,t){for(var r,u,e=a.queryAll(t,si),i=0,f=e;i<f.length;i++){if(r=f[i],u=r.getAttribute("id"),!u)throw new Error(k.ERR_OPTIONS_HAS_NO_ID);ai(n,u,r.innerHTML)}},o.prototype._processTemplates=function(n,t){for(var r,u,e,o=this,s=a.queryAll(t,oi),i=0,f=s;i<f.length;i++){if(r=f[i],u=r.getAttribute("id"),!u)throw new Error(k.ERR_TEMPLATE_HAS_NO_ID);e=r.innerHTML;o._processTemplate(n,u,e)}},o.prototype._processTemplate=function(n,t,i){var r=a.getDocFragment(et(i)),u=vi(r),f=kt({doc:r,required:u},!0),o=function(){return f};e.registerLoader(n,t,o)},o.prototype._createObjEvents=function(){return new ht(this)},o.prototype._init=function(){var n=this,t=n.stylesLoader.whenAllLoaded().then(function(){if(n._bootState!==0)throw new Error("Invalid operation: bootState !== BootstrapState.None");return n._bootState=1,n._bindGlobalEvents(),n._bootState=2,n.objEvents.raise("initialize",{}),n.objEvents.off("initialize"),bt(function(){if(n.getIsStateDirty())throw new Error("Bootstrap is in destroyed state");return n._processOptions(n,v),n._processTemplates(n,v),n._bootState=3,n.objEvents.raiseProp("isReady"),n})});return t.then(function(n){if(n._bootState!==3)throw new Error("Invalid operation: bootState !== BootstrapState.Ready");return n.objEvents.raise("load",{}),n.objEvents.off("load"),n})},o.prototype._initialize=function(){var t=this,n=this;return n._init().then(function(){return n},function(i){return n._bootState=4,y.reThrow(i,t.handleError(i,n))})},o.prototype._registerApp=function(n){if(!!this._app)throw new Error("Application already registered");this._app=n;y.addHandler(n.appName,n)},o.prototype._unregisterApp=function(n){if(!this._app||this._app.appName!==n.appName)throw new Error("Invalid operation");try{y.removeHandler(n.appName)}finally{this._app=null}},o.prototype._destroyApp=function(){var t=this,n=t._app;!n||n.getIsStateDirty()||n.dispose()},o.prototype._waitLoaded=function(n){var t=this;t.init(function(){t.addOnLoad(function(){setTimeout(function(){try{n(t)}catch(i){y.reThrow(i,t.handleError(i,t))}},0)})})},o.prototype._getInternal=function(){return this._internal},o.prototype.addOnDisposed=function(n,t,i){this.objEvents.addOnDisposed(n,t,i)},o.prototype.offOnDisposed=function(n){this.objEvents.offOnDisposed(n)},o.prototype.addOnError=function(n,t,i){this.objEvents.addOnError(n,t,i)},o.prototype.offOnError=function(n){this.objEvents.offOnError(n)},o.prototype.addOnLoad=function(n,t,i){this.objEvents.on("load",n,t,i)},o.prototype.addOnUnLoad=function(n,t,i){this.objEvents.on("unload",n,t,i)},o.prototype.addOnInitialize=function(n,t,i){this.objEvents.on("initialize",n,t,i)},o.prototype.addModuleInit=function(n){return this._moduleInits.filter(function(t){return t===n}).length===0?(this._moduleInits.push(n),!0):!1},o.prototype.getData=function(){return this._extraData},o.prototype.init=function(n){var t=this;t.addOnInitialize(function(){setTimeout(function(){try{n(t)}catch(i){y.reThrow(i,t.handleError(i,t))}},0)})},o.prototype.startApp=function(n,t){var i=this,r=wt(),u=r.promise();return i._waitLoaded(function(){try{var i=n();r.resolve(i.startUp(t))}catch(u){r.reject(u)}}),u.then(function(n){return n},function(n){return y.reThrow(n,i.handleError(n,i))})},o.prototype.registerSvc=function(n,t){lt(this,n,t)},o.prototype.unregisterSvc=function(n){at(this,n)},o.prototype.getSvc=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];if(i=vt.apply(void 0,__spreadArray([this,n],r)),!i)throw new Error("The service: "+n+" is not registered");return i},o.prototype.getOptions=function(n){var t=yt(this,n);if(!t)throw new Error(ft(k.ERR_OPTIONS_NOTREGISTERED,n));return t},o.prototype.registerConverter=function(n,t){ct(this,n,t)},o.prototype.registerElView=function(n,t){this._elViewRegister.registerElView(n,t)},o.prototype.getImagePath=function(n){var t=this.defaults.imagesPath;return t+n},o.prototype.loadOwnStyle=function(n){return this.stylesLoader.loadOwnStyle(n)},o.prototype.toString=function(){return"JRIApp Bootstrap"},Object.defineProperty(o.prototype,"app",{get:function(){return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stylesLoader",{get:function(){return ot},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"elViewRegister",{get:function(){return this._elViewRegister},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"contentFactory",{get:function(){return this._contentFactory},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"templateLoader",{get:function(){return this._templateLoader},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selectedControl",{get:function(){return this._selectedControl},set:function(n){this._selectedControl!==n&&(this._selectedControl=n,this.objEvents.raiseProp("selectedControl"))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"defaults",{get:function(){return this._defaults},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isReady",{get:function(){return this._bootState===3},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"state",{get:function(){return this._bootState},enumerable:!1,configurable:!0}),o}(i.BaseObject);t.Bootstrapper=it;t.bootstrapper=new it});define("jriapp/utils/viewchecks",["require","exports"],function(n,t){"use strict";function i(){return!1}function r(){return!1}Object.defineProperty(t,"__esModule",{value:!0});t.ViewChecks=void 0;var u=function(){function n(){}return n.isElView=i,n.isTemplateElView=r,n.isDataForm=function(){return!1},n.isInsideDataForm=function(){return!1},n.isInNestedForm=function(){return!1},n.getParentDataForm=function(){return null},n}();t.ViewChecks=u});define("jriapp/converter",["require","exports","jriapp_shared","jriapp/bootstrapper"],function(n,t,i,r){"use strict";var l,a,tt,v,h,y,f,p,it,w,rt,b,ut,k,ft,d,et;Object.defineProperty(t,"__esModule",{value:!0});t.NotConverter=t.FloatConverter=t.DecimalConverter=t.SmallIntConverter=t.IntegerConverter=t.NumberConverter=t.DateTimeConverter=t.DateConverter=t.baseConverter=t.BaseConverter=t.NUM_CONV=void 0;var o=i.Utils,g=o.check,s=g.isNt,ot=g.isNumber,c=o.str,st=c.format,ht=c.stripNonNumeric,e=c.formatNumber,ct=o.core.round,nt=o.dates,lt=nt.strToDate,at=nt.dateToStr,u=r.bootstrapper,vt=i.LocaleERRS;t.NUM_CONV={None:0,Integer:1,Decimal:2,Float:3,SmallInt:4};l=function(){function n(){}return n.prototype.convertToSource=function(n){return n},n.prototype.convertToTarget=function(n){return s(n)?null:n},n}();t.BaseConverter=l;t.baseConverter=new l;a=function(){function n(){}return n.prototype.convertToSource=function(n,t,i){if(!n)return null;var f=u.defaults,r=u.getSvc("IDatepicker");return!r?h.convertToSource(n,f.dateFormat,i):r.parseDate(n)},n.prototype.convertToTarget=function(n,t,i){if(s(n))return"";var f=u.defaults,r=u.getSvc("IDatepicker");return!r?h.convertToTarget(n,f.dateFormat,i):r.formatDate(n)},n.prototype.toString=function(){return"DateConverter"},n}();t.DateConverter=a;tt=new a;v=function(){function n(){}return n.prototype.convertToSource=function(n,t){return lt(n,t)},n.prototype.convertToTarget=function(n,t){return at(n,t)},n.prototype.toString=function(){return"DateTimeConverter"},n}();t.DateTimeConverter=v;h=new v;y=function(){function n(){}return n.prototype.convertToSource=function(n,i){var f;if(s(n))return null;var e=r.bootstrapper.defaults,h=e.decimalPoint,c=e.thousandSep,o=4,u=n.replace(c,"");if(u=u.replace(h,"."),u=ht(u),u==="")return null;f=null;switch(i){case t.NUM_CONV.SmallInt:f=parseInt(u,10);break;case t.NUM_CONV.Integer:f=parseInt(u,10);break;case t.NUM_CONV.Decimal:o=e.decPrecision;f=ct(parseFloat(u),o);break;case t.NUM_CONV.Float:f=parseFloat(u);break;default:f=Number(u)}if(!ot(f))throw new Error(st(vt.ERR_CONV_INVALID_NUM,n));return f},n.prototype.convertToTarget=function(n,i){if(s(n))return"";var h=r.bootstrapper.defaults,f=h.decimalPoint,o=h.thousandSep,u;switch(i){case t.NUM_CONV.Integer:return u=0,e(n,u,f,o);case t.NUM_CONV.Decimal:return u=h.decPrecision,e(n,u,f,o);case t.NUM_CONV.SmallInt:return u=0,e(n,u,f,"");case t.NUM_CONV.Float:return e(n,null,f,o);default:return e(n,null,f,o)}},n.prototype.toString=function(){return"NumberConverter"},n}();t.NumberConverter=y;f=new y;p=function(){function n(){}return n.prototype.convertToSource=function(n,i,r){return f.convertToSource(n,t.NUM_CONV.Integer,r)},n.prototype.convertToTarget=function(n,i,r){return f.convertToTarget(n,t.NUM_CONV.Integer,r)},n.prototype.toString=function(){return"IntegerConverter"},n}();t.IntegerConverter=p;it=new p;w=function(){function n(){}return n.prototype.convertToSource=function(n,i,r){return f.convertToSource(n,t.NUM_CONV.SmallInt,r)},n.prototype.convertToTarget=function(n,i,r){return f.convertToTarget(n,t.NUM_CONV.SmallInt,r)},n.prototype.toString=function(){return"SmallIntConverter"},n}();t.SmallIntConverter=w;rt=new w;b=function(){function n(){}return n.prototype.convertToSource=function(n,i,r){return f.convertToSource(n,t.NUM_CONV.Decimal,r)},n.prototype.convertToTarget=function(n,i,r){return f.convertToTarget(n,t.NUM_CONV.Decimal,r)},n.prototype.toString=function(){return"DecimalConverter"},n}();t.DecimalConverter=b;ut=new b;k=function(){function n(){}return n.prototype.convertToSource=function(n,i,r){return f.convertToSource(n,t.NUM_CONV.Float,r)},n.prototype.convertToTarget=function(n,i,r){return f.convertToTarget(n,t.NUM_CONV.Float,r)},n.prototype.toString=function(){return"FloatConverter"},n}();t.FloatConverter=k;ft=new k;d=function(){function n(){}return n.prototype.convertToSource=function(n){return!n},n.prototype.convertToTarget=function(n){return!n},n}();t.NotConverter=d;et=new d;u.registerConverter("BaseConverter",t.baseConverter);u.registerConverter("dateConverter",tt);u.registerConverter("dateTimeConverter",h);u.registerConverter("numberConverter",f);u.registerConverter("integerConverter",it);u.registerConverter("smallIntConverter",rt);u.registerConverter("decimalConverter",ut);u.registerConverter("floatConverter",ft);u.registerConverter("notConverter",et)});define("jriapp/binding",["require","exports","jriapp_shared","jriapp/bootstrapper"],function(n,t,i,r){"use strict";function v(n,t,i,r){if(e.isDebugging()){e.checkStartDebugger();var u="Unresolved data binding for ";u+=n===0?" Source: ":" Target: ";u+="'"+t+"'";u+=", property: '"+r+"'";u+=", binding path: '"+i+"'";it.error(u)}}function et(n,t,i,r,u){if(e.isDebugging()){e.checkStartDebugger();var f="Maximum recursion exceeded for ";f+=n===0?"Updating Source value: ":"Updating Target value: ";f+=" source:'"+t+"'";f+=", target:'"+i+"'";f+=", source path: '"+r+"'";f+=", target path: '"+u+"'";it.error(f)}}function ht(n,t,i){var r={targetPath:null,sourcePath:null,target:null,source:null,isSourceFixed:!1,mode:1,converter:null,param:null,isBind:!1},e=ft.app,o,u,f;return o=c(n.converter)?e.getConverter(n.converter):n.converter,u=n.source,f=n.target,n.sourcePath||!n.to?!n.sourcePath||(r.sourcePath=n.sourcePath):r.sourcePath=n.to,!n.targetPath||(r.targetPath=n.targetPath),!n.param||(r.param=n.param,r.isBind=n.isBind),!n.mode||(r.mode=w[n.mode]),!o||(r.converter=o),r.target=f?c(f)?f==="this"?t:a(e,f):f:t,u?(r.isSourceFixed=!0,r.source=c(u)?u==="this"?t:a(e,u):u):r.source=i,r}var w,b;Object.defineProperty(t,"__esModule",{value:!0});t.Binding=t.getBindingOptions=void 0;var f=i.Utils,h=f.check,c=h.isString,k=h.isUndefined,d=h.isNt,g=h._undefined,nt=h.isHasProp,l=f.str.format,y=f.core,ot=y.getNewID,st=y.forEach,tt=y.Indexer,u=f.sys,e=f.debug,it=f.log,o=i.LocaleERRS,a=u.resolvePath,rt=u.getPathParts,p=u.getErrorNotification,s=u.getProp,ut=u.setProp,ft=r.bootstrapper;u.isBinding=function(n){return!!n&&n instanceof b};w={OneTime:0,OneWay:1,TwoWay:2,BackWay:3};t.getBindingOptions=ht;b=function(n){function t(t){var i=n.call(this)||this,r;if(c(t.mode)&&(t.mode=w[t.mode]),!c(t.targetPath)){e.checkStartDebugger();throw new Error(l(o.ERR_BIND_TGTPATH_INVALID,t.targetPath));}if(d(t.mode)){e.checkStartDebugger();throw new Error(l(o.ERR_BIND_MODE_INVALID,t.mode));}if(!t.target)throw new Error(o.ERR_BIND_TARGET_EMPTY);if(!u.isBaseObj(t.target))throw new Error(o.ERR_BIND_TARGET_INVALID);if(i._state=null,i._mode=t.mode,i._converter=t.converter?t.converter:null,i._param=t.param,i._isBindParam=!!t.isBind,i._srcPath=rt(t.sourcePath),i._tgtPath=rt(t.targetPath),i._tgtPath.length<1)throw new Error(l(o.ERR_BIND_TGTPATH_INVALID,t.targetPath));return i._srcFixed=!!t.isSourceFixed,i._pathItems=tt(),i._uniqueID=ot("bnd"),i._srcEnd=null,i._tgtEnd=null,i._source=null,i._target=null,i._umask=0,i._cntUtgt=0,i._cntUSrc=0,i._setTarget(t.target),i._setSource(t.source),i._update(),r=p(i._srcEnd),!!r&&r.getIsHasErrors()&&i._onSrcErrChanged(r),i}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this;st(this._pathItems,function(n,i){t._cleanUp(i)});this._pathItems=tt();this._setSource(null);this._setTarget(null);this._state=null;this._converter=null;this._param=null;this._srcPath=null;this._tgtPath=null;this._srcEnd=null;this._tgtEnd=null;this._source=null;this._target=null;this._umask=0;n.prototype.dispose.call(this)}},t.prototype._update=function(){var t=this._umask,i=3,n=0;this._umask=0;this._mode===3?!(t&1)||(n=1):(t&2)?n=2:!(t&1)||this._mode!==2||(n=1);switch(n){case 1:if(this._cntUtgt===0)if(this._cntUSrc<i){this._cntUSrc+=1;try{this.updateSource()}finally{this._cntUSrc-=1}}else et(0,this._source,this._target,this._srcPath.join("."),this._tgtPath.join("."));break;case 2:if(this._cntUSrc===0)if(this._cntUtgt<i){this._cntUtgt+=1;try{this.updateTarget()}finally{this._cntUtgt-=1}}else et(1,this._source,this._target,this._srcPath.join("."),this._tgtPath.join("."))}},t.prototype._onSrcErrChanged=function(n){var i=[],r=this._tgtEnd,e=this._srcEnd,t=this._srcPath,f;u.isValidatable(r)&&(!!e&&t.length>0&&(f=t[t.length-1],i=n.getFieldErrors(f)),r.validationErrors=i)},t.prototype._getTgtChangedFn=function(n,t,i,r,u){return function(){var f=s(t,i);r.length>0&&n._setPathItem(null,1,u,r);n._parseTgt(f,r,u);n._update()}},t.prototype._getSrcChangedFn=function(n,t,i,r,u){return function(){var f=s(t,i);r.length>0&&n._setPathItem(null,0,u,r);n._parseSrc(f,r,u);n._update()}},t.prototype._addOnPropChanged=function(n,t,i){n.objEvents.onProp(t,i,this._uniqueID);if(t!=="[*]"&&u.isPropBag(n))n.objEvents.onProp("[*]",i,this._uniqueID)},t.prototype._parseSrc=function(n,t,i){var r=this;(r._srcEnd=null,u.isBaseObj(n)&&n.getIsStateDirty())||(t.length===0?r._srcEnd=n:r._parseSrc2(n,t,i),r._mode===3?!r._srcEnd||(r._umask|=1):!r._tgtEnd||(r._umask|=2))},t.prototype._parseSrc2=function(n,t,i){var r=this,f=u.isBaseObj(n),c,o,l,a,y,h;if(f){if(n.getIsStateDirty())return;r._setPathItem(n,0,i,t)}if(t.length>1){f&&(c=r._getSrcChangedFn(r,n,t[0],t.slice(1),i+1),r._addOnPropChanged(n,t[0],c));!n||(o=s(n,t[0]),o?r._parseSrc2(o,t.slice(1),i+1):k(o)&&v(0,r.source,r._srcPath.join("."),t[0]));return}!n||t.length!==1||(l=e.isDebugging()?f?n.isHasProp(t[0]):nt(n,t[0]):!0,l?(a=f&&(r._mode===1||r._mode===2),a&&(y=function(){!r._tgtEnd||(r._umask|=2,r._update())},r._addOnPropChanged(n,t[0],y)),h=p(n),!h||h.addOnErrorsChanged(r._onSrcErrChanged,r._uniqueID,r),r._srcEnd=n):v(0,r.source,r._srcPath.join("."),t[0]))},t.prototype._parseTgt=function(n,t,i){var r=this;(r._tgtEnd=null,u.isBaseObj(n)&&n.getIsStateDirty())||(t.length===0?r._tgtEnd=n:r._parseTgt2(n,t,i),r._mode===3?!r._srcEnd||(this._umask|=1):!r._tgtEnd||(this._umask|=2))},t.prototype._parseTgt2=function(n,t,i){var r=this,f=u.isBaseObj(n),h,o,c,l,a;if(f){if(n.getIsStateDirty())return;r._setPathItem(n,1,i,t)}if(t.length>1){f&&(h=r._getTgtChangedFn(r,n,t[0],t.slice(1),i+1),r._addOnPropChanged(n,t[0],h));!n||(o=s(n,t[0]),o?r._parseTgt2(o,t.slice(1),i+1):k(o)&&v(1,r.target,r._tgtPath.join("."),t[0]));return}!n||t.length!==1||(c=e.isDebugging()?f?n.isHasProp(t[0]):nt(n,t[0]):!0,c?(l=f&&(r._mode===2||r._mode===3),l&&(a=function(){!r._srcEnd||(r._umask|=1,r._update())},r._addOnPropChanged(n,t[0],a)),r._tgtEnd=n):v(1,r.target,r._tgtPath.join("."),t[0]))},t.prototype._setPathItem=function(n,t,i,r){for(var f,e,s=i+r.length,u=i;u<s;u+=1){if(f=t===0?"s"+u:t===1?"t"+u:null,!f)throw new Error(l(o.ERR_PARAM_INVALID,"bindingTo",t));e=this._pathItems[f];!e||(this._cleanUp(e),delete this._pathItems[f]);!n||u!==i||(this._pathItems[f]=n)}},t.prototype._cleanUp=function(n){if(!!n){n.objEvents.offNS(this._uniqueID);var t=p(n);!t||t.offOnErrorsChanged(this._uniqueID)}},t.prototype._setTarget=function(n){if(!!this._state)return this._state.target=n,!1;if(this._target!==n){if(!!this._tgtEnd&&!(this._mode===3)){this._cntUtgt+=1;try{this.targetValue=null}finally{if(this._cntUtgt-=1,this._cntUtgt<0)throw new Error("Invalid operation: this._cntUtgt = "+this._cntUtgt);}}if(this._setPathItem(null,1,0,this._tgtPath),!!n&&!u.isBaseObj(n))throw new Error(o.ERR_BIND_TARGET_INVALID);if(this._target=n,this._parseTgt(this._target,this._tgtPath,0),!!this._target&&!this._tgtEnd)throw new Error(l(o.ERR_BIND_TGTPATH_INVALID,this._tgtPath.join(".")));return!0}return!1},t.prototype._setSource=function(n){if(!!this._state)return this._state.source=n,!1;if(this._source!==n){if(!!this._srcEnd&&this._mode===3){this._cntUSrc+=1;try{this.sourceValue=null}finally{if(this._cntUSrc-=1,this._cntUSrc<0)throw new Error("Invalid Operation: this._cntUSrc = "+this._cntUSrc);}}return this._setPathItem(null,0,0,this._srcPath),this._source=n,this._parseSrc(this._source,this._srcPath,0),!0}return!1},t.prototype.updateTarget=function(){if(!this.getIsStateDirty())try{this.targetValue=this._converter?this._converter.convertToTarget(this.sourceValue,this.param,this.source):this.sourceValue}catch(n){f.err.reThrow(n,this.handleError(n,this))}},t.prototype.updateSource=function(){if(!this.getIsStateDirty())try{this.sourceValue=this._converter?this._converter.convertToSource(this.targetValue,this.param,this.source):this.targetValue}catch(n){u.isValidationError(n)&&u.isValidatable(this._tgtEnd)||f.err.reThrow(n,this.handleError(n,this))}},t.prototype.toString=function(){return"Binding"},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(n){this._setTarget(n)&&this._update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(n){this._setSource(n)&&this._update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetPath",{get:function(){return this._tgtPath},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourcePath",{get:function(){return this._srcPath},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sourceValue",{get:function(){var n=null,t;return this._srcPath.length===0?n=this._srcEnd:!this._srcEnd||(t=this._srcPath[this._srcPath.length-1],n=s(this._srcEnd,t)),n},set:function(n){if(this._srcPath.length!==0&&this._srcEnd&&n!==g){var t=this._srcPath[this._srcPath.length-1];ut(this._srcEnd,t,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetValue",{get:function(){var n=null,t;return this._tgtPath.length===0?n=this._tgtEnd:!this._tgtEnd||(t=this._tgtPath[this._tgtPath.length-1],n=s(this._tgtEnd,t)),n},set:function(n){if(this._tgtPath.length!==0&&this._tgtEnd&&n!==g){var t=this._tgtPath[this._tgtPath.length-1];ut(this._tgtEnd,t,n)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSourceFixed",{get:function(){return this._srcFixed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"converter",{get:function(){return this._converter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"param",{get:function(){if(this._isBindParam){if(d(this._param))return this._param;var n=this._param,t=this.source;return n.length>1&&(t=a(this.app,n[1])),a(t,n[0])}return this._param},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDisabled",{get:function(){return!!this._state},set:function(n){var t;if(n=!!n,this.isDisabled!==n)if(n){t={source:this._source,target:this._target};try{this.target=null;this.source=null}finally{this._state=t}}else t=this._state,this._state=null,this._setTarget(t.target),this._setSource(t.source),this._update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return ft.app},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Binding=b});define("jriapp/template",["require","exports","jriapp_shared","jriapp/bootstrapper","jriapp/utils/viewchecks","jriapp/utils/dom"],function(n,t,i,r,u,f){"use strict";function tt(n){return new v(n)}var v;Object.defineProperty(t,"__esModule",{value:!0});t.createTemplate=t.css=void 0;var e=i.Utils,c=e.async.reject,o=f.DomUtils,y=u.ViewChecks,a=e.check,p=a.isFunc,w=a.isThenable,s=e.str.format,b=e.arr,k=e.sys,d=r.bootstrapper,h=i.LocaleERRS,l=e.err,g=o.document,nt;(function(n){n.templateContainer="ria-template-container";n.templateError="ria-template-error"})(nt=t.css||(t.css={}));t.createTemplate=tt;v=function(n){function t(t){var i=n.call(this)||this,r;return t.parentEl===null?(r=g.createElement("div"),o.addClass([r],"ria-template-container"),i._el=r,i._removeElOnDispose=!0):(i._el=t.parentEl,i._removeElOnDispose=!1),i._dataContext=t.dataContext,i._templEvents=t.templEvents,i._isLoaded=!1,i._lfTime=null,i._templateID=null,i._templElView=null,i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._unloadTemplate(),!!this._el&&this._removeElOnDispose&&o.removeNode(this._el),this._el=null,this._dataContext=null,this._templEvents=null,n.prototype.dispose.call(this))},t.prototype._getBindings=function(){return this._lfTime?this._lfTime.findAll(k.isBinding):[]},t.prototype._getTemplateElView=function(){return this._lfTime?this._lfTime.findFirst(y.isTemplateElView):null},t.prototype._loadAsync=function(n){var r=this,t=this.app.getTemplateLoader(n),i;return p(t)&&w(i=t())?i:c(new Error(s(h.ERR_TEMPLATE_ID_INVALID,r.templateID)))},t.prototype._loadTemplate=function(){var n=this,t=n.templateID,i=n.el;try{return n._isLoaded&&n._unloadTemplate(),t?n._loadAsync(t).then(function(t){return n._dataBind(i,t)}).catch(function(t){if(!t||!t.message)throw new Error(s(h.ERR_TEMPLATE_ID_INVALID,n.templateID));else throw t;}):c(s(h.ERR_TEMPLATE_ID_INVALID,n.templateID))}catch(r){return c(r)}},t.prototype._onLoading=function(){!this._templEvents||this._templEvents.templateLoading(this)},t.prototype._onLoaded=function(n){this._templElView=this._getTemplateElView();!this._templEvents||this._templEvents.templateLoaded(this,n);!this._templElView||this._templElView.templateLoaded(this,n)},t.prototype._unloadTemplate=function(){try{!this._templEvents||this._templEvents.templateUnLoading(this);!this._templElView||this._templElView.templateUnLoading(this)}finally{this._cleanUp()}},t.prototype._dataBind=function(n,t){var i=this,r;if(i.getIsStateDirty()&&l.abort(),i._isLoaded&&i._unloadTemplate(),!t)throw new Error(s(h.ERR_TEMPLATE_ID_INVALID,i.templateID));return n.appendChild(t.doc.cloneNode(!0)),i._isLoaded=!0,o.removeClass([n],"ria-template-error"),i._onLoading(),r=i.app._getInternal().bindTemplate(n,this.dataContext,t.required),r.then(function(r){return i.getIsStateDirty()&&(r.dispose(),l.abort()),!t.required||(t.required=null),i._lfTime=r,i._updateBindingSource(),i._onLoaded(null),n})},t.prototype._onFail=function(n,t){var i=this,r;i.getIsStateDirty()||(i._onLoaded(t),l.checkIsAbort(t))||(o.setClass([n],"ria-template-error",!1),!t||(r=t.message?t:t.statusText?new Error(t.statusText):new Error("error: "+t)),r||(r=new Error(s(h.ERR_TEMPLATE_ID_INVALID,i.templateID))),i.handleError(r,i))},t.prototype._updateBindingSource=function(){for(var t,i=this._getBindings(),r=i.length,n=0;n<r;n+=1)t=i[n],t.isSourceFixed||(t.source=this.dataContext)},t.prototype._cleanUp=function(){!this._lfTime||(this._lfTime.dispose(),this._lfTime=null);this._templElView=null;this._isLoaded&&(this.el.innerHTML="",this._isLoaded=!1)},t.prototype.findElByDataName=function(n){return b.fromList(this._el.querySelectorAll(["*[","data-name",'="',n,'"]'].join("")))},t.prototype.findElViewsByDataName=function(n){for(var f,i,e=this.findElByDataName(n),r=[],o=d.app.viewFactory.store,t=0,u=e;t<u.length;t++)f=u[t],i=o.getElView(f),!i||r.push(i);return r},t.prototype.toString=function(){return"ITemplate"},Object.defineProperty(t.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){this._dataContext!==n&&(this._dataContext=n,this._updateBindingSource(),this.objEvents.raiseProp("dataContext"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templateID",{get:function(){return this._templateID},set:function(n){var t=this,i;this._templateID!==n&&(this._templateID=n,i=this.el,this._loadTemplate().catch(function(n){t.getIsStateDirty()||t._onFail(i,n)}),this.objEvents.raiseProp("templateID"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return r.bootstrapper.app},enumerable:!1,configurable:!0}),t}(i.BaseObject)});define("jriapp/utils/lifetime",["require","exports","jriapp_shared"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LifeTimeScope=void 0;var r=i.Utils,u=function(n){function t(){var t=n.call(this)||this;return t._objs=[],t}return __extends(t,n),t.prototype.dispose=function(){var t,i,r;if(!this.getIsDisposed()){for(this.setDisposing(),t=0,i=this._objs;t<i.length;t++)r=i[t],r.getIsStateDirty()||r.dispose();this._objs=[];n.prototype.dispose.call(this)}},t.prototype.addObj=function(n){this._objs.push(n)},t.prototype.removeObj=function(n){r.arr.remove(this._objs,n)},t.prototype.getObjs=function(){return this._objs},t.prototype.findAll=function(n){return this._objs.filter(n)},t.prototype.findFirst=function(n){for(var i=this._objs,r=i.length,t=0;t<r;t+=1)if(n(i[t]))return i[t];return null},t.prototype.toString=function(){return"LifeTimeScope"},t}(i.BaseObject);t.LifeTimeScope=u});define("jriapp/utils/propwatcher",["require","exports","jriapp_shared"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PropWatcher=void 0;var r=i.Utils.core,u=function(n){function t(){var t=n.call(this)||this;return t._uniqueID=r.getNewID("prw"),t._objs=[],t}return __extends(t,n),t.prototype.dispose=function(){var r,t,i,u;if(!this.getIsDisposed()){for(this.setDisposing(),r=this,t=0,i=this._objs;t<i.length;t++)u=i[t],r.removeWatch(u);this._objs=[];n.prototype.dispose.call(this)}},t.create=function(){return new t},t.prototype.addPropWatch=function(n,t,i){var r=this;n.objEvents.onProp(t,function(n,t){i(t.property)},r.uniqueID);r._objs.indexOf(n)<0&&r._objs.push(n)},t.prototype.addWatch=function(n,t,i){var r=this;n.objEvents.onProp("*",function(n,r){t.indexOf(r.property)>-1&&i(r.property)},r.uniqueID);r._objs.indexOf(n)<0&&r._objs.push(n)},t.prototype.removeWatch=function(n){n.objEvents.offNS(this.uniqueID)},t.prototype.toString=function(){return"PropWatcher "+this._uniqueID},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.PropWatcher=u});define("jriapp/mvvm",["require","exports","jriapp_shared"],function(n,t,i){"use strict";var r,f,u,e,o;Object.defineProperty(t,"__esModule",{value:!0});t.ViewModel=t.BaseCommand=t.Command=void 0;r=i.Utils.core.getNewID,function(n){n.can_execute_changed="canExecute_changed"}(f||(f={}));u=function(n){function t(t,i){var u=n.call(this)||this;return u._uniqueID=r("cmd"),u._action=t,u._predicate=i,u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._action=null,this._predicate=null,n.prototype.dispose.call(this))},t.prototype._canExecute=function(n){var t=this._predicate;return t?t(n):!0},t.prototype._execute=function(n){var t=this._action;!t||t(n)},t.prototype.addOnCanExecuteChanged=function(n,t,i){this.objEvents.on("canExecute_changed",n,t,i)},t.prototype.offOnCanExecuteChanged=function(n){this.objEvents.off("canExecute_changed",n)},t.prototype.canExecute=function(n){return this._canExecute(n)},t.prototype.execute=function(n){this._execute(n)},t.prototype.raiseCanExecuteChanged=function(){this.objEvents.raise("canExecute_changed",{})},t.prototype.toString=function(){return"Command"},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Command=u;e=function(n){function t(t){var i=n.call(this,null,null)||this;return i._owner=t,i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._owner=null,n.prototype.dispose.call(this))},t.prototype._canExecute=function(n){return this.isCanExecute(n)},t.prototype._execute=function(n){this.action(n)},Object.defineProperty(t.prototype,"owner",{get:function(){return this._owner},enumerable:!1,configurable:!0}),t}(u);t.BaseCommand=e;o=function(n){function t(t){var i=n.call(this)||this;return i._app=t,i._uniqueID=r("vm"),i}return __extends(t,n),t.prototype.addOnDisposed=function(n,t,i){this.objEvents.addOnDisposed(n,t,i)},t.prototype.offOnDisposed=function(n){this.objEvents.offOnDisposed(n)},t.prototype.addOnError=function(n,t,i){this.objEvents.addOnError(n,t,i)},t.prototype.offOnError=function(n){this.objEvents.offOnError(n)},t.prototype.toString=function(){return"ViewModel"},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this._app},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.ViewModel=o});define("jriapp/utils/mloader",["require","exports","jriapp_shared","jriapp/int","jriapp/utils/sloader"],function(n,t,i,r,u){"use strict";function nt(){return o||(o=new p),o}function y(n){var t;if(!n||n.length===0)return c(void 0,!0);if(n.length===1)return n[0].defered.promise();var r=n.length,u=0,i=null;for(t=0;t<r;t+=1)n[t].state===2&&(++u,!n[t].err||(i=n[t].err));return u===r?i?k(i):c(void 0,!0):d(n.map(function(n){return n.defered.promise()}))}var v,p;Object.defineProperty(t,"__esModule",{value:!0});t.create=void 0;var f=i.Utils,s=f.core,w=s.forEach,h=s.Indexer,b=f.str.startsWith,e=f.async,k=e.reject,c=e.resolve,d=e.whenAll,l=e.createDeferred,g=f.arr,a="css!",o=null;t.create=nt,function(n){n[n.NONE=0]="NONE";n[n.LOADING=1]="LOADING";n[n.LOADED=2]="LOADED"}(v||(v={}));p=function(){function t(){this._loads=h();this._cssLoads=h()}return t.prototype.load=function(t){var i=this,e=t.filter(function(n){return i.isCSS(n)}),o=i.loadCSS(e),r=t.filter(function(n){return!i.isCSS(n)}),u=r.filter(function(n){return!i._loads[n]}),f;return u.length>0&&u.forEach(function(t){var r={name:t,err:null,state:1,defered:l(!0)};i._loads[t]=r;new Promise(function(i,r){n([t],i,r)}).then(function(){r.state=2;r.defered.resolve()},function(n){r.state=2;r.err=n;r.defered.reject("Error loading modules: "+n)})}),f=g.merge([r.map(function(n){return i._loads[n]}),o]),y(f)},t.prototype.whenAllLoaded=function(){var n=[];return w(this._loads,function(t,i){n.push(i)}),y(n)},t.prototype.loadCSS=function(n){var t=this,i=n.filter(function(n){return!t._cssLoads[n]}),f=i.map(function(n){return t.getUrl(n)}),r;return i.length>0&&(r=u.createCssLoader(),i.forEach(function(n){t._cssLoads[n]={name:n,err:null,state:1,defered:l(!0)}}),r.loadStyles(f).then(function(){i.forEach(function(n){var i=t._cssLoads[n];i.state=2;i.defered.resolve()})},function(n){i.forEach(function(i){var r=t._cssLoads[i];r.state=2;r.err=n;r.defered.reject(n)})})),n.map(function(n){return t._cssLoads[n]})},t.prototype.isCSS=function(n){return!!n&&b(n,a)},t.prototype.getUrl=function(n){this.isCSS(n)&&(n=n.substr(a.length));var t=r.Config.cssPath||"";return t=t.replace(/\/?$/,"/"),""+t+n},t}()});define("jriapp/databindsvc",["require","exports","jriapp_shared","jriapp/utils/lifetime","jriapp/utils/dom","jriapp/utils/mloader","jriapp/binding","jriapp/utils/viewchecks","jriapp/utils/parser"],function(n,t,i,r,u,f,e,o,s){"use strict";function k(n){return new c(n)}function d(n){for(var t,f=n.attributes,i={el:n,needToBind:!1,dataForm:!1,bindings:[],elView:null},o=f.length,r,e=!1,u=0;u<o;u++)t=f[u],y(t.name,"data-bind")&&i.bindings.push(t.value),t.name==="data-view"&&(r=t.value),t.name==="data-view-options"&&(e=!0);return r==="dataform"&&(i.dataForm=!0),i.needToBind=!!r||e||i.bindings.length>0,i.needToBind?i:null}function g(n){for(var f,i,r=[],e=v.queryAll(n,"*"),t=0,u=e;t<u.length;t++)f=u[t],i=d(f),!i||r.push(i);return r}function nt(n,t){var i=t.filter(function(n){return!!n.dataForm}).map(function(n){return n.el});return i.length===0?t:t.filter(function(t){return!a.isInNestedForm(n,i,t.el)})}var c;Object.defineProperty(t,"__esModule",{value:!0});t.createDataBindSvc=void 0;var h=i.Utils,l=h.async.createDeferred,a=o.ViewChecks,v=u.DomUtils,y=h.str.startsWith,p=s.Parser,w=h.core.forEach,b=h.arr.toMap;t.createDataBindSvc=k;c=function(n){function t(t){var i=n.call(this)||this;return i._app=t,i._root=t.appRoot,i._elViewFactory=t.viewFactory,i._objLifeTime=null,i._mloader=f.create(),i}return __extends(t,n),t.prototype.dispose=function(){this._cleanUp();this._elViewFactory=null;this._mloader=null;this._app=null;n.prototype.dispose.call(this)},t.prototype._cleanUp=function(){!this._objLifeTime||(this._objLifeTime.dispose(),this._objLifeTime=null)},t.prototype._bindElView=function(n){var s=this,f=n.bind,r=f.elView,t=f.bindings,h=n.dataContext,o,i,u;if((t===null||t===void 0?void 0:t.length)>0){o=p.parseBindings(t);try{for(r.bindingState=1,i=0,u=o;i<u.length;i++){var c=u[i],l=e.getBindingOptions(c,r,h),a=s.bind(l);n.lftm.addObj(a)}}finally{r.bindingState=0}}},t.prototype.bindTemplate=function(n,t,i){var r=this,u;return u=!!i&&i.length>0?r._mloader.load(i).then(function(){return r.bindElements({scope:n,bind:1,dataContext:t})}):r.bindElements({scope:n,bind:1,dataContext:t}),u.catch(function(n){h.queue.enque(function(){r.handleError(n,r)})}),u},t.prototype.bindElements=function(n){var t=this,o=l(!0),v=n.scope,u=new r.LifeTimeScope,y,s,f,h,p,k,d;try{for(y=g(v),s=nt(v,y),f=0,h=s;f<h.length;f++){var c=h[f],a=t._elViewFactory,e=a.getElView(c.el);e||(p=a.getElementViewInfo(c.el,n.dataContext),e=a.createElView(p),u.addObj(e));c.elView=e}k=s.map(function(i){return t._bindElView({bind:i,lftm:u,dataContext:n.dataContext}),i.elView}).filter(function(n){return!!n.viewMounted});d=b(k,function(n){return n.uniqueID});w(d,function(n,t){t.viewMounted()});o.resolve(u)}catch(tt){u.dispose();t.handleError(tt,t);setTimeout(function(){o.reject(new i.DummyError(tt))},0)}return o.promise()},t.prototype.setUpBindings=function(){var i=this._root,r=this._app,n=this,t;return this._cleanUp(),t=this.bindElements({scope:i,bind:0,dataContext:r}),t.then(function(t){if(n.getIsStateDirty()){t.dispose();return}n._objLifeTime=t})},t.prototype.bind=function(n){return new e.Binding(n)},t}(i.BaseObject)});define("jriapp/app",["require","exports","jriapp_shared","jriapp/bootstrapper","jriapp/utils/dom","jriapp/utils/tloader","jriapp/elview","jriapp/databindsvc"],function(n,t,i,r,u,f,e,o){"use strict";var it,rt;Object.defineProperty(t,"__esModule",{value:!0});t.Application=void 0;var h=i.Utils,v=u.DomUtils,w=v.document,a=h.str.format,b=h.check.isThenable,s=r.bootstrapper,k=h.sys,l=i.LocaleERRS,y=h.core,ut=y.forEach,ft=y.getNewID,d=y.memoize,c=y.Indexer,p=h.async,g=p.createDeferred,et=p.resolve,ot=p.reject,nt=h.http,tt;(function(n){n.startup="startup"})(tt||(tt={})),function(n){n[n.None=0]="None";n[n.Starting=1]="Starting";n[n.Started=2]="Started";n[n.Disposed=3]="Disposed";n[n.Error=4]="Error"}(it||(it={}));rt=function(n){function t(t){var r=n.call(this)||this;t||(t=c());var u=r,h=t.modulesInits||c(),f=i.APP_NAME;if(r._appName=f,r._options=t,!!s.app)throw new Error(a(l.ERR_APP_NAME_NOT_UNIQUE,f));return r._uniqueID=ft("app"),r._appState=0,r._moduleInits=h,r._viewFactory=e.createElViewFactory(s.elViewRegister),r._dataBindingService=o.createDataBindSvc(r),r._objMaps=[],r._extraData=c(),r._UC=c(),r._internal={bindTemplate:function(n,t,i){return u._dataBindingService.bindTemplate(n,t,i)},bindElements:function(n){return u._dataBindingService.bindElements(n)},getTemplateLoaderInfo:function(n){return u._getTemplateLoaderInfo(n)},getData:function(){return u._extraData}},s._getInternal().registerApp(r),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this;try{t._appState=3;s._getInternal().unregisterApp(t);t._cleanUpObjMaps();t._dataBindingService.dispose();t._dataBindingService=null;t._viewFactory.dispose();t._extraData=c();t._moduleInits=c();t._UC=c();t._options=null;t._viewFactory=null}finally{n.prototype.dispose.call(this)}}},t.prototype._cleanUpObjMaps=function(){for(var i,r=this,u=function(n){ut(n,function(t){var i=n[t];k.isBaseObj(i)&&(i.getIsDisposed()||i.objEvents.offNS(r.uniqueID))})},n=0,t=this._objMaps;n<t.length;n++)i=t[n],u(i);this._objMaps=[]},t.prototype._initAppModules=function(){var n=this,t=Object.keys(n._moduleInits);t.forEach(function(t){var i=n._moduleInits[t];i(n)})},t.prototype._getTemplateLoaderInfo=function(n){var t=f.getLoader(this,n);return t||(t=f.getLoader(s,n)),t},t.prototype.onStartUp=function(){},t.prototype._getInternal=function(){return this._internal},t.prototype.addOnDisposed=function(n,t,i){this.objEvents.addOnDisposed(n,t,i)},t.prototype.offOnDisposed=function(n){this.objEvents.offOnDisposed(n)},t.prototype.addOnError=function(n,t,i){this.objEvents.addOnError(n,t,i)},t.prototype.offOnError=function(n){this.objEvents.offOnError(n)},t.prototype.addOnStartUp=function(n,t,i){this.objEvents.on("startup",n,t,i)},t.prototype.offOnStartUp=function(n){this.objEvents.off("startup",n)},t.prototype.getData=function(){return this._extraData},t.prototype.bind=function(n){return this._dataBindingService.bind(n)},t.prototype.registerConverter=function(n,t){r.registerConverter(this,n,t)},t.prototype.getConverter=function(n){var t=r.getConverter(this,n);if(t||(t=r.getConverter(s,n)),!t)throw new Error(a(l.ERR_CONVERTER_NOTREGISTERED,n));return t},t.prototype.registerSvc=function(n,t){r.registerSvc(this,n,t)},t.prototype.unregisterSvc=function(n){r.unregisterSvc(this,n)},t.prototype.getSvc=function(n){for(var t,u=[],i=1;i<arguments.length;i++)u[i-1]=arguments[i];if(t=r.getSvc.apply(void 0,__spreadArray([this,n],u)),t||(t=r.getSvc.apply(void 0,__spreadArray([s,n],u))),!t)throw new Error("The service: "+n+" is not registered");return t},t.prototype.registerElView=function(n,t){this._viewFactory.register.registerElView(n,t)},t.prototype.registerObject=function(n,t){var i=this,f="obj."+n,u;k.isBaseObj(t)&&t.objEvents.addOnDisposed(function(){r.unregisterObject(i,f)},i.uniqueID);u=r.registerObject(i,f,t);this._objMaps.indexOf(u)<0&&this._objMaps.push(u)},t.prototype.getObject=function(n){var t="obj."+n;return r.getObject(this,t)},t.prototype.startUp=function(n){var t=this,i=g(),r,u;if(this._appState!==0)return i.reject(new Error("Application can not be started when state != AppState.None"));r=function(){var r,u,f;try{t._initAppModules();r=t.onStartUp();u=void 0;u=b(r)?r:g().resolve();f=u.then(function(){t.objEvents.raise("startup",{});var r=!n?null:n.apply(t,[t]);return b(r)?r.then(function(){return t._dataBindingService.setUpBindings()},function(n){i.reject(n);throw n;}):t._dataBindingService.setUpBindings()});f.then(function(){i.resolve(t)},function(n){i.reject(n)})}catch(e){i.reject(e)}};this._appState=1;u=i.promise().then(function(){return t._appState=2,t},function(n){t._appState=4;throw n;});try{if(!!n&&!h.check.isFunc(n))throw new Error(l.ERR_APP_SETUP_INVALID);s.templateLoader.waitForNotLoading(r,null)}catch(f){i.reject(f)}return u},t.prototype.loadTemplates=function(n){return s.templateLoader.loadTemplatesAsync(this,function(){return nt.getAjax(n)})},t.prototype.registerTemplateLoader=function(n,t){var i=d(function(){return t().then(function(n){return{doc:v.getDocFragment(n),required:null}})});f.registerLoader(this,n,i)},t.prototype.registerTemplateById=function(n,t){var i=d(function(){var n=v.queryOne(w,"#"+t);if(!n)throw new Error(a(l.ERR_TEMPLATE_ID_INVALID,t));return et({doc:v.getDocFragment(n.innerHTML),required:null},!0)});f.registerLoader(this,n,i)},t.prototype.getTemplateLoader=function(n){var t=s.templateLoader.getTemplateLoader(this._getInternal(),n);return t||(t=function(){return ot(new Error(a(l.ERR_TEMPLATE_NOTREGISTERED,n)))}),t},t.prototype.registerTemplateGroup=function(n,t){var i={name:n,url:t,loader:function(){return nt.getAjax(i.url)},promise:null,owner:this};f.registerTemplateGroup(this,n,i)},t.prototype.getOptions=function(n){var t=r.getOptions(this,n);if(t||(t=r.getOptions(s,n)),!t)throw new Error(a(l.ERR_OPTIONS_NOTREGISTERED,n));return t},t.prototype.toString=function(){return"Application: "+this.appName},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appName",{get:function(){return this._appName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appRoot",{get:function(){return!this._options||!this._options.appRoot?w:this._options.appRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewFactory",{get:function(){return this._viewFactory},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"UC",{get:function(){return this._UC},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return this},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Application=rt});define("jriapp",["require","exports","jriapp/bootstrapper","jriapp_shared","jriapp_shared/collection/const","jriapp_shared/collection/int","jriapp_shared/utils/jsonbag","jriapp_shared/utils/promise","jriapp/consts","jriapp/utils/dom","jriapp/utils/viewchecks","jriapp/converter","jriapp/bootstrapper","jriapp/binding","jriapp/template","jriapp/utils/lifetime","jriapp/utils/propwatcher","jriapp/mvvm","jriapp/app"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VERSION=t.Application=t.Command=t.BaseCommand=t.ViewModel=t.PropWatcher=t.LifeTimeScope=t.createTemplate=t.Binding=t.selectableProviderWeakMap=t.subscribeWeakMap=t.bootstrapper=t.BaseConverter=t.ViewChecks=t.DOM=t.SubscribeFlags=t.BindTo=t.BINDING_MODE=t.KEYS=t.StatefulPromise=void 0;__exportStar(r,t);__exportStar(u,t);__exportStar(f,t);__exportStar(e,t);Object.defineProperty(t,"StatefulPromise",{enumerable:!0,get:function(){return o.StatefulPromise}});Object.defineProperty(t,"KEYS",{enumerable:!0,get:function(){return s.KEYS}});Object.defineProperty(t,"BINDING_MODE",{enumerable:!0,get:function(){return s.BINDING_MODE}});Object.defineProperty(t,"BindTo",{enumerable:!0,get:function(){return s.BindTo}});Object.defineProperty(t,"SubscribeFlags",{enumerable:!0,get:function(){return s.SubscribeFlags}});Object.defineProperty(t,"DOM",{enumerable:!0,get:function(){return h.DomUtils}});Object.defineProperty(t,"ViewChecks",{enumerable:!0,get:function(){return c.ViewChecks}});Object.defineProperty(t,"BaseConverter",{enumerable:!0,get:function(){return l.BaseConverter}});Object.defineProperty(t,"bootstrapper",{enumerable:!0,get:function(){return a.bootstrapper}});Object.defineProperty(t,"subscribeWeakMap",{enumerable:!0,get:function(){return a.subscribeWeakMap}});Object.defineProperty(t,"selectableProviderWeakMap",{enumerable:!0,get:function(){return a.selectableProviderWeakMap}});Object.defineProperty(t,"Binding",{enumerable:!0,get:function(){return v.Binding}});Object.defineProperty(t,"createTemplate",{enumerable:!0,get:function(){return y.createTemplate}});Object.defineProperty(t,"LifeTimeScope",{enumerable:!0,get:function(){return p.LifeTimeScope}});Object.defineProperty(t,"PropWatcher",{enumerable:!0,get:function(){return w.PropWatcher}});Object.defineProperty(t,"ViewModel",{enumerable:!0,get:function(){return b.ViewModel}});Object.defineProperty(t,"BaseCommand",{enumerable:!0,get:function(){return b.BaseCommand}});Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return b.Command}});Object.defineProperty(t,"Application",{enumerable:!0,get:function(){return k.Application}});t.VERSION="4.0.0";i.Bootstrapper._initFramework()});var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__createBinding=this&&this.__createBinding||(Object.create?function(n,t,i,r){r===undefined&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){r===undefined&&(r=i);n[r]=t[i]}),__exportStar=this&&this.__exportStar||function(n,t){for(var i in n)i==="default"||Object.prototype.hasOwnProperty.call(t,i)||__createBinding(t,n,i)};define("jriapp_db/const",["require","exports"],function(n,t){"use strict";var i,r,u,f;Object.defineProperty(t,"__esModule",{value:!0});t.DATA_OPER=t.DELETE_ACTION=t.REFRESH_MODE=t.FLAGS=void 0,function(n){n[n.None=0]="None";n[n.Changed=1]="Changed";n[n.Setted=2]="Setted";n[n.Refreshed=4]="Refreshed"}(i=t.FLAGS||(t.FLAGS={})),function(n){n[n.NONE=0]="NONE";n[n.RefreshCurrent=1]="RefreshCurrent";n[n.MergeIntoCurrent=2]="MergeIntoCurrent";n[n.CommitChanges=3]="CommitChanges"}(r=t.REFRESH_MODE||(t.REFRESH_MODE={})),function(n){n[n.NoAction=0]="NoAction";n[n.Cascade=1]="Cascade";n[n.SetNulls=2]="SetNulls"}(u=t.DELETE_ACTION||(t.DELETE_ACTION={})),function(n){n[n.None=0]="None";n[n.Submit=1]="Submit";n[n.Query=2]="Query";n[n.Invoke=3]="Invoke";n[n.Refresh=4]="Refresh";n[n.Init=5]="Init"}(f=t.DATA_OPER||(t.DATA_OPER={}))});define("jriapp_db/datacache",["require","exports","jriapp_shared"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataCache=void 0;var u=i.Utils,e=u.check.isNt,f=u.core,o=f.forEach,r=f.Indexer,s=function(n){function t(t){var i=n.call(this)||this;return i._query=t,i._pages=r(),i._itemsByKey=r(),i._totalCount=0,i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this.clear(),n.prototype.dispose.call(this))},t.prototype._getPrevPageIndex=function(n){var t=-1;return o(this._pages,function(i,r){var u=r.pageIndex;u>t&&u<n&&(t=u)}),t},t.prototype.getNextRange=function(n){var f=Math.floor((this.loadPageCount-1)/2),i=n+f+(this.loadPageCount-1)%2,t=n-f,r=this._getPrevPageIndex(n),u,e,o;return t<0&&(i+=0-t,t=0),t<=r&&(i+=r-t+1,t+=r-t+1),this._pageCount>this.loadPageCount&&i>this._pageCount-1&&(t-=i-(this._pageCount-1),t<0&&(t=0),i=this._pageCount-1),t<=r&&(i+=r-t+1,t+=r-t+1),u=i-t+1,u<this.loadPageCount&&(i+=this.loadPageCount-u,u=i-t+1),e=t,o=i,{start:e,end:o,cnt:u}},t.prototype.clear=function(){this._pages=r();this._itemsByKey=r()},t.prototype.getPage=function(n){return this._pages[n]},t.prototype.getPageItems=function(n){var t=this.getPage(n);if(!t)return[];var i=this._query.dbSet,r=this._itemsByKey;return t.keys.map(function(n){var t=r[n];return t?i.createEntityFromObj(t.val,t.key):null}).filter(function(n){return!!n})},t.prototype.setPageItems=function(n,t){var i,f,e,o,r,u;if(this.deletePage(n),t.length!==0)for(i=t.map(function(n){return{key:n._key,val:n._aspect.vals}}),f={keys:i.map(function(n){return n.key}),pageIndex:n},this._pages[n]=f,e=this._itemsByKey,o=i.length,r=0;r<o;r+=1)u=i[r],e[u.key]=u},t.prototype.fill=function(n,t){for(var u,f,r,e,o=t.length,s=this.pageSize,i=0;i<this.loadPageCount;i+=1){if(u=[],f=i*s,f>=o)break;for(r=0;r<s;r+=1)if(e=f+r,e<o)u.push(t[e]);else break;this.setPageItems(n+i,u)}},t.prototype.deletePage=function(n){var r=this.getPage(n),i,t;if(r){for(i=r.keys,t=0;t<i.length;t+=1)delete this._itemsByKey[i[t]];delete this._pages[n]}},t.prototype.hasPage=function(n){return!!this.getPage(n)},t.prototype.getItemByKey=function(n){var t=this._itemsByKey[n];return t?this._query.dbSet.createEntityFromObj(t.val,t.key):null},t.prototype.toString=function(){return"DataCache"},Object.defineProperty(t.prototype,"_pageCount",{get:function(){var t=this.totalCount,i=this.pageSize,n=0;return t===0||i===0?n:(t%i==0?n=t/i:(n=t/i,n=Math.floor(n)+1),n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSize",{get:function(){return this._query.pageSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadPageCount",{get:function(){return this._query.loadPageCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalCount",{get:function(){return this._totalCount},set:function(n){e(n)&&(n=0);n!==this._totalCount&&(this._totalCount=n,this.objEvents.raiseProp("totalCount"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheSize",{get:function(){var n=Object.keys(this._pages);return n.length},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DataCache=s});define("jriapp_db/dataquery",["require","exports","jriapp_shared","jriapp_shared/collection/utils","jriapp_db/datacache"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataQuery=void 0;var f=i.Utils,e=f.check,h=e.isNt,c=e.isArray,l=e.isDate,a=f.str.format,o=f.core.Indexer,v=f.arr,s=r.ValueUtils,y=function(n){function t(t,i){var r=n.call(this)||this,u=r;return r._dbSet=t,r._queryInfo=i,r._filterInfo={filterItems:[]},r._sortInfo={sortItems:[]},r._isIncludeTotalCount=!0,r._isClearPrevData=!0,r._pageSize=t.pageSize,r._pageIndex=t.pageIndex,r._params=o(),r._loadPageCount=1,r._isClearCacheOnEveryLoad=!0,r._isForAppend=!1,r._dataCache=null,r._cacheInvalidated=!1,r._isPagingEnabled=t.isPagingEnabled,r._internal={clearCache:function(){u._clearCache()},getCache:function(){return u._getCache()},isPageCached:function(n){return u._isPageCached(n)},updateCache:function(n,t){u._updateCache(n,t)},getQueryInfo:function(){return u._queryInfo}},r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._clearCache(),n.prototype.dispose.call(this))},t.prototype._addSort=function(n,t){var i=h(t)?0:t,r={fieldName:n,sortOrder:i};this._sortInfo.sortItems.push(r);this._cacheInvalidated=!0},t.prototype._addFilterItem=function(n,t,r,u){var h,f,p;u===void 0&&(u=!0);var o=0,e=[],y=this.serverTimezone;e=c(r)?r:[r];h=v.clone(e);f=null;u&&(f=this.getFieldInfo(n));e=f?h.map(function(n){return s.stringifyValue(n,f.dateConversion,f.dataType,y)}):h.map(function(n){return s.stringifyValue(n,0,l(n)?7:0,y)});switch(t){case 0:case 9:case 2:case 3:case 4:case 5:case 7:case 6:case 8:o=t;break;case 1:if(o=t,r.length!==2)throw new Error(i.LocaleERRS.ERR_QUERY_BETWEEN);break;default:throw new Error(a(i.LocaleERRS.ERR_QUERY_OPERATOR_INVALID,t));}p={fieldName:n,kind:o,values:e};this._filterInfo.filterItems.push(p);this._cacheInvalidated=!0},t.prototype._resetCacheInvalidated=function(){this._cacheInvalidated=!1},t.prototype._clearCache=function(){!this._dataCache||(this._dataCache.dispose(),this._dataCache=null);this._resetCacheInvalidated()},t.prototype._getCache=function(){return this._dataCache||(this._dataCache=new u.DataCache(this)),this._dataCache},t.prototype._isPageCached=function(n){return this._dataCache?this._dataCache.hasPage(n):!1},t.prototype._updateCache=function(n,t){var i=this._dataCache;i&&i.setPageItems(n,t)},t.prototype._getInternal=function(){return this._internal},t.prototype.where=function(n,t,i,r){return r===void 0&&(r=!0),this._addFilterItem(n,t,i,r),this},t.prototype.and=function(n,t,i,r){return r===void 0&&(r=!0),this._addFilterItem(n,t,i,r),this},t.prototype.orderBy=function(n,t){return this._addSort(n,t),this},t.prototype.thenBy=function(n,t){return this._addSort(n,t),this},t.prototype.clearSort=function(){return this._sortInfo.sortItems=[],this._cacheInvalidated=!0,this},t.prototype.clearFilter=function(){return this._filterInfo.filterItems=[],this._cacheInvalidated=!0,this},t.prototype.clearParams=function(){return this._params=o(),this._cacheInvalidated=!0,this},t.prototype.getFieldInfo=function(n){return this._dbSet.getFieldInfo(n)},t.prototype.getFieldNames=function(){return this._dbSet.getFieldNames()},t.prototype.load=function(){return this.dbSet.dbContext.load(this)},t.prototype.toString=function(){return"DataQuery"},Object.defineProperty(t.prototype,"serverTimezone",{get:function(){return this._dbSet.dbContext.serverTimezone},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSet",{get:function(){return this._dbSet},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSetName",{get:function(){return this._dbSet.dbSetName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"queryName",{get:function(){return this._queryInfo.methodName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filterInfo",{get:function(){return this._filterInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortInfo",{get:function(){return this._sortInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isIncludeTotalCount",{get:function(){return this._isIncludeTotalCount&&!this.isForAppend},set:function(n){this._isIncludeTotalCount=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isClearPrevData",{get:function(){return this._isClearPrevData&&!this.isForAppend},set:function(n){this._isClearPrevData=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageSize",{get:function(){return this._pageSize},set:function(n){this._pageSize!==n&&(this._pageSize=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(n){this._pageIndex!==n&&(this._pageIndex=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"params",{get:function(){return this._params},set:function(n){this._params!==n&&(this._params=n,this._cacheInvalidated=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagingEnabled",{get:function(){return this._isPagingEnabled&&!this.isForAppend},set:function(n){this._isPagingEnabled=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"loadPageCount",{get:function(){return this.isForAppend?1:this._loadPageCount},set:function(n){n<1&&(n=1);this._loadPageCount!==n&&(this._loadPageCount=n,(n===1||this.isForAppend)&&this._clearCache(),this.objEvents.raiseProp("loadPageCount"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isClearCacheOnEveryLoad",{get:function(){return this._isClearCacheOnEveryLoad||this.isForAppend},set:function(n){this._isClearCacheOnEveryLoad!==n&&(this._isClearCacheOnEveryLoad=n,this.objEvents.raiseProp("isClearCacheOnEveryLoad"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isForAppend",{get:function(){return this._isForAppend},set:function(n){this._isForAppend!==n&&(this._isForAppend=n,this.objEvents.raiseProp("isForAppend"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCacheValid",{get:function(){return!!this._dataCache&&!this._cacheInvalidated&&!this.isForAppend},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DataQuery=y});define("jriapp_db/dbset",["require","exports","jriapp_shared","jriapp_shared/collection/base","jriapp_shared/collection/utils","jriapp_db/dataquery","jriapp_db/entity_aspect"],function(n,t,i,r,u,f,e){"use strict";function st(n,t){var s,u,e,f,r;if(t.dependentOn)for(s=t.dependentOn.split(","),u=0,e=s;u<e.length;u++){if(f=e[u],r=n.getFieldInfo(f),!r)throw new Error(o(i.LocaleERRS.ERR_CALC_FIELD_DEFINE,f));if(t===r)throw new Error(o(i.LocaleERRS.ERR_CALC_FIELD_SELF_DEPEND,f));r.dependents.indexOf(t.fullName)<0&&r.dependents.push(t.fullName)}}var k,d;Object.defineProperty(t,"__esModule",{value:!0});t.DbSet=void 0;var a=i.Utils,p=a.check,w=p.isArray,h=p.isNt,o=a.str.format,v=a.core,c=v.getValue,y=v.setValue,g=v.merge,l=v.forEach,s=v.Indexer,nt=a.err,tt=u.ValueUtils.parseValue,it=u.ValueUtils.stringifyValue,rt=u.CollUtils.getPKFields,ut=u.CollUtils.walkField,b=u.CollUtils.walkFields,ft=u.CollUtils.objToVals,et=u.CollUtils.initVals,ot=u.CollUtils.getObjectField;(function(n){n.loaded="dbset_loaded"})(k||(k={}));d=function(n){function t(t){var r=n.call(this)||this,u=r,v=t.dbContext,f=t.dbSetInfo,e=f.fieldInfos,o,c,h,l,a;for(r._dbContext=v,r._dbSetName=f.dbSetName,r.options.enablePaging=f.enablePaging,r.options.pageSize=f.pageSize,r._query=null,r._isSubmitOnDelete=!1,r._navfldMap=s(),r._calcfldMap=s(),r._fieldMap=s(),r._fieldInfos=e,r._pkFields=rt(e),r._isPageFilled=!1,r._newKey=0,r._pageDebounce=new i.Debounce(400),r._trackAssoc=s(),r._trackAssocMap=s(),r._childAssocMap=s(),r._parentAssocMap=s(),r._changeCount=0,r._changeCache=s(),r._ignorePageChanged=!1,o=0,c=e;o<c.length;o++)h=c[o],u._fieldMap[h.fieldName]=h,ut(h,function(n,t){n.dependents=[];n.fullName=t});b(e,function(n,i){n.fieldType===3?y(u._navfldMap,i,u._doNavigationField(t,n),!0):n.fieldType===2&&y(u._calcfldMap,i,u._doCalculatedField(t,n),!0)});u._mapAssocFields();l={getCalcFieldVal:function(n,t){return u._getCalcFieldVal(n,t)},getNavFieldVal:function(n,t){return u._getNavFieldVal(n,t)},setNavFieldVal:function(n,t,i){u._setNavFieldVal(n,t,i)},beforeLoad:function(n,t){u._beforeLoad(n,t)},updatePermissions:function(n){u._updatePermissions(n)},getChildToParentNames:function(n){return u._getChildToParentNames(n)},fillFromService:function(n){return u._fillFromService(n)},fillFromCache:function(n){return u._fillFromCache(n)},commitChanges:function(n){u._commitChanges(n)},setItemInvalid:function(n){return u._setItemInvalid(n)},getChanges:function(){return u._getChanges()},getTrackAssocInfo:function(){return u._getTrackAssocInfo()},addToChanged:function(n){u._addToChanged(n)},removeFromChanged:function(n){u._removeFromChanged(n)},onItemStatusChanged:function(n,t){u._onItemStatusChanged(n,t)},setQuery:function(n){u._setQuery(n)}};a=r._getInternal();r._setInternal(g(l,a));r.dbContext.objEvents.onProp("isSubmiting",function(){u.objEvents.raiseProp("isBusy")},r.dbSetName);r.objEvents.onProp("isLoading",function(){u.objEvents.raiseProp("isBusy")});return r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();this._pageDebounce.dispose();this._pageDebounce=null;this.clear();var t=this.dbContext;this._dbContext=null;!t||t.objEvents.offNS(this.dbSetName);this._navfldMap=s();this._calcfldMap=s();n.prototype.dispose.call(this)}},t.prototype.handleError=function(t,i){return this._dbContext?this._dbContext.handleError(t,i):n.prototype.handleError.call(this,t,i)},t.prototype._mapAssocFields=function(){for(var n,o,t,i,f=this._trackAssoc,e=Object.keys(f),r=this._trackAssocMap,s=e.length,u=0;u<s;u+=1)for(n=f[e[u]],o=n.fieldRels.length,t=0;t<o;t+=1)i=n.fieldRels[t],w(r[i.childField])?r[i.childField].push(n.childToParentName):r[i.childField]=[n.childToParentName]},t.prototype._doNavigationField=function(n,t){var u=this,e={getFunc:function(){throw new Error("Navigation get function for the field: "+t.fieldName+" is not implemented");},setFunc:function(){throw new Error("Navigation set function for the field: "+t.fieldName+" is not implemented");}},l=!0,r=n.childAssoc.filter(function(n){return n.childToParentName===t.fieldName}),f,s,h,a,c;if(r.length===0&&(r=n.parentAssoc.filter(function(n){return n.parentToChildrenName===t.fieldName}),l=!1),r.length!==1)throw new Error(o(i.LocaleERRS.ERR_PARAM_INVALID_TYPE,"assocs","Array"));if(f=r[0].name,t.isReadOnly=!0,l){for(t.isReadOnly=!1,u._childAssocMap[r[0].childToParentName]=r[0],s=0,h=r[0].fieldRels;s<h.length;s++)a=h[s],c=u.getFieldInfo(a.childField),t.isReadOnly||!c.isReadOnly||c.allowClientDefault||(t.isReadOnly=!0);e.getFunc=function(n){var t=u.dbContext.getAssociation(f);return t.getParentItem(n)};t.isReadOnly||(u._trackAssoc[f]=r[0],e.setFunc=function(n,r){var s=u.dbContext.getAssociation(f),c,h,e;if(!n)for(c=r._aspect._getFieldVal(t.fieldName),!c||r._aspect._setFieldVal(t.fieldName,null),h=s.childFldInfos.length,e=0;e<h;e+=1)r[s.childFldInfos[e].fieldName]=null;else{if(n._aspect.dbSetName!==s.parentDS.dbSetName)throw new Error(o(i.LocaleERRS.ERR_PARAM_INVALID_TYPE,"value",s.parentDS.dbSetName));if(n._aspect.isNew)r._aspect._setFieldVal(t.fieldName,n._key);else for(h=s.childFldInfos.length,e=0;e<h;e+=1)r[s.childFldInfos[e].fieldName]=n[s.parentFldInfos[e].fieldName]}})}else u._parentAssocMap[r[0].parentToChildrenName]=r[0],e.getFunc=function(n){return u.dbContext.getAssociation(f).getChildItems(n)};return e},t.prototype._doCalculatedField=function(n,t){var i=this,r={getFunc:function(){throw new Error(o("Calculated field:'{0}' is not initialized",t.fieldName));}};return t.isReadOnly=!0,!t.dependentOn||st(i,t),r},t.prototype._refreshValues=function(n,t,r,u,f){var e=this;r.forEach(function(r,s){var c=u[s],h=n+c.n,l=e.getFieldInfo(h);if(!l)throw new Error(o(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,e.dbSetName,h));l.fieldType===5?e._refreshValues(h+".",t,r,c.p,f):t._aspect._refreshValue(r,h,f)})},t.prototype._applyFieldVals=function(n,t,r,u){var f=this,e=f.dbContext.serverTimezone;r.forEach(function(r,s){var l=u[s],h=t+l.n,c=f.getFieldInfo(h),a;if(!c)throw new Error(o(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,f.dbSetName,h));c.fieldType===5?f._applyFieldVals(n,h+".",r,l.p):(a=tt(r,c.dataType,c.dateConversion,e),y(n,h,a,!1))})},t.prototype._getNewKey=function(){var n="clkey_"+this._newKey;return this._newKey+=1,n},t.prototype._onItemAdded=function(t){n.prototype._onItemAdded.call(this,t);this._addToChanged(t)},t.prototype._createNew=function(){return this.createEntityFromData(null,null)},t.prototype._clear=function(t,i){try{n.prototype._clear.call(this,t,i)}finally{this._newKey=0;this._isPageFilled=!1}},t.prototype._onPageChanging=function(){var i=n.prototype._onPageChanging.call(this),t;return i?(this.rejectChanges(),t=this.query,!!t&&t.loadPageCount>1&&this._isPageFilled&&t._getInternal().updateCache(this.pageIndex,this.items),i):i},t.prototype._onPageChanged=function(){var t=this;(this._isPageFilled=!1,this.cancelEdit(),n.prototype._onPageChanged.call(this),this._ignorePageChanged)||(t.query.pageIndex=t.pageIndex,t._pageDebounce.enque(function(){t.dbContext._getInternal().load(t.query,1)}))},t.prototype._onPageSizeChanged=function(){n.prototype._onPageSizeChanged.call(this);!this._query||(this._query.pageSize=this.pageSize)},t.prototype._defineCalculatedField=function(n,t){var r=c(this._calcfldMap,n);if(!r)throw new Error(o(i.LocaleERRS.ERR_PARAM_INVALID,"calculated fieldName",n));r.getFunc=t},t.prototype._getStrValue=function(n,t){var i=t.dateConversion,r=this.dbContext.serverTimezone;return it(n,i,t.dataType,r)},t.prototype._getKeyValue=function(n){var t=this._pkFields,f=t.length,u,r,i,e;if(f===1){if(i=c(n,t[0].fieldName),h(i))throw new Error("Empty key field value for: "+t[0].fieldName);return this._getStrValue(i,t[0])}for(u=[],r=0;r<f;r+=1){if(i=c(n,t[r].fieldName),h(i))throw new Error("Empty key field value for: "+t[r].fieldName);e=this._getStrValue(i,t[r]);u.push(e)}return u.join(";")},t.prototype._getCalcFieldVal=function(n,t){try{var r=c(this._calcfldMap,n);return r.getFunc.call(t,t)}catch(i){nt.reThrow(i,this.handleError(i,this))}},t.prototype._getNavFieldVal=function(n,t){var i=c(this._navfldMap,n);return i.getFunc.call(t,t)},t.prototype._setNavFieldVal=function(n,t,i){var r=c(this._navfldMap,n);r.setFunc.call(t,i,t)},t.prototype._beforeLoad=function(n,t){if(!n.isForAppend){if(t!==n&&(n.pageIndex=0,this._query=n,!t||t.dispose()),n.pageSize!==this.pageSize){this._ignorePageChanged=!0;try{this.pageIndex=0;this.pageSize=n.pageSize}finally{this._ignorePageChanged=!1}}if(n.pageIndex!==this.pageIndex){this._ignorePageChanged=!0;try{this.pageIndex=n.pageIndex}finally{this._ignorePageChanged=!1}}n.isCacheValid||n._getInternal().clearCache()}else n.pageSize=this.pageSize,n.pageIndex=this.pageIndex,this._query=n},t.prototype._getChildToParentNames=function(n){return this._trackAssocMap[n]},t.prototype._afterFill=function(n,t){var i=this;h(n.fetchedItems)||this._onLoaded(n.fetchedItems);this._onCollectionChanged({changeType:t?2:1,reason:n.reason,oper:1,items:n.newItems});this._onFillEnd({items:n.items,newItems:n.newItems,reason:n.reason});this._isPageFilled=!0;!t||i.moveFirst()},t.prototype._fillFromService=function(n){var f=this,r=n.res,b=r.names,k=r.rows||[],d=this.isPagingEnabled,t=n.query,a=!0,e,v,o,s,c,l,y,u,p,w;for(!t||t.getIsStateDirty()||(a=t.isClearPrevData,t.isClearCacheOnEveryLoad&&t._getInternal().clearCache(),a&&this._clear(n.reason,1)),e=k.map(function(n){var r=n.k,t;if(!r)throw new Error(i.LocaleERRS.ERR_KEY_IS_EMPTY);return t=f.getItemByKey(r),t?f._refreshValues("",t,n.v,b,1):t=f.createEntityFromData(n,b),t}),v=e,!t||t.getIsStateDirty()||(t.isIncludeTotalCount&&!h(r.totalCount)&&(this.totalCount=r.totalCount),t.loadPageCount>1&&d&&(o=t._getInternal().getCache(),t.isIncludeTotalCount&&!h(r.totalCount)&&(o.totalCount=r.totalCount),o.fill(r.pageIndex,e),v=o.getPageItems(t.pageIndex))),s=[],c=[],l=0,y=v;l<y.length;l++)u=y[l],p=f.getItemByKey(u._key),p?c.push(p):(f._appendItem(u),s.push(u),c.push(u),u._aspect._setIsAttached(!0));return s.length>0&&this._onCountChanged(),w={newItems:s,fetchedItems:e,items:c,reason:n.reason,outOfBandData:n.res.extraInfo},n.onFillEnd(),this._afterFill(w,a),w},t.prototype._fillFromCache=function(n){var r=n.query,h,f,t,u,e,c,s;if(!r)throw new Error(o(i.LocaleERRS.ERR_ASSERTION_FAILED,"query is not null"));if(r.getIsStateDirty())throw new Error(o(i.LocaleERRS.ERR_ASSERTION_FAILED,"query not destroyed"));for(h=r._getInternal().getCache(),f=h.getPageItems(r.pageIndex),this._replaceItems(n.reason,1,f),t=[],u=0,e=f;u<e.length;u++)c=e[u],t.push(c);return t.length>0&&this._onCountChanged(),s={newItems:t,fetchedItems:null,items:t,reason:n.reason,outOfBandData:null},this._afterFill(s,!0),s},t.prototype._commitChanges=function(n){for(var c,f=this,e=0,s=n;e<s.length;e++){var r=s[e],u=r.clientKey,h=r.serverKey,t=f.getItemByKey(u);if(!t)throw new Error(o(i.LocaleERRS.ERR_KEY_IS_NOTFOUND,u));c=t._aspect.status;t._aspect._acceptChanges(r);c===1&&(t._aspect._updateKeys(r.serverKey),f._remapItem(u,h,t),f._onCollectionChanged({changeType:3,reason:0,oper:4,items:[t],old_key:u,new_key:h}))}},t.prototype._setItemInvalid=function(n){var r=this.getItemByKey(n.clientKey),t=s(),i;return n.invalid.forEach(function(n){n.fieldName||(n.fieldName="*");w(t[n.fieldName])?t[n.fieldName].push(n.message):t[n.fieldName]=[n.message]}),i=[],l(t,function(n,t){i.push({fieldName:n,errors:t})}),this.errors.addErrors(r,i),r},t.prototype._getChanges=function(){var n=[],t=this._changeCache;return l(t,function(t,i){n.push(i._aspect._getRowInfo())}),n},t.prototype._getTrackAssocInfo=function(){var t=this,n=[],i=this._changeCache,r=t._trackAssoc;return l(i,function(t,i){l(r,function(t,r){var u=i._aspect._getFieldVal(r.childToParentName),f=i._key;!u||!f||n.push({assocName:t,parentKey:u,childKey:f})})}),n},t.prototype._addToChanged=function(n){n._aspect.isDetached||this._changeCache[n._key]||(this._changeCache[n._key]=n,this._changeCount+=1,this._changeCount===1&&this.objEvents.raiseProp("isHasChanges"))},t.prototype._removeFromChanged=function(n){n&&(!this._changeCache[n]||(delete this._changeCache[n],this._changeCount-=1,this._changeCount===0&&this.objEvents.raiseProp("isHasChanges")))},t.prototype._setQuery=function(n){this._query=n},t.prototype._onItemStatusChanged=function(t,i){var r=this;n.prototype._onItemStatusChanged.call(this,t,i);t._aspect.isDeleted&&this.isSubmitOnDelete&&this.dbContext.submitChanges().catch(function(){a.queue.enque(function(){r.dbContext.rejectChanges()})})},t.prototype._onRemoved=function(t){this._removeFromChanged(t._key);n.prototype._onRemoved.call(this,t)},t.prototype._onLoaded=function(n){if(this.objEvents.canRaise("dbset_loaded")){var t=n.map(function(n){return n._aspect.vals});this.objEvents.raise("dbset_loaded",{vals:t})}},t.prototype._destroyQuery=function(){var n=this._query;this._query=null;!n||n.dispose()},t.prototype._getNames=function(){var t=this.getFieldInfos(),n=[];return b(t,function(n,t,i){var r,u;return n.fieldType===5?(r=[],i.push({n:n.fieldName,p:r}),r):(u=n.fieldType===0||n.fieldType===4||n.fieldType===6,u&&i.push({n:n.fieldName,p:null}),i)},n),n},t.prototype.getFieldMap=function(){return this._fieldMap},t.prototype.getFieldInfos=function(){return this._fieldInfos},t.prototype.createEntityFromObj=function(n,t){var i=!n,r=ft(this.getFieldInfos(),n),u=i?this._getNewKey():t?t:this._getKeyValue(r),f=new e.EntityAspect(this,r,u,i);return f.item},t.prototype.createEntityFromData=function(n,t){var i=et(this.getFieldInfos(),{}),r=!n,u;return!n||this._applyFieldVals(i,"",n.v,t),u=new e.EntityAspect(this,i,r?this._getNewKey():n.k,r),u.item},t.prototype._getInternal=function(){return n.prototype._getInternal.call(this)},t.prototype.refreshData=function(n){for(var u,f,e,t=0,r=n.rows;t<r.length;t++){if(u=r[t],f=u.k,!f)throw new Error(i.LocaleERRS.ERR_KEY_IS_EMPTY);e=this.getItemByKey(f);!e||this._refreshValues("",e,u.v,n.names,1)}},t.prototype.fillData=function(n,t){var r=this,u,s;this._destroyQuery();u=!t;u&&r._clear(0,1);var f=n.rows.map(function(t){var f=t.k,u;if(!f)throw new Error(i.LocaleERRS.ERR_KEY_IS_EMPTY);return u=r.getItemByKey(f),u?r._refreshValues("",u,t.v,n.names,1):u=r.createEntityFromData(t,n.names),u}),e=[],o=[];return f.forEach(function(n){var t=r.getItemByKey(n._key);t?o.push(t):(r._appendItem(n),e.push(n),o.push(n),n._aspect._setIsAttached(!0))}),e.length>0&&this._onCountChanged(),this.totalCount=f.length,s={newItems:e,fetchedItems:f,items:o,reason:0,outOfBandData:null},this._afterFill(s,u),s},t.prototype.fillItems=function(n,t){var i=this,r,o;this._destroyQuery();r=!t;r&&i._clear(0,1);var u=n.map(function(n){return i.createEntityFromObj(n)}),f=[],e=[];return u.forEach(function(n){var t=i.getItemByKey(n._key);t?e.push(t):(i._appendItem(n),f.push(n),e.push(n),n._aspect._setIsAttached(!0))}),f.length>0&&this._onCountChanged(),this.totalCount=u.length,o={newItems:f,fetchedItems:u,items:e,reason:0,outOfBandData:null},this._afterFill(o,r),o},t.prototype.addOnLoaded=function(n,t,i,r){this.objEvents.on("dbset_loaded",n,t,i,r)},t.prototype.offOnLoaded=function(n){this.objEvents.off("dbset_loaded",n)},t.prototype.waitForNotBusy=function(n,t){this._waitForProp("isBusy",n,t)},t.prototype.getFieldInfo=function(n){var r=n.split("."),t=this._fieldMap[r[0]],u,f,e;if(!t)throw new Error(o(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,n));if(r.length===1)return t;if(t.fieldType===5){for(u=1;u<r.length;u+=1)t=ot(r[u],t.nested);return t}if(t.fieldType===3&&(f=this._childAssocMap[t.fieldName],!!f))return e=this.dbContext.getDbSet(f.parentDbSetName),e.getFieldInfo(r.slice(1).join("."));throw new Error(o(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,n));},t.prototype.sort=function(t,i){var f=this,r=f.query,u;if(h(r))return n.prototype.sort.call(this,t,i);for(r.clearSort(),u=0;u<t.length;u+=1)switch(u){case 0:r.orderBy(t[u],i);break;default:r.thenBy(t[u],i)}return r.isClearPrevData=!0,r.pageIndex=0,f.dbContext._getInternal().load(r,2)},t.prototype.acceptChanges=function(){if(this.isHasChanges){var n=this._changeCache;if(l(n,function(t){var i=n[t];i._aspect.acceptChanges()}),this.isHasChanges)throw new Error("Invalid Operation: the changes are left after the acceptChanges operation");}},t.prototype.rejectChanges=function(){if(this.isHasChanges){var n=this._changeCache;if(l(n,function(t){var i=n[t];i._aspect.rejectChanges()}),this.isHasChanges)throw new Error("Invalid Operation: the changes are left after the rejectChanges operation");}},t.prototype.deleteOnSubmit=function(n){n._aspect.deleteOnSubmit()},t.prototype.clear=function(){this._destroyQuery();n.prototype.clear.call(this)},t.prototype.createQuery=function(n){var t=this.dbContext._getInternal().getQueryInfo(n);if(!t)throw new Error(o(i.LocaleERRS.ERR_QUERY_NAME_NOTFOUND,n));return new f.DataQuery(this,t)},t.prototype.toString=function(){return this.dbSetName},Object.defineProperty(t.prototype,"dbContext",{get:function(){return this._dbContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSetName",{get:function(){return this._dbSetName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"query",{get:function(){return this._query},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHasChanges",{get:function(){return this._changeCount>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cacheSize",{get:function(){var n=this._query,t;return!!n&&n.isCacheValid?(t=n._getInternal().getCache(),t.cacheSize):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubmitOnDelete",{get:function(){return this._isSubmitOnDelete},set:function(n){this._isSubmitOnDelete!==n&&(this._isSubmitOnDelete=!!n,this.objEvents.raiseProp("isSubmitOnDelete"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBusy",{get:function(){return this.isLoading||this.dbContext.isSubmiting},enumerable:!1,configurable:!0}),t}(r.BaseCollection);t.DbSet=d});define("jriapp_db/dbsets",["require","exports","jriapp_shared"],function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});t.DbSets=void 0;var r=i.Utils,e=r.core.Indexer,o=r.str.format,u;(function(n){n.DBSET_CREATING="dbset_creating"})(u||(u={}));f=function(n){function t(t){var i=n.call(this)||this;return i._dbContext=t,i._arrDbSets=[],i._dbSets=e(),i}return __extends(t,n),t.prototype.dispose=function(){var t,i,r;if(!this.getIsDisposed()){for(this.setDisposing(),t=0,i=this._arrDbSets;t<i.length;t++)r=i[t],r.dispose();this._arrDbSets=[];this._dbSets=null;this._dbContext=null;n.prototype.dispose.call(this)}},t.prototype._dbSetCreated=function(n){var t=this;this._arrDbSets.push(n);n.objEvents.onProp("isHasChanges",function(n){t._dbContext._getInternal().onDbSetHasChangesChanged(n)})},t.prototype._createDbSet=function(n,t){var u=this,f=this._dbContext;if(!!u._dbSets[n])throw new Error(r.str.format("DbSet: {0} is already created",n));u._dbSets[n]=new i.Lazy(function(){var r={name:n,dbSetType:t},i;return u.objEvents.raise("dbset_creating",r),i=new r.dbSetType(f),u._dbSetCreated(i),i})},t.prototype.addOnDbSetCreating=function(n,t,i){this.objEvents.on("dbset_creating",n,t,i)},t.prototype.offOnDbSetCreating=function(n){this.objEvents.off("dbset_creating",n)},Object.defineProperty(t.prototype,"dbSetNames",{get:function(){return Object.keys(this._dbSets)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"arrDbSets",{get:function(){return this._arrDbSets},enumerable:!1,configurable:!0}),t.prototype.findDbSet=function(n){var t=this._dbSets[n];return t?t.Value:null},t.prototype.getDbSet=function(n){var t=this.findDbSet(n);if(!t)throw new Error(o(i.LocaleERRS.ERR_DBSET_NAME_INVALID,n));return t},t}(i.BaseObject);t.DbSets=f});define("jriapp_db/association",["require","exports","jriapp_shared"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Association=void 0;var u=i.Utils,e=u.str.format,f=u.core,s=f.getNewID,h=f.extend,r=f.Indexer,o=u.arr,c=function(n){function t(t){var u=n.call(this)||this,e=u,f,o,c;return u._uniqueID=s("ass"),f=h({dbContext:null,parentName:"",childName:"",parentKeyFields:[],childKeyFields:[],parentToChildrenName:null,childToParentName:null,name:u._uniqueID,onDeleteAction:0},t),u._name=f.name,u._dbContext=f.dbContext,u._onDeleteAction=f.onDeleteAction,u._parentDS=f.dbContext.getDbSet(f.parentName),u._childDS=f.dbContext.getDbSet(f.childName),u._parentFldInfos=f.parentKeyFields.map(function(n){return e._parentDS.getFieldInfo(n)}),u._childFldInfos=f.childKeyFields.map(function(n){return e._childDS.getFieldInfo(n)}),u._parentToChildrenName=f.parentToChildrenName,u._childToParentName=f.childToParentName,u._parentMap=r(),u._childMap=r(),u._bindParentDS(),o=u._mapParentItems(u._parentDS.items),u._bindChildDS(),c=u._mapChildren(u._childDS.items),u._saveParentFKey=null,u._saveChildFKey=null,u._debounce=new i.Debounce,u._changed=r(),u._notifyBound=e._notify.bind(e),e._notifyParentChanged(o),e._notifyChildrenChanged(c),u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._debounce.dispose(),this._debounce=null,this._changed=r(),this._unbindParentDS(),this._unbindChildDS(),this._parentMap=null,this._childMap=null,this._parentFldInfos=null,this._childFldInfos=null,n.prototype.dispose.call(this))},t.prototype.handleError=function(t,i){return this._dbContext?this._dbContext.handleError(t,i):n.prototype.handleError.call(this,t,i)},t.prototype._bindParentDS=function(){var n=this,t=this._parentDS;t&&(t.addOnCollChanged(function(t,i){n._onParentCollChanged(i)},n._uniqueID,null,2),t.addOnBeginEdit(function(t,i){n._onParentEdit(i.item,!0,!1)},n._uniqueID,null,2),t.addOnEndEdit(function(t,i){n._onParentEdit(i.item,!1,i.isCanceled)},n._uniqueID,null,2),t.addOnItemDeleting(function(){},n._uniqueID,null,2),t.addOnStatusChanged(function(t,i){n._onParentStatusChanged(i.item,i.oldStatus)},n._uniqueID,null,2),t.addOnCommitChanges(function(t,i){n._onParentCommitChanges(i.item,i.isBegin,i.isRejected,i.status)},n._uniqueID,null,2))},t.prototype._bindChildDS=function(){var n=this,t=this._childDS;t&&(t.addOnCollChanged(function(t,i){n._onChildCollChanged(i)},n._uniqueID,null,2),t.addOnBeginEdit(function(t,i){n._onChildEdit(i.item,!0,!1)},n._uniqueID,null,2),t.addOnEndEdit(function(t,i){n._onChildEdit(i.item,!1,i.isCanceled)},n._uniqueID,null,2),t.addOnStatusChanged(function(t,i){n._onChildStatusChanged(i.item,i.oldStatus)},n._uniqueID,null,2),t.addOnCommitChanges(function(t,i){n._onChildCommitChanges(i.item,i.isBegin,i.isRejected,i.status)},n._uniqueID,null,2))},t.prototype._onParentCollChanged=function(n){var u=this,c=r(),o,t=[],f,s,l,h;switch(n.changeType){case 2:t=u.refreshParentMap();break;case 1:t=u._mapParentItems(n.items);break;case 0:for(f=0,s=n.items;f<s.length;f++)l=s[f],h=u._unMapParentItem(l),!h||(c[h]=null);t=Object.keys(c);break;case 3:!n.old_key||(o=this._parentMap[n.old_key],!o||(delete this._parentMap[n.old_key],t=this._mapParentItems([o])));break;default:throw new Error(e(i.LocaleERRS.ERR_COLLECTION_CHANGETYPE_INVALID,n.changeType));}u._notifyParentChanged(t)},t.prototype._onParentEdit=function(n,t,i){var r=this;t?r._storeParentFKey(n):i?r._saveParentFKey=null:r._checkParentFKey(n)},t.prototype._onParentCommitChanges=function(n,t,i,r){var f=this,u;if(t){if(i&&r===1){u=this._unMapParentItem(n);!u||f._notifyParentChanged([u]);return}if(!i&&r===3){u=this._unMapParentItem(n);!u||f._notifyParentChanged([u]);return}f._storeParentFKey(n)}else f._checkParentFKey(n)},t.prototype._storeParentFKey=function(n){var t=this,i=t.getParentFKey(n);i===null||!t._parentMap[i]||(t._saveParentFKey=i)},t.prototype._checkParentFKey=function(n){var t=this,i=t._saveParentFKey,r;t._saveParentFKey=null;r=t.getParentFKey(n);r!==i&&(!i||(t._notifyChildrenChanged([i]),t._notifyParentChanged([i]),delete t._parentMap[i]),!r||(t._mapParentItems([n]),t._notifyChildrenChanged([r]),t._notifyParentChanged([r])))},t.prototype._onParentStatusChanged=function(n){var i=this,v=n._aspect.status,o=null,s,r,h,u,c,t,f,e,l,a;if(v===3){s=i.getChildItems(n);o=this._unMapParentItem(n);switch(i.onDeleteAction){case 1:for(r=0,h=s;r<h.length;r++)t=h[r],t._aspect.deleteItem();break;case 2:for(u=0,c=s;u<c.length;u++){t=c[u];f=t._aspect.isEditing;f||t._aspect.beginEdit();try{for(e=0,l=i._childFldInfos;e<l.length;e++)a=l[e],t[a.fieldName]=null;f||t._aspect.endEdit()}finally{f||t._aspect.cancelEdit()}}}!o||i._notifyParentChanged([o])}},t.prototype._onChildCollChanged=function(n){var f=this,s=n.items,a=r(),t,u=[],o,h,v,c,l;switch(n.changeType){case 2:u=f.refreshChildMap();break;case 1:u=f._mapChildren(s);break;case 0:for(o=0,h=s;o<h.length;o++)v=h[o],c=f._unMapChildItem(v),!c||(a[c]=null);u=Object.keys(a);break;case 3:!n.old_key||(t=s[0],!t||(l=t._aspect._getFieldVal(this._childToParentName),!l||(delete this._childMap[l],t._aspect._clearFieldVal(this._childToParentName)),u=this._mapChildren([t])));break;default:throw new Error(e(i.LocaleERRS.ERR_COLLECTION_CHANGETYPE_INVALID,n.changeType));}f._notifyChildrenChanged(u)},t.prototype._notifyChildrenChanged=function(n){this._notifyChanged([],n)},t.prototype._notifyParentChanged=function(n){this._notifyChanged(n,[])},t.prototype._notifyChanged=function(n,t){var i=this,u,s,e,h,c,o,l;if(n.length>0||t.length>0){for(u=0,s=n;u<s.length;u++){var r=s[u],f=i._changed[r]||{children:{},parent:null},a=i._childMap[r];if(!!a)for(e=0,h=a;e<h.length;e++)c=h[e],f.children[c._key]=c;i._changed[r]=f}for(o=0,l=t;o<l.length;o++){var r=l[o],f=i._changed[r]||{children:{},parent:null},v=i._parentMap[r];!v||(f.parent=v);i._changed[r]=f}this._debounce.enque(this._notifyBound)}},t.prototype._notify=function(){var n=this,e=n._changed,f,t,i,u;n._changed=r();try{for(f=Object.keys(e),t=0;t<f.length;t+=1)i=f[t],u=e[i],n._onParentChanged(i,u.children),!u.parent||n._onChildrenChanged(i,u.parent)}catch(o){n.handleError(o,n)}},t.prototype._onChildEdit=function(n,t,i){var r=this;t?r._storeChildFKey(n):i?r._saveChildFKey=null:r._checkChildFKey(n)},t.prototype._onChildCommitChanges=function(n,t,i,r){var f=this,u;if(t){if(i&&r===1){u=this._unMapChildItem(n);!u||f._notifyChildrenChanged([u]);return}if(!i&&r===3){u=f._unMapChildItem(n);!u||f._notifyChildrenChanged([u]);return}f._storeChildFKey(n)}else f._checkChildFKey(n)},t.prototype._storeChildFKey=function(n){var t=this,i=t.getChildFKey(n),r;!i||(r=t._childMap[i],!!r&&r.indexOf(n)>-1&&(t._saveChildFKey=i))},t.prototype._checkChildFKey=function(n){var t=this,i=t._saveChildFKey,r=t.getChildFKey(n),u;t._saveChildFKey=null;r!==i&&(!i||(t._notifyParentChanged([i]),t._notifyChildrenChanged([i]),u=t._childMap[i],o.remove(u,n),u.length===0&&delete t._childMap[i]),!r||(t._mapChildren([n]),t._notifyParentChanged([r]),t._notifyChildrenChanged([r])))},t.prototype._onChildStatusChanged=function(n){var i=this,r=n._aspect.status,t=i.getChildFKey(n);t&&r===3&&(t=i._unMapChildItem(n),!t||i._notifyChildrenChanged([t]))},t.prototype._getItemKey=function(n,t,i){for(var e,u,f=[],o=t._getInternal(),s=n.length,r=0;r<s;r+=1){if(e=i[n[r].fieldName],u=o.getStrValue(e,n[r]),u===null)return null;f.push(u)}return f.join(";")},t.prototype._resetChildMap=function(){var n=this,t=Object.keys(this._childMap);this._childMap=r();n._notifyChildrenChanged(t)},t.prototype._resetParentMap=function(){var n=this,t=Object.keys(this._parentMap);this._parentMap=r();n._notifyParentChanged(t)},t.prototype._unMapChildItem=function(n){var t,i,r,u=null;return t=this.getChildFKey(n),!t||(i=this._childMap[t],!i||(r=o.remove(i,n),r>-1&&(i.length===0&&delete this._childMap[t],u=t))),u},t.prototype._unMapParentItem=function(n){var t,i=null;return t=this.getParentFKey(n),!t||!this._parentMap[t]||(delete this._parentMap[t],i=t),i},t.prototype._mapParentItems=function(n){for(var t,e,i,o,f=r(),s=n.length,u=0;u<s;u+=1)(t=n[u],e=t._aspect.status,e!==3)&&(i=this.getParentFKey(t),!i||(o=this._parentMap[i],o!==t&&(this._parentMap[i]=t,f[i]=null)));return Object.keys(f)},t.prototype._onChildrenChanged=function(n,t){!n||!this._parentToChildrenName||t.getIsStateDirty()||t.objEvents.raiseProp(this._parentToChildrenName)},t.prototype._onParentChanged=function(n,t){var e=this,r,f,i,u;if(!!n&&!!this._childToParentName)for(r=Object.keys(t),f=r.length,i=0;i<f;i+=1)u=t[r[i]],u.getIsStateDirty()||u.objEvents.raiseProp(e._childToParentName)},t.prototype._mapChildren=function(n){for(var u,o,t,i,f=r(),s=n.length,e=0;e<s;e+=1)(u=n[e],o=u._aspect.status,o!==3)&&(t=this.getChildFKey(u),!t||(i=this._childMap[t],i||(i=[],this._childMap[t]=i),i.indexOf(u)<0&&(i.push(u),f[t]||(f[t]=null))));return Object.keys(f)},t.prototype._unbindParentDS=function(){var t=this,n=this.parentDS;n&&n.objEvents.offNS(t._uniqueID)},t.prototype._unbindChildDS=function(){var t=this,n=this.childDS;n&&n.objEvents.offNS(t._uniqueID)},t.prototype.refreshParentMap=function(){return this._resetParentMap(),this._mapParentItems(this._parentDS.items)},t.prototype.refreshChildMap=function(){return this._resetChildMap(),this._mapChildren(this._childDS.items)},t.prototype.getParentFKey=function(n){return!!n&&n._aspect.isNew?n._key:this._getItemKey(this._parentFldInfos,this._parentDS,n)},t.prototype.getChildFKey=function(n){if(!!n&&!!this._childToParentName){var t=n._aspect._getFieldVal(this._childToParentName);if(!!t)return t}return this._getItemKey(this._childFldInfos,this._childDS,n)},t.prototype.isParentChild=function(n,t){var i,r;return!n||!t?!1:(i=this.getParentFKey(n),!i)?!1:(r=this.getChildFKey(t),!r)?!1:i===r},t.prototype.getChildItems=function(n){var t=[],i;if(!n)return t;try{i=this.getParentFKey(n);t=this._childMap[i]}catch(r){u.err.reThrow(r,this.handleError(r,this))}return t?t:[]},t.prototype.getParentItem=function(n){var t=null,i;if(!n)return t;try{i=this.getChildFKey(n);t=this._parentMap[i]}catch(r){u.err.reThrow(r,this.handleError(r,this))}return t?t:null},t.prototype.toString=function(){return this._name},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentToChildrenName",{get:function(){return this._parentToChildrenName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childToParentName",{get:function(){return this._childToParentName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentDS",{get:function(){return this._parentDS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childDS",{get:function(){return this._childDS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentFldInfos",{get:function(){return this._parentFldInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childFldInfos",{get:function(){return this._childFldInfos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDeleteAction",{get:function(){return this._onDeleteAction},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Association=c});define("jriapp_db/error",["require","exports","jriapp_shared"],function(n,t,i){"use strict";var u,r,f,e,o,s;Object.defineProperty(t,"__esModule",{value:!0});t.SubmitError=t.SvcValidationError=t.ConcurrencyError=t.AccessDeniedError=t.DataOperationError=void 0;u=i.Utils.str.format;r=function(n){function t(t,r){var f=this,u;return t instanceof Error?u=t.message:t instanceof i.BaseError&&(u=t.message),u||(u=""+t),f=n.call(this,u)||this,f._origError=t,f._operationName=r,f}return __extends(t,n),Object.defineProperty(t.prototype,"operationName",{get:function(){return this._operationName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"origError",{get:function(){return this._origError},enumerable:!1,configurable:!0}),t}(i.BaseError);t.DataOperationError=r;f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(r);t.AccessDeniedError=f;e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(r);t.ConcurrencyError=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(r);t.SvcValidationError=o;s=function(n){function t(t,i,r){var f=this,c=t.message||""+t,o,e,s,h;if(f=n.call(this,t,1)||this,f._origError=t,f._allSubmitted=i||[],f._notValidated=r||[],f._notValidated.length>0){for(o=[c+":"],e=0,s=f._notValidated;e<s.length;e++)h=s[e],o.push(u("item key:{0} errors:{1}",h._key,h._aspect.getErrorString()));c=o.join("\r\n")}return f}return __extends(t,n),Object.defineProperty(t.prototype,"allSubmitted",{get:function(){return this._allSubmitted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notValidated",{get:function(){return this._notValidated},enumerable:!1,configurable:!0}),t}(r);t.SubmitError=s});define("jriapp_db/dbcontext",["require","exports","jriapp_shared","jriapp_shared/collection/utils","jriapp_db/association","jriapp_db/error"],function(n,t,i,r,u,f){"use strict";function p(n,t){if(n&&!o.checkIsDummy(n))switch(n.name){case"AccessDeniedException":throw new f.AccessDeniedError(i.LocaleERRS.ERR_ACCESS_DENIED,t);case"ConcurrencyException":throw new f.ConcurrencyError(i.LocaleERRS.ERR_CONCURRENCY,t);case"ValidationException":throw new f.SvcValidationError(e(i.LocaleERRS.ERR_SVC_VALIDATION,n.message),t);case"DomainServiceException":throw new f.DataOperationError(e(i.LocaleERRS.ERR_SVC_ERROR,n.message),t);default:throw new f.DataOperationError(e(i.LocaleERRS.ERR_UNEXPECTED_SVC_ERROR,n.message),t);}}var tt,it;Object.defineProperty(t,"__esModule",{value:!0});t.DbContext=void 0;var s=i.Utils,c=s.http,v=s.check,y=v.isArray,l=v.isNt,rt=v.isFunc,ut=v.isString,k=s.str,e=k.format,ft=k.endsWith,w=s.core,et=w.getTimeZoneOffset,ot=w.merge,a=w.Indexer,o=s.err,d=r.ValueUtils.stringifyValue,g=s.async,h=g.delay,b=g.createDeferred,nt;(function(n){n.Invoke="invoke";n.Query="query";n.Permissions="permissions";n.Submit="save";n.Refresh="refresh"})(nt||(nt={})),function(n){n.SUBMITTING="submitting";n.SUBMITTED="submitted";n.SUBMIT_ERROR="submit_error";n.DBSET_CREATING="dbset_creating"}(tt||(tt={}));it=function(n){function t(){var t=n.call(this)||this,r=t;t._initState=null;t._requestHeaders=a();t._requests=[];t._dbSets=null;t._svcMethods={};t._assoc={};t._arrAssoc=[];t._queryInfo=a();t._serviceUrl=null;t._isSubmiting=!1;t._isHasChanges=!1;t._pendingSubmit=null;t._serverTimezone=et();t._waitQueue=new i.WaitQueue(t);t._internal={onItemRefreshed:function(n,t){r._onItemRefreshed(n,t)},refreshItem:function(n){return r._refreshItem(n)},getQueryInfo:function(n){return r._getQueryInfo(n)},onDbSetHasChangesChanged:function(n){r._onDbSetHasChangesChanged(n)},load:function(n,t){return r._load(n,t)}};t.objEvents.onProp("isSubmiting",function(){r.objEvents.raiseProp("isBusy")});return t}return __extends(t,n),t.prototype.dispose=function(){var t,i,r;if(!this.getIsDisposed()){for(this.setDisposing(),this.abortRequests(),this._waitQueue.dispose(),this._waitQueue=null,t=0,i=this._arrAssoc;t<i.length;t++)r=i[t],r.dispose();this._arrAssoc=[];this._assoc={};this._dbSets.dispose();this._dbSets=null;this._svcMethods={};this._queryInfo=a();this._serviceUrl=null;this._initState=null;this._isSubmiting=!1;this._isHasChanges=!1;n.prototype.dispose.call(this)}},t.prototype._checkDisposed=function(){this.getIsStateDirty()&&o.abort("dbContext is disposed")},t.prototype._initDbSets=function(){var r=this,n,t;if(this.isInitialized)throw new Error(i.LocaleERRS.ERR_DOMAIN_CONTEXT_INITIALIZED);this._dbSets=this._createDbSets();this._dbSets.addOnDbSetCreating(function(n,t){r.objEvents.raise("dbset_creating",t)});n=this._createAssociations();this._initAssociations(n);t=this._createMethods();this._initMethods(t)},t.prototype._initAssociations=function(n){for(var r,u=this,t=0,i=n;t<i.length;t++)r=i[t],u._initAssociation(r)},t.prototype._initMethods=function(n){for(var t,r=this,i=0,u=n;i<u.length;i++)t=u[i],t.isQuery?r._queryInfo[t.methodName]=t:r._initMethod(t)},t.prototype._updatePermissions=function(n){var t=this;this._serverTimezone=n.serverTimezone;n.permissions.forEach(function(n){var i=t.findDbSet(n.dbSetName);!i||i._getInternal().updatePermissions(n)})},t.prototype._initAssociation=function(n){var t=this,r={dbContext:t,parentName:n.parentDbSetName,childName:n.childDbSetName,onDeleteAction:n.onDeleteAction,parentKeyFields:n.fieldRels.map(function(n){return n.parentField}),childKeyFields:n.fieldRels.map(function(n){return n.childField}),parentToChildrenName:n.parentToChildrenName,childToParentName:n.childToParentName,name:n.name},f="get"+n.name,e=new i.Lazy(function(){var n=new u.Association(r);return t._arrAssoc.push(n),n});this._assoc[f]=function(){return e.Value}},t.prototype._initMethod=function(n){var t=this;this._svcMethods[n.methodName]=function(r){return t._invokeMethod(n,r).then(function(n){if(t._checkDisposed(),!n)throw new Error(e(i.LocaleERRS.ERR_UNEXPECTED_SVC_ERROR,"operation result is empty"));return p(n.error,3),n.result}).catch(function(n){t._onDataOperError(n,3);o.throwDummy(n)})}},t.prototype._addRequestPromise=function(n,t,i){var r=this,u={req:n,operType:t,name:i},f=r._requests.length,e=this.isBusy;r._requests.push(u);n.finally(function(){if(!r.getIsStateDirty()){var n=r.isBusy;s.arr.remove(r._requests,u);r.objEvents.raiseProp("requestCount");n!==r.isBusy&&r.objEvents.raiseProp("isBusy")}});f!==r._requests.length&&r.objEvents.raiseProp("requestCount");e!==r.isBusy&&r.objEvents.raiseProp("isBusy")},t.prototype._tryAbortRequest=function(n,t){var i=this._requests.filter(function(i){return i.name===t&&n.indexOf(i.operType)>-1});i.forEach(function(n){n.req.abort()})},t.prototype._getMethodParams=function(n,t){var p=this,k=n.methodName,w={methodName:k,paramInfo:{parameters:[]}},g=n.parameters,o,h,r,u,f,c,s,v,b;for(t||(t=a()),o=0,h=g;o<h.length;o++){if(r=h[o],u=t[r.name],!r.isNullable&&!r.isArray&&!(r.dataType===1||r.dataType===10)&&l(u))throw new Error(e(i.LocaleERRS.ERR_SVC_METH_PARAM_INVALID,r.name,u,n.methodName));if(rt(u))throw new Error(e(i.LocaleERRS.ERR_SVC_METH_PARAM_INVALID,r.name,u,n.methodName));if(!r.isArray||l(u)||y(u)||(u=[u]),f=null,r.dataType===10&&y(u))f=JSON.stringify(u);else if(y(u)){for(c=[],s=0,v=u;s<v.length;s++)b=v[s],c.push(d(b,r.dateConversion,r.dataType,p.serverTimezone));f=JSON.stringify(c)}else f=d(u,r.dateConversion,r.dataType,p.serverTimezone);w.paramInfo.parameters.push({name:r.name,value:f})}return w},t.prototype._invokeMethod=function(n,t){var r=this,i=this;return h(function(){i._checkDisposed();var r=i._getMethodParams(n,t);return JSON.stringify(r)}).then(function(n){i._checkDisposed();var u=r._getUrl("invoke"),t=c.postAjax(u,n,i.requestHeaders);return i._addRequestPromise(t,3),t}).then(function(n){return JSON.parse(n)})},t.prototype._loadFromCache=function(n,t){var i=this;return h(function(){i._checkDisposed();var r=n.dbSet;return r._getInternal().fillFromCache({reason:t,query:n})})},t.prototype._loadSubsets=function(n,t,i){var o,s,r,f,u,e;if(t===void 0&&(t=!1),i===void 0&&(i=!1),o=this,s=y(n)&&n.length>0,s)for(r=0,f=n;r<f.length;r++)u=f[r],e=o.getDbSet(u.dbSetName),t?e.refreshData(u):e.fillData(u,!i)},t.prototype._onLoaded=function(n,t,r){var u=this;return h(function(){var f,o,s;if(u._checkDisposed(),l(n))throw new Error(e(i.LocaleERRS.ERR_UNEXPECTED_SVC_ERROR,"null result"));if(f=n.dbSetName,o=u.getDbSet(f),l(o))throw new Error(e(i.LocaleERRS.ERR_DBSET_NAME_INVALID,f));return p(n.error,2),s=!!t&&t.isClearPrevData,o._getInternal().fillFromService({res:n,reason:r,query:t,onFillEnd:function(){u._loadSubsets(n.subsets,!1,s)}})})},t.prototype._dataSaved=function(n,t){var r=this,s,h;try{try{p(n.error,1)}catch(u){s=[];h=[];n.dbSets.forEach(function(n){for(var t,u,o=r._dbSets.getDbSet(n.dbSetName),f=0,c=n.rows;f<c.length;f++){if(t=c[f],u=o.getItemByKey(t.clientKey),!u)throw new Error(e(i.LocaleERRS.ERR_KEY_IS_NOTFOUND,t.clientKey));s.push(u);!t.invalid||(o._getInternal().setItemInvalid(t),h.push(u))}});throw new f.SubmitError(u,s,h);}n.dbSets.forEach(function(n){r._dbSets.getDbSet(n.dbSetName)._getInternal().commitChanges(n.rows)})}catch(u){r._onSubmitError(u,t);o.throwDummy(u)}},t.prototype._getChanges=function(){var n={dbSets:[],trackAssocs:[]};return this._dbSets.arrDbSets.forEach(function(t){var i,r,u;(t.endEdit(),i=t._getInternal().getChanges(),i.length!==0)&&(r=t._getInternal().getTrackAssocInfo(),u={dbSetName:t.dbSetName,rows:i},n.dbSets.push(u),n.trackAssocs=n.trackAssocs.concat(r))}),n},t.prototype._getUrl=function(n){var t=this.serviceUrl;return ft(t,"/")||(t=t+"/"),t+[n,""].join("/")},t.prototype._onDataOperError=function(n,t){if(o.checkIsDummy(n))return!0;var i=n instanceof f.DataOperationError?n:new f.DataOperationError(n,t);return this.handleError(i,this)},t.prototype._onSubmitError=function(n,t){if(!o.checkIsDummy(n)){var i={error:n,isHandled:!1,context:t};this.objEvents.raise("submit_error",i);i.isHandled||this._onDataOperError(n,1)}},t.prototype._onSubmitting=function(n){var t={isCancelled:!1,context:n};return this.objEvents.raise("submitting",t),!t.isCancelled},t.prototype._onSubmitted=function(n){this.objEvents.raise("submitted",{context:n})},t.prototype.waitForNotBusy=function(n){this._waitQueue.enQueue({prop:"isBusy",groupName:null,predicate:function(n){return!n},action:n,actionArgs:[]})},t.prototype.waitForNotSubmiting=function(n){this._waitQueue.enQueue({prop:"isSubmiting",predicate:function(n){return!n},action:n,actionArgs:[],groupName:"submit",lastWins:!0})},t.prototype._loadInternal=function(n){var t=this;n.fn_onStart();h(function(){var u,f;t._checkDisposed();var o=n.dbSet.query,s=n.loadPageCount,h=n.isPagingEnabled,r,e=1,i=n.pageIndex;if(n.query.pageIndex=i,n.dbSet._getInternal().beforeLoad(n.query,o),i=n.query.pageIndex,s>1&&h){if(n.query._getInternal().isPageCached(i))return t._loadFromCache(n.query,n.reason);r=n.query._getInternal().getCache().getNextRange(i);i=r.start;e=r.cnt}return u={dbSetName:n.dbSetName,pageIndex:n.query.isPagingEnabled?i:-1,pageSize:n.query.pageSize,pageCount:e,isIncludeTotalCount:n.query.isIncludeTotalCount,filterInfo:n.query.filterInfo,sortInfo:n.query.sortInfo,paramInfo:t._getMethodParams(n.query._getInternal().getQueryInfo(),n.query.params).paramInfo,queryName:n.query.queryName},f=c.postAjax(t._getUrl("query"),JSON.stringify(u),t.requestHeaders),t._addRequestPromise(f,2,u.dbSetName),f.then(function(n){return JSON.parse(n)}).then(function(i){return t._checkDisposed(),t._onLoaded(i,n.query,n.reason)})}).then(function(i){t._checkDisposed();n.fn_onOK(i)}).catch(function(t){n.fn_onErr(t)})},t.prototype._onItemRefreshed=function(n,t){try{if(p(n.error,4),n.rowInfo)t._aspect._refreshValues(n.rowInfo,2);else{t._aspect.dbSet.removeItem(t);t.dispose();throw new Error(i.LocaleERRS.ERR_ITEM_DELETED_BY_ANOTHER_USER);}}catch(r){this._onDataOperError(r,4);o.throwDummy(r)}},t.prototype._loadRefresh=function(n){var t=this;return n.fn_onStart(),h().then(function(){var r,u,i;return t._checkDisposed(),r={dbSetName:n.item._aspect.dbSetName,rowInfo:n.item._aspect._getRowInfo()},n.item._aspect._checkCanRefresh(),u=t._getUrl("refresh"),i=c.postAjax(u,JSON.stringify(r),t.requestHeaders),t._addRequestPromise(i,4),i}).then(function(n){return JSON.parse(n)}).then(function(i){t._checkDisposed();n.fn_onOK(i)}).catch(function(t){n.fn_onErr(t)})},t.prototype._refreshItem=function(n){var i=this,r=b(),t={item:n,dbSet:n._aspect.dbSet,fn_onStart:function(){t.item._aspect._setIsRefreshing(!0);t.dbSet._getInternal().setIsLoading(!0)},fn_onEnd:function(){t.dbSet._getInternal().setIsLoading(!1);t.item._aspect._setIsRefreshing(!1)},fn_onErr:function(n){try{t.fn_onEnd();i._onDataOperError(n,4)}finally{r.reject()}},fn_onOK:function(u){try{i._onItemRefreshed(u,n);t.fn_onEnd()}finally{r.resolve(n)}}};return t.dbSet.waitForNotBusy(function(){try{i._checkDisposed();i._loadRefresh(t)}catch(n){t.fn_onErr(n)}},n._key),r.promise()},t.prototype._getQueryInfo=function(n){return this._queryInfo[n]},t.prototype._onDbSetHasChangesChanged=function(n){var u=this._isHasChanges,i,t,r;if(this._isHasChanges=!1,n.isHasChanges)this._isHasChanges=!0;else for(i=this._dbSets.arrDbSets.length,t=0;t<i;t+=1)if(r=this._dbSets.arrDbSets[t],r.isHasChanges){this._isHasChanges=!0;break}this._isHasChanges!==u&&this.objEvents.raiseProp("isHasChanges")},t.prototype._load=function(n,t){if(!n)throw new Error(i.LocaleERRS.ERR_DB_LOAD_NO_QUERY);var u=this,f=b(),e=null,r={query:n,reason:t,loadPageCount:n.loadPageCount,pageIndex:n.pageIndex,isPagingEnabled:n.isPagingEnabled,dbSetName:n.dbSetName,dbSet:u.getDbSet(n.dbSetName),fn_onStart:function(){r.dbSet._getInternal().setIsLoading(!0);r.query.isForAppend&&(e=r.dbSet.query)},fn_onEnd:function(){r.query.isForAppend&&(r.dbSet._getInternal().setQuery(e),r.query.dispose());r.dbSet._getInternal().setIsLoading(!1)},fn_onOK:function(n){try{r.fn_onEnd()}finally{f.resolve(n)}},fn_onErr:function(n){try{r.fn_onEnd();u._onDataOperError(n,2)}finally{f.reject()}}};return n.isClearPrevData&&u._tryAbortRequest([2,4],r.dbSetName),r.dbSet.waitForNotBusy(function(){try{u._checkDisposed();u._loadInternal(r)}catch(n){r.fn_onErr(n)}},n.isClearPrevData?r.dbSetName:null),f.promise()},t.prototype._submitChanges=function(n,t){var i=this,r="NO_CHANGES";n.fn_onStart();h(function(){i._checkDisposed();var n=i._getChanges();return n.dbSets.length===0&&o.abort(r),n}).then(function(n){var t=c.postAjax(i._getUrl("save"),JSON.stringify(n),i.requestHeaders);return i._addRequestPromise(t,1),t}).then(function(n){return JSON.parse(n)}).then(function(n){i._checkDisposed();i._dataSaved(n,t);!n.subsets||i._loadSubsets(n.subsets,!0)}).then(function(){i._checkDisposed();n.fn_onOk()}).catch(function(t){!i.getIsStateDirty()&&o.checkIsAbort(t)&&t.reason===r?n.fn_onOk():n.fn_onErr(t)})},t.prototype._getInternal=function(){return this._internal},t.prototype.initialize=function(n){var u=this,t,r;if(!!this._initState)return this._initState;if(t=this,r=ot(n,{serviceUrl:null,permissions:null}),!ut(r.serviceUrl))throw new Error(e(i.LocaleERRS.ERR_PARAM_INVALID,"serviceUrl",r.serviceUrl));return this._serviceUrl=r.serviceUrl,this._initDbSets(),this._initState=h(function(){if(!r.permissions){var i=u._getUrl("permissions"),n=c.getAjax(i,t.requestHeaders);return u._addRequestPromise(n,5),n.then(function(n){return JSON.parse(n)})}return r.permissions}).then(function(n){t._checkDisposed();t._updatePermissions(n);t.objEvents.raiseProp("isInitialized")}).catch(function(n){t._onDataOperError(n,5);o.throwDummy(n)}),this._initState},t.prototype.addOnDisposed=function(n,t,i){this.objEvents.addOnDisposed(n,t,i)},t.prototype.offOnDisposed=function(n){this.objEvents.offOnDisposed(n)},t.prototype.addOnError=function(n,t,i){this.objEvents.addOnError(n,t,i)},t.prototype.offOnError=function(n){this.objEvents.offOnError(n)},t.prototype.addOnSubmitting=function(n,t,i){this.objEvents.on("submitting",n,t,i)},t.prototype.offOnSubmitting=function(n){this.objEvents.off("submitting",n)},t.prototype.addOnSubmitted=function(n,t,i){this.objEvents.on("submitted",n,t,i)},t.prototype.offOnSubmitted=function(n){this.objEvents.off("submitted",n)},t.prototype.addOnSubmitError=function(n,t,i){this.objEvents.on("submit_error",n,t,i)},t.prototype.offOnSubmitError=function(n){this.objEvents.off("submit_error",n)},t.prototype.addOnDbSetCreating=function(n,t,i){this.objEvents.on("dbset_creating",n,t,i)},t.prototype.offOnDbSetCreating=function(n){this.objEvents.off("dbset_creating",n)},t.prototype.getDbSet=function(n){return this._dbSets.getDbSet(n)},t.prototype.findDbSet=function(n){return this._dbSets.findDbSet(n)},t.prototype.getAssociation=function(n){var r="get"+n,t=this._assoc[r];if(!t)throw new Error(e(i.LocaleERRS.ERR_ASSOC_NAME_INVALID,n));return t()},t.prototype.submitChanges=function(){var n=this,r,u,t,i;return!this._pendingSubmit?(r=b(),u={promise:r.promise()},this._pendingSubmit=u,t=a(),i={fn_onStart:function(){n._isSubmiting||(n._isSubmiting=!0,n.objEvents.raiseProp("isSubmiting"));n._pendingSubmit=null},fn_onEnd:function(){n._isSubmiting&&(n._isSubmiting=!1,n.objEvents.raiseProp("isSubmiting"))},fn_onErr:function(u){try{i.fn_onEnd();n._onSubmitError(u,t)}finally{r.reject()}},fn_onOk:function(){try{i.fn_onEnd()}finally{r.resolve();n._onSubmitted(t)}}},s.queue.enque(function(){n.waitForNotBusy(function(){try{n._checkDisposed();n._onSubmitting(t)&&n._submitChanges(i,t)}catch(r){i.fn_onErr(r)}})}),u.promise):this._pendingSubmit.promise},t.prototype.load=function(n){return this._load(n,0)},t.prototype.acceptChanges=function(){this._dbSets.arrDbSets.forEach(function(n){n.acceptChanges()})},t.prototype.rejectChanges=function(){this._dbSets.arrDbSets.forEach(function(n){n.rejectChanges()})},t.prototype.abortRequests=function(n,t){var r,i,u;for(l(t)&&(t=0),r=this._requests.filter(function(n){return t===0?!0:n.operType===t}),i=0;i<r.length;i+=1)u=r[i],u.req.abort(n)},Object.defineProperty(t.prototype,"associations",{get:function(){return this._assoc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceMethods",{get:function(){return this._svcMethods},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSets",{get:function(){return this._dbSets},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serviceUrl",{get:function(){return this._serviceUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInitialized",{get:function(){return!!this._initState&&this._initState.state()===2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBusy",{get:function(){return this.requestCount>0||this.isSubmiting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubmiting",{get:function(){return this._isSubmiting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverTimezone",{get:function(){return this._serverTimezone},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHasChanges",{get:function(){return this._isHasChanges},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requestCount",{get:function(){return this._requests.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requestHeaders",{get:function(){return this._requestHeaders},set:function(n){this._requestHeaders=n},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DbContext=it});define("jriapp_db/entity_aspect",["require","exports","jriapp_shared","jriapp_shared/errors","jriapp_shared/collection/utils","jriapp_shared/collection/aspect","jriapp_db/error"],function(n,t,i,r,u,f,e){"use strict";function g(n){switch(n.fieldType){case 1:case 3:case 2:return!0;default:return!1}}function v(n,t,i){var f,u,r;if(!!t.nested&&t.nested.length>0)for(f=t.nested.length,u=0;u<f;u+=1)r=t.nested[u],!!r.nested&&r.nested.length>0?v(n+"."+r.fieldName,r,i):i(n+"."+r.fieldName,r);else i(n,t)}function y(n,t){v(n.fieldName,n,t)}var p;Object.defineProperty(t,"__esModule",{value:!0});t.EntityAspect=void 0;var o=i.Utils,a=o.check._undefined,s=o.str.format,c=o.core,w=c.getValue,b=c.setValue,k=c.uuid,h=u.ValueUtils.compareVals,d=u.ValueUtils.parseValue,l=o.sys;p=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f._srvKey=u?null:r,f._origVals=null,f._disposables=null,f._savedStatus=null,f}return __extends(t,n),t.prototype.dispose=function(){var t,r,i;if(!this.getIsDisposed()){this.setDisposing();try{if(this.isDetached||(this.cancelEdit(),this.rejectChanges()),t=this._disposables,this._disposables=null,!!t&&t.length>0)for(r=t.length-1,i=r;i>=0;--i)t[i].dispose()}finally{n.prototype.dispose.call(this)}}},t.prototype._getValue=function(t,i){switch(i){case 2:if(!this._origVals)throw new Error("Invalid Operation, no Stored Version: "+i);return w(this._origVals,t);default:return n.prototype._getValue.call(this,t,i)}},t.prototype._setValue=function(t,i,r){switch(r){case 2:if(!this._origVals)throw new Error("Invalid Operation, no Stored Version: "+r);b(this._origVals,t,i,!1);break;default:n.prototype._setValue.call(this,t,i,r)}},t.prototype._storeVals=function(t){switch(t){case 2:this._origVals=this._cloneVals();break;default:n.prototype._storeVals.call(this,t)}},t.prototype._restoreVals=function(t){switch(t){case 2:if(!this._origVals)throw new Error("Invalid Operation, no Stored Version: "+t);this._setVals(this._origVals);this._origVals=null;break;default:n.prototype._restoreVals.call(this,t)}},t.prototype._onFieldChanged=function(n,t){var i,r;l.raiseProp(this.item,n);i=t||this.coll.getFieldInfo(n);!i.dependents||(r=this.item,o.async.getTaskQueue().enque(function(){var n,t,u;if(!r.getIsStateDirty())for(n=0,t=i.dependents;n<t.length;n++)u=t[n],l.raiseProp(r,u)}))},t.prototype._getValueChange=function(n,t,i){var u=this,h=u.dbSet,r=null,c,f,o;if(g(t))return r;switch(t.fieldType){case 6:r={fieldName:t.fieldName,val:null,orig:null,flags:0,nested:null};break;case 5:for(r={fieldName:t.fieldName,val:null,orig:null,flags:0,nested:[]},c=t.nested.length,f=0;f<c;f+=1)o=u._getValueChange(n+"."+t.nested[f].fieldName,t.nested[f],i),!o||r.nested.push(o);break;default:var e=h._getInternal().getStrValue(u._getValue(n,0),t),s=u.hasOrigVals?h._getInternal().getStrValue(u._getValue(n,2),t):e,l=s!==e;r=l?{fieldName:t.fieldName,val:e,orig:s,flags:3,nested:null}:t.isPrimaryKey>0||t.fieldType===4||t.isNeedOriginal?{fieldName:t.fieldName,val:e,orig:s,flags:2,nested:null}:{fieldName:t.fieldName,val:null,orig:null,flags:0,nested:null}}return i?t.fieldType===5?r.nested.length>0?r:null:(r.flags&1)==1?r:null:r},t.prototype._getValueChanges=function(n){var t=this,i=this.dbSet.getFieldInfos(),r=i.map(function(i){return t._getValueChange(i.fieldName,i,n)});return r.filter(function(n){return!!n})},t.prototype._fldChanging=function(){return this._origVals||this._storeVals(2),!0},t.prototype._skipValidate=function(n,t){var r=this.dbSet._getInternal().getChildToParentNames(n.fieldName),u=!1,f,i;if(!!r&&t===null)for(f=r.length,i=0;i<f;i+=1)if(u=!!this._getFieldVal(r[i]),u)break;return u},t.prototype._beginEdit=function(){return n.prototype._beginEdit.call(this)?(this._savedStatus=this.status,!0):!1},t.prototype._endEdit=function(){return n.prototype._endEdit.call(this)?(this._savedStatus=null,!0):!1},t.prototype._cancelEdit=function(){var n,r,t,u;if(!this.isEditing)return!1;var f=this,o=this._getValueChanges(!0),e=this.dbSet;for(this._restoreVals(1),e.errors.removeAllErrors(this.item),this._setStatus(this._savedStatus),this._savedStatus=null,n=0,r=o;n<r.length;n++){if(t=r[n],u=e.getFieldInfo(t.fieldName),!u)throw new Error(s(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,f.dbSetName,t.fieldName));f._onFieldChanged(t.fieldName,u)}return!0},t.prototype._setStatus=function(t){var r=this.status,i;if(r!==t){i=this.dbSet._getInternal();n.prototype._setStatus.call(this,t);t!==0?i.addToChanged(this.item):i.removeFromChanged(this.key);i.onItemStatusChanged(this.item,r)}},t.prototype._addDisposable=function(n){this._disposables||(this._disposables=[]);this._disposables.push(n)},t.prototype._updateKeys=function(n){this._setSrvKey(n);this._setKey(n)},t.prototype._checkCanRefresh=function(){if(this.key===null||this.status===1)throw new Error(i.LocaleERRS.ERR_OPER_REFRESH_INVALID);},t.prototype._refreshValue=function(n,t,r){var u=this,e=u.dbSet.getFieldInfo(t),l;if(!e)throw new Error(s(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,u.dbSetName,t));var v=u.serverTimezone,o=e.dataType,y=e.dateConversion,f=d(n,o,y,v),c=u._getValue(t,0);switch(r){case 3:h(f,c,o)||(u._setValue(t,f,0),u._onFieldChanged(t,e));break;case 1:u.hasOrigVals&&u._setValue(t,f,2);u.hasTempVals&&u._setValue(t,f,1);h(f,c,o)||(u._setValue(t,f,0),u._onFieldChanged(t,e));break;case 2:l=a;u.hasOrigVals&&(l=u._getValue(t,2),u._setValue(t,f,2));(l===a||h(l,c,o))&&(h(f,c,o)||(u._setValue(t,f,0),u._onFieldChanged(t,e)));break;default:throw new Error(s(i.LocaleERRS.ERR_PARAM_INVALID,"refreshMode",r));}},t.prototype._refreshValues=function(n,t){var e=this,o=this.status,i,r,u,f;if(!this.getIsDisposed()){for(t||(t=1),i=0,r=n.values;i<r.length;i++)u=r[i],y(u,function(n,i){i.flags&4&&e._refreshValue(i.val,n,t)});o===2&&(f=this._getValueChanges(!0),f.length===0&&(this._origVals=null,this._setStatus(0)))}},t.prototype._getRowInfo=function(){return{values:this._getValueChanges(!1),changeType:this.status,serverKey:this.srvKey,clientKey:this.key,error:null}},t.prototype._getCalcFieldVal=function(n){return this.dbSet._getInternal().getCalcFieldVal(n,this.item)},t.prototype._getNavFieldVal=function(n){return this.dbSet._getInternal().getNavFieldVal(n,this.item)},t.prototype._setNavFieldVal=function(n,t){this.dbSet._getInternal().setNavFieldVal(n,this.item,t)},t.prototype._clearFieldVal=function(n){this._setValue(n,null,0)},t.prototype._getFieldVal=function(n){return this._getValue(n,0)},t.prototype._setFieldVal=function(n,t){var o,e;if(this.isCancelling)return!1;var y=this.dbSetName,c=this.dbSet,a=this._getFieldVal(n),u=this.getFieldInfo(n),f=t,v=!1;if(!u)throw new Error(s(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,y,n));this.isEditing||this.isUpdating||this.beginEdit();try{if(u.dataType===1&&u.isNullable&&!f&&(f=null),a!==f){if(u.isReadOnly&&!(this.isNew&&u.allowClientDefault))throw new Error(i.LocaleERRS.ERR_FIELD_READONLY);if(this._fldChanging(n,u,a,f)){if(this._setValue(n,f,0),!(u.fieldType===1||u.fieldType===6))switch(this.status){case 0:this._setStatus(2)}this._onFieldChanged(n,u);v=!0}if(c.errors.removeError(this.item,n),o=this._validateField(n),!!o)throw new r.ValidationError([o],this);}}catch(h){e=void 0;e=l.isValidationError(h)?h:new r.ValidationError([{fieldName:n,errors:[h.message]}],this);c.errors.addError(this.item,n,e.validations[0].errors);throw e;}return v},t.prototype._setSrvKey=function(n){this._srvKey=n},t.prototype._acceptChanges=function(n){if(!this.getIsDisposed()){var t=this.status,r=this.dbSet,i=r._getInternal(),u=r.errors;if(t!==0){i.onCommitChanges(this.item,!0,!1,t);if(t===3)i.removeFromChanged(this.key),u.removeAllErrors(this.item),this.getIsStateDirty()||this.dispose();else{this._origVals=null;this.hasTempVals&&this._storeVals(1);this._setStatus(0);u.removeAllErrors(this.item);!n||this._refreshValues(n,3);i.onCommitChanges(this.item,!1,!1,t)}}}},t.prototype.deleteItem=function(){return this.deleteOnSubmit()},t.prototype.deleteOnSubmit=function(){if(this.getIsStateDirty())return!1;var i=this.status,n=this.dbSet,t={item:this.item,isCancel:!1};n._getInternal().onItemDeleting(t);return t.isCancel?!1:(i===1?n.removeItem(this.item):this._setStatus(3),!0)},t.prototype.acceptChanges=function(){this._acceptChanges(null)},t.prototype.rejectChanges=function(){var o,i,f,s;if(!this.getIsDisposed()){var n=this,t=n.status,r=n.dbSet,u=r._getInternal(),e=r.errors;if(t!==0){u.onCommitChanges(n.item,!0,!0,t);if(t===1)u.removeFromChanged(this.key),e.removeAllErrors(this.item),this.getIsStateDirty()||this.dispose();else{for(o=n._getValueChanges(!0),n.hasOrigVals&&(n._restoreVals(2),n.hasTempVals&&n._storeVals(1)),n._setStatus(0),e.removeAllErrors(this.item),i=0,f=o;i<f.length;i++)s=f[i],y(s,function(t){n._onFieldChanged(t,r.getFieldInfo(t))});u.onCommitChanges(this.item,!1,!0,t)}}}},t.prototype.submitChanges=function(){var i=function(){n.offOnSubmitError(r)},n=this.dbSet.dbContext,r=k(),t;return n.addOnSubmitError(function(n,t){if(t.error instanceof e.SubmitError){var i=t.error;i.notValidated.length>0&&(t.isHandled=!0)}},r),t=n.submitChanges(),t.then(i,i),t},t.prototype.refresh=function(){var n=this.dbSet.dbContext;return n._getInternal().refreshItem(this.item)},t.prototype.toString=function(){return this.dbSetName+"EntityAspect"},Object.defineProperty(t.prototype,"hasOrigVals",{get:function(){return!!this._origVals},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"srvKey",{get:function(){return this._srvKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanSubmit",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSetName",{get:function(){return this.dbSet.dbSetName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverTimezone",{get:function(){return this.dbSet.dbContext.serverTimezone},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dbSet",{get:function(){return this.coll},enumerable:!1,configurable:!0}),t}(f.ItemAspect);t.EntityAspect=p});define("jriapp_db/int",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("jriapp_db/dataview",["require","exports","jriapp_shared","jriapp_shared/collection/base"],function(n,t,i,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});t.DataView=void 0;var u=i.Utils,s=u.check.isFunc,h=u.str.format,c=u.core.extend,f=u.err,l=u.sys,e;(function(n){n.refreshed="view_refreshed"})(e||(e={}));o=function(n){function t(t){var r=n.call(this)||this;if(!l.isCollection(t.dataSource))throw new Error(i.LocaleERRS.ERR_DATAVIEW_DATASRC_INVALID);if(!!t.fn_filter&&!s(t.fn_filter))throw new Error(i.LocaleERRS.ERR_DATAVIEW_FILTER_INVALID);return r._refreshDebounce=new i.Debounce(t.refreshTimeout||0),r._dataSource=t.dataSource,r._fn_filter=t.fn_filter||null,r._fn_sort=t.fn_sort||null,r._fn_itemsProvider=t.fn_itemsProvider||null,r._fn_sortHandler=t.fn_sortHandler||null,r._isAddingNew=!1,r._bindDS(),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._refreshDebounce.dispose(),this._unbindDS(),this._dataSource=null,this._fn_filter=null,this._fn_sort=null,this._fn_sortHandler=null,n.prototype.dispose.call(this))},t.prototype._isOwnsItems=function(){return!1},t.prototype._onAddNew=function(n){var t={changeType:1,reason:0,oper:2,items:[n],new_key:n._key};this._onCollectionChanged(t)},t.prototype._filterForPaging=function(n){var i=n.length,u=this.pageSize*this.pageIndex,r=this.pageSize,t=u,f=i>t+r?t+r:i;return t>=i?[]:n.slice(t,f)},t.prototype._onViewRefreshed=function(n){this.objEvents.raise("view_refreshed",n)},t.prototype._refresh=function(n){var t=this;this._refreshDebounce.enque(function(){t._refreshSync(n)})},t.prototype._refreshSync=function(n){if(!this.getIsStateDirty())try{var t=void 0,i=this._dataSource;if(!i||i.getIsStateDirty()){this.clear();this._onViewRefreshed({});return}t=this._fn_itemsProvider?this._fn_itemsProvider(i):i.items;!this._fn_filter||(t=t.filter(this._fn_filter));!this._fn_sort||(t=t.sort(this._fn_sort));this._fillItems({items:t,reason:n,clear:!0,isAppend:!1});this._onViewRefreshed({})}catch(r){f.reThrow(r,this.handleError(r,this))}},t.prototype._fillItems=function(n){var h,r,e,i,o;n=c({items:[],reason:3,clear:!0,isAppend:!1},n);var s=this,t=[],u=[],f=!!n.clear;for(!f||this._clear(n.reason,1),h=this.isPagingEnabled&&!n.isAppend?this._filterForPaging(n.items):n.items,r=0,e=h;r<e.length;r++)i=e[r],o=s.getItemByKey(i._key),o?u.push(o):(s._appendItem(i),t.push(i),u.push(i));return t.length>0&&this._onCountChanged(),this.totalCount=f?n.items.length:this.totalCount+t.length,this._onCollectionChanged({changeType:2,reason:n.reason,oper:1,items:t}),this._onFillEnd({items:u,newItems:t,reason:n.reason}),f&&this.moveFirst(),t},t.prototype._onDSCollectionChanged=function(n,t){var r=this,e,f,o,s,u;switch(t.changeType){case 2:this._refresh(3);break;case 1:this._isAddingNew||(e=r._fn_filter?t.items.filter(r._fn_filter):t.items,e.length>0&&r.appendItems(e));break;case 0:for(f=0,o=t.items;f<o.length;f++)u=o[f],s=r.getItemByKey(u._key),!s||r.removeItem(s);break;case 3:u=r.getItemByKey(t.old_key);!u||(r._remapItem(t.old_key,t.new_key,u),r._onCollectionChanged(t));break;default:throw new Error(h(i.LocaleERRS.ERR_COLLECTION_CHANGETYPE_INVALID,t.changeType));}},t.prototype._onDSStatusChanged=function(n,t){var i=this,r=t.item,e=t.key,o=t.oldStatus,f=!!i._fn_filter,u;i.getItemByKey(e)?(i._onItemStatusChanged(r,o),f&&(u=i._fn_filter(r),u||i.removeItem(r))):f&&(u=i._fn_filter(r),u&&i.appendItems([r]))},t.prototype._bindDS=function(){var n=this,t=this._dataSource;t&&(t.addOnCollChanged(n._onDSCollectionChanged,n.uniqueID,n,1),t.addOnBeginEdit(function(t,i){!n.getItemByKey(i.item._key)||n._onEditing(i.item,!0,!1)},n.uniqueID,null,1),t.addOnEndEdit(function(t,i){var u,r=i.item,f=!!n._fn_filter;n.getItemByKey(r._key)?(n._onEditing(r,!1,i.isCanceled),!i.isCanceled&&f&&(u=n._fn_filter(r),u||n.removeItem(r))):!i.isCanceled&&f&&(u=n._fn_filter(r),u&&n.appendItems([r]))},n.uniqueID,null,1),t.addOnErrorsChanged(function(t,i){if(!!n.getItemByKey(i.item._key))n._getInternal().onErrorsChanged(i)},n.uniqueID,null,1),t.addOnStatusChanged(n._onDSStatusChanged,n.uniqueID,n,1),t.addOnItemDeleting(function(t,i){!n.getItemByKey(i.item._key)||n._onItemDeleting(i)},n.uniqueID,null,1),t.addOnItemAdded(function(t,i){n._isAddingNew&&(n.getItemByKey(i.item._key)||n._addNew(i.item),n.currentItem=i.item,n._onEditing(i.item,!0,!1),n._onItemAdded(i.item))},n.uniqueID,null,1),t.addOnItemAdding(function(t,i){n._isAddingNew&&n._onItemAdding(i.item)},n.uniqueID,null,1))},t.prototype._unbindDS=function(){var t=this,n=this._dataSource;n&&n.objEvents.offNS(t.uniqueID)},t.prototype._checkCurrentChanging=function(n){var t=this._dataSource,i;try{i=t._getInternal().getEditingItem();!i||n===i||t.endEdit()}catch(r){t.cancelEdit();f.reThrow(r,this.handleError(r,this))}},t.prototype._onPageChanged=function(){this._refresh(1)},t.prototype._clear=function(t,i){i===void 0&&(i=0);n.prototype._clear.call(this,t,i);t!==1&&(this.pageIndex=0);t!==1&&t!==2&&(this.totalCount=0)},t.prototype.itemFactory=function(){throw new Error("Not implemented");},t.prototype._createNew=function(){throw new Error("Not implemented");},t.prototype._getStrValue=function(n,t){return this._dataSource._getInternal().getStrValue(n,t)},t.prototype.getFieldNames=function(){return this._dataSource.getFieldNames()},t.prototype.getFieldInfo=function(n){return this._dataSource.getFieldInfo(n)},t.prototype.getFieldInfos=function(){return this._dataSource.getFieldInfos()},t.prototype.getFieldMap=function(){return this._dataSource.getFieldMap()},t.prototype.addOnViewRefreshed=function(n,t){this.objEvents.on("view_refreshed",n,t)},t.prototype.offOnViewRefreshed=function(n){this.objEvents.off("view_refreshed",n)},t.prototype.appendItems=function(n){return this.getIsStateDirty()?[]:this._fillItems({items:n,reason:0,clear:!1,isAppend:!0})},t.prototype.addNew=function(){var n=null;this._isAddingNew=!0;try{n=this._dataSource.addNew()}finally{this._isAddingNew=!1}return n},t.prototype.removeItem=function(n){var t=this._removeItem(n);t<0||(this.errors.removeAllErrors(n),this.totalCount=this.totalCount-1,this._resetCurrent(t))},t.prototype.sort=function(n,t){return this._fn_sortHandler?this._fn_sortHandler(n,t):this.sortLocal(n,t)},t.prototype.sortLocal=function(n,t){var i=this;return this._fn_sort=this._getSortFn(n,t),u.async.delay(function(){return i._refreshSync(2)})},t.prototype.clear=function(){this._clear(3,0)},t.prototype.refresh=function(){this._refresh(3)},t.prototype.syncRefresh=function(){this._refreshSync(3)},Object.defineProperty(t.prototype,"errors",{get:function(){return this._dataSource.errors},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPagingEnabled",{get:function(){return this.options.enablePaging},set:function(n){this.options.enablePaging!==n&&(this.options.enablePaging=n,this.objEvents.raiseProp("isPagingEnabled"),this._refresh(0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"permissions",{get:function(){return this._dataSource.permissions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fn_filter",{get:function(){return this._fn_filter},set:function(n){this._fn_filter!==n&&(this._fn_filter=n,this._refresh(0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fn_sort",{get:function(){return this._fn_sort},set:function(n){this._fn_sort!==n&&(this._fn_sort=n,this._refresh(2))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fn_itemsProvider",{get:function(){return this._fn_itemsProvider},set:function(n){this._fn_itemsProvider!==n&&(this._fn_itemsProvider=n,this._refresh(3))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fn_sortHandler",{get:function(){return this._fn_sortHandler},set:function(n){this._fn_sortHandler!==n&&(this._fn_sortHandler=n,this._refresh(3))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.dataSource?"DataView For "+this.dataSource.toString():"DataView"},t}(r.BaseCollection);t.DataView=o});define("jriapp_db/child_dataview",["require","exports","jriapp_shared","jriapp_db/dataview"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ChildDataView=void 0;var u=i.Utils,f=u.core,e=function(n){function t(t){var e=this,r=t.parentItem?t.parentItem:null,s=t.association,o=f.extend({dataSource:null,fn_itemsProvider:null,fn_filter:null},t),h=o.fn_filter,i,c;return o.dataSource=s.childDS,o.fn_itemsProvider=function(){return r?s.getChildItems(r):[]},o.fn_filter=function(n){var t=s.isParentChild(r,n);return t&&(h?h(n):!0)},o.refreshTimeout=350,e=n.call(this,o)||this,i=e,e._getParent=function(){return i.getIsStateDirty()?null:r},e._setParent=function(n){i.getIsStateDirty()||r!==n&&(r=n,i.items.length>0&&(i.clear(),i._onViewRefreshed({})),i._refresh(3),i.objEvents.raiseProp("parentItem"))},e._association=s,!r||t.explicitRefresh||(c=u.async.getTaskQueue(),c.enque(function(){i._refreshSync(0)})),e}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._setParent(null),this._association=null,n.prototype.dispose.call(this))},t.prototype.toString=function(){return this._association?"ChildDataView for "+this._association.toString():"ChildDataView"},Object.defineProperty(t.prototype,"parentItem",{get:function(){return this._getParent()},set:function(n){this._setParent(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"association",{get:function(){return this._association},enumerable:!1,configurable:!0}),t}(r.DataView);t.ChildDataView=e});define("jriapp_db/complexprop",["require","exports","jriapp_shared"],function(n,t,i){"use strict";var u,e;Object.defineProperty(t,"__esModule",{value:!0});t.ChildComplexProperty=t.RootComplexProperty=t.BaseComplexProperty=void 0;var o=i.Utils,f=o.str.format,r=function(n){function t(t){var i=n.call(this)||this;return i._name=t,i}return __extends(t,n),t.prototype.getName=function(){return this._name},t.prototype.getPropertyByName=function(n){var t=this.getProperties().filter(function(t){return t.fieldName===n});if(!t||t.length!==1)throw new Error(f(i.LocaleERRS.ERR_ASSERTION_FAILED,"arrProps.length === 1"));return t[0]},t.prototype.getIsHasErrors=function(){return this.getEntity().getIsHasErrors()},t.prototype.addOnErrorsChanged=function(n,t,i){var r=this;this.getEntity().addOnErrorsChanged(function(t,i){n.apply(this,[r,i])},t,i)},t.prototype.offOnErrorsChanged=function(n){this.getEntity().offOnErrorsChanged(n)},t.prototype.getFieldErrors=function(n){var t=this.getFullPath(n);return this.getEntity().getFieldErrors(t)},t.prototype.getAllErrors=function(){return this.getEntity().getAllErrors()},t.prototype.getIErrorNotification=function(){return this},t}(i.BaseObject);t.BaseComplexProperty=r;u=function(n){function t(t,i){var r=n.call(this,t)||this;return r._entity=i,r._entity._addDisposable(r),r}return __extends(t,n),t.prototype._addDisposable=function(n){this._entity._addDisposable(n)},t.prototype._getFullPath=function(n){return this.getName()+"."+n},t.prototype.setValue=function(n,t){this._entity._setFieldVal(n,t)},t.prototype.getValue=function(n){return this._entity._getFieldVal(n)},t.prototype.getFieldInfo=function(){return this._entity.getFieldInfo(this.getName())},t.prototype.getProperties=function(){return this.getFieldInfo().nested},t.prototype.getEntity=function(){return this._entity},t.prototype.getFullPath=function(n){return this.getName()+"."+n},t}(r);t.RootComplexProperty=u;e=function(n){function t(t,i){var r=n.call(this,t)||this;return r._parent=i,r._parent._addDisposable(r),r}return __extends(t,n),t.prototype._addDisposable=function(n){this._parent._addDisposable(n)},t.prototype._getFullPath=function(n){return this._parent._getFullPath(this.getName()+"."+n)},t.prototype.setValue=function(n,t){this.getEntity()._setFieldVal(n,t)},t.prototype.getValue=function(n){return this.getEntity()._getFieldVal(n)},t.prototype.getFieldInfo=function(){var n=this.getName();return this._parent.getPropertyByName(n)},t.prototype.getProperties=function(){return this.getFieldInfo().nested},t.prototype.getParent=function(){return this._parent},t.prototype.getRootProperty=function(){for(var n=this._parent;!!n&&n instanceof t;)n=n.getParent();if(!n||!(n instanceof u))throw new Error(f(i.LocaleERRS.ERR_ASSERTION_FAILED,"parent instanceof RootComplexProperty"));return n},t.prototype.getFullPath=function(n){return this._parent._getFullPath(this.getName()+"."+n)},t.prototype.getEntity=function(){return this.getRootProperty().getEntity()},t}(r);t.ChildComplexProperty=e});define("jriapp_db",["require","exports","jriapp_db/dbset","jriapp_db/dataview","jriapp_db/child_dataview","jriapp_db/association","jriapp_db/const","jriapp_db/dbcontext","jriapp_db/dbsets","jriapp_db/dataquery","jriapp_db/entity_aspect","jriapp_db/error","jriapp_db/complexprop"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VERSION=t.FLAGS=t.DATA_OPER=t.DELETE_ACTION=t.REFRESH_MODE=t.DbSet=void 0;Object.defineProperty(t,"DbSet",{enumerable:!0,get:function(){return i.DbSet}});__exportStar(r,t);__exportStar(u,t);__exportStar(f,t);Object.defineProperty(t,"REFRESH_MODE",{enumerable:!0,get:function(){return e.REFRESH_MODE}});Object.defineProperty(t,"DELETE_ACTION",{enumerable:!0,get:function(){return e.DELETE_ACTION}});Object.defineProperty(t,"DATA_OPER",{enumerable:!0,get:function(){return e.DATA_OPER}});Object.defineProperty(t,"FLAGS",{enumerable:!0,get:function(){return e.FLAGS}});__exportStar(o,t);__exportStar(s,t);__exportStar(h,t);__exportStar(c,t);__exportStar(l,t);__exportStar(a,t);t.VERSION="3.0.9"});var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__createBinding=this&&this.__createBinding||(Object.create?function(n,t,i,r){r===undefined&&(r=i);Object.defineProperty(n,r,{enumerable:!0,get:function(){return t[i]}})}:function(n,t,i,r){r===undefined&&(r=i);n[r]=t[i]}),__exportStar=this&&this.__exportStar||function(n,t){for(var i in n)i==="default"||Object.prototype.hasOwnProperty.call(t,i)||__createBinding(t,n,i)};define("jriapp_ui/int",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cssStyles=void 0;var i;(function(n){n.fieldError="ria-field-error";n.content="ria-content-field";n.required="ria-required-field";n.editMode="ria-edit-mode";n.checkbox="ria-checkbox";n.commandLink="ria-command-link";n.checkedNull="ria-checked-null";n.dataform="ria-dataform";n.error="ria-form-error";n.disabled="disabled";n.opacity="opacity";n.color="color";n.fontSize="font-size"})(i=t.cssStyles||(t.cssStyles={}))});define("jriapp_ui/content/basic",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp/binding","jriapp/utils/lifetime"],function(n,t,i,r,u,f,e){"use strict";function h(n,t,i){var r=a.app.viewFactory,u=r.store.getElView(n),f;return!u?(f={el:n,name:t,options:i||{}},r.createElView(f)):u}function c(n,t,i,r,u,e,o){e===void 0&&(e=null);o===void 0&&(o=null);var h={target:null,source:null,targetPath:null,sourcePath:t,mode:n?"TwoWay":"OneWay",converter:null,param:null,isBind:!1},s=f.getBindingOptions(h,i,r);return!u||(s.targetPath=u),s.converter=e,s.param=o,s}var y;Object.defineProperty(t,"__esModule",{value:!0});t.BasicContent=t.getBindingOption=t.getView=void 0;var s=i.Utils,o=r.DomUtils,l=o.document,p=s.core.extend,a=u.bootstrapper,v=s.sys;t.getView=h;t.getBindingOption=c;y=function(n){function t(t){var i=n.call(this)||this;return t=p({parentEl:null,contentOptions:null,dataContext:null,isEditing:!1},t),i._el=null,i._parentEl=t.parentEl,i._isEditing=!!t.isEditing,i._dataContext=t.dataContext,i._options=t.contentOptions,i._isReadOnly=!!i._options.readOnly,i._lfScope=null,i._view=null,o.addClass([i._parentEl],"ria-content-field"),i}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var i=this._el,t=this._options.css;o.removeClass([this._parentEl],"ria-content-field");o.removeClass([this._parentEl],"ria-required-field");!t||(!t.readCss||o.removeClass([this._parentEl],t.readCss),!t.editCss||o.removeClass([this._parentEl],t.editCss),!i||!t.elReadCss||o.removeClass([i],t.elReadCss),!i||!t.elEditCss||o.removeClass([i],t.elEditCss));this.cleanUp();this._parentEl=null;this._dataContext=null;this._options=null;n.prototype.dispose.call(this)}},t.prototype.updateCss=function(){var n=this._options.css,t=this._parentEl,i=this.el,r=this.getFieldInfo();this._isEditing&&this.getIsCanBeEdited()?(!n||(!n.readCss||o.removeClass([t],n.readCss),!n.editCss||o.addClass([t],n.editCss),!i||!n.elReadCss||o.removeClass([i],n.elReadCss),!i||!n.elEditCss||o.addClass([i],n.elEditCss)),!r||r.isNullable||o.addClass([t],"ria-required-field"),o.addClass([t],"ria-edit-mode")):(!n||(!n.editCss||o.removeClass([t],n.editCss),!n.readCss||o.addClass([t],n.readCss),!i||!n.elEditCss||o.removeClass([i],n.elEditCss),!i||!n.elReadCss||o.addClass([i],n.elReadCss)),!r||r.isNullable||o.removeClass([t],"ria-required-field"),o.removeClass([t],"ria-edit-mode"))},t.prototype.getIsCanBeEdited=function(){var n,t;return this._isReadOnly?!1:(n=this.getFieldInfo(),!n)?!1:(t=v.getEditable(this._dataContext),!!t&&!n.isReadOnly&&n.fieldType!==2)},t.prototype.getBindings=function(){var n;if(!this._lfScope)return[];var t=this._lfScope.getObjs(),i=[],r=t.length;for(n=0;n<r;n+=1)v.isBinding(t[n])&&i.push(t[n]);return i},t.prototype.updateBindingSource=function(){for(var t,i=this.getBindings(),r=i.length,n=0;n<r;n+=1)t=i[n],t.isSourceFixed||(t.source=this._dataContext)},t.prototype.cleanUp=function(){!this._lfScope||(this._lfScope.dispose(),this._lfScope=null);!this._el||(o.removeNode(this._el),this._el=null);this._view=null},t.prototype.getFieldInfo=function(){return this._options.fieldInfo},t.prototype.getParam=function(){return null},t.prototype.getConverter=function(){return null},t.prototype.getViewName=function(){return null},t.prototype.createdEditingView=function(){var u=this.getViewName(!0),i=l.createElement("input"),t=this._options.options,n,r;return i.setAttribute("type","text"),!t||!t.placeholder||i.setAttribute("placeholder",t.placeholder),n=h(i,u,t),!n||this.lfScope.addObj(n),r=c(!0,this.options.fieldName,n,this.dataContext,"value",this.getConverter(!0),this.getParam(!0)),this._lfScope.addObj(this.app.bind(r)),n},t.prototype.createdReadingView=function(){var i=this.getViewName(!1),r=l.createElement("span"),n=h(r,i,{}),t;return!n||this.lfScope.addObj(n),t=c(!1,this.options.fieldName,n,this.dataContext,"value",this.getConverter(!1),this.getParam(!1)),this._lfScope.addObj(this.app.bind(t)),n},t.prototype.beforeCreateView=function(){return this.cleanUp(),!!this._options.fieldName},t.prototype.createView=function(){var n=null;n=this._isEditing&&this.getIsCanBeEdited()?this.createdEditingView():this.createdReadingView();this._el=n.el;this._view=n;this.updateCss()},t.prototype.afterCreateView=function(){this._parentEl.appendChild(this._el)},t.prototype.render=function(){if(this.beforeCreateView())try{this.createView();this.afterCreateView()}catch(n){s.err.reThrow(n,this.handleError(n,this))}},t.prototype.toString=function(){return"BasicContent"},Object.defineProperty(t.prototype,"lfScope",{get:function(){return this._lfScope||(this._lfScope=new e.LifeTimeScope),this._lfScope},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return this._isEditing},set:function(n){this._isEditing!==n&&(this._isEditing=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){this._dataContext!==n&&(this._dataContext=n,this.updateBindingSource())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._isReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return a.app},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.BasicContent=y});define("jriapp_ui/content/template",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp/template"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TemplateContent=void 0;var o=i.Utils,s=o.core.extend,e=r.DomUtils,h=u.bootstrapper,c=o.err,l=function(n){function t(t){var i=n.call(this)||this;return t=s({parentEl:null,contentOptions:null,dataContext:null,isEditing:!1,appName:null},t),i._templateID=null,i._parentEl=t.parentEl,i._isEditing=t.isEditing,i._dataContext=t.dataContext,i._templateInfo=t.contentOptions.template,i._template=null,i._options=t.contentOptions,e.addClass([i._parentEl],"ria-content-field"),i}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();e.removeClass([this._parentEl],"ria-content-field");var t=this._options.css;!t||!t.readCss||e.removeClass([this._parentEl],t.readCss);!t||!t.editCss||e.removeClass([this._parentEl],t.editCss);this.cleanUp();this._parentEl=null;this._dataContext=null;this._templateInfo=null;n.prototype.dispose.call(this)}},t.prototype.updateCss=function(){var n=this._options.css,t=this._parentEl;this._isEditing?!n||(!n.editCss||e.addClass([t],n.editCss),!n.readCss||e.removeClass([t],n.readCss)):!n||(!n.readCss||e.addClass([t],n.readCss),!n.editCss||e.removeClass([t],n.editCss))},t.prototype.getTemplateID=function(){if(!this._templateInfo)throw new Error(i.LocaleERRS.ERR_TEMPLATE_ID_INVALID);var t=this._templateInfo,n=t.readID;if(this._isEditing&&!!t.editID&&(n=t.editID),n||(n=t.editID),!n)throw new Error(i.LocaleERRS.ERR_TEMPLATE_ID_INVALID);return n},t.prototype.createTemplate=function(n){var t=f.createTemplate({parentEl:n,dataContext:this._dataContext});return t.templateID=this._templateID,t},t.prototype.cleanUp=function(){!this._template||(this._template.dispose(),this._template=null,this._templateID=null)},t.prototype.render=function(){try{var n=this.getTemplateID();this._templateID!==n&&(this.cleanUp(),this._templateID=n,this._template=this.createTemplate(this.parentEl));this.updateCss()}catch(t){c.reThrow(t,this.handleError(t,this))}},t.prototype.toString=function(){return"TemplateContent"},Object.defineProperty(t.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return this._isEditing},set:function(n){this._isEditing!==n&&(this._isEditing=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){this._dataContext!==n&&(this._dataContext=n,!this._template||(this._template.dataContext=this._dataContext))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return h.app},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.TemplateContent=l});define("jriapp_ui/utils/eventbag",["require","exports","jriapp_shared"],function(n,t,i){"use strict";var f;Object.defineProperty(t,"__esModule",{value:!0});t.EventBag=t.EVENT_CHANGE_TYPE=void 0;var r=i.Utils,e=r.core.Indexer,u=r.str.trimBrackets,o;(function(n){n[n.None=0]="None";n[n.Added=1]="Added";n[n.Deleted=2]="Deleted";n[n.Updated=3]="Updated"})(o=t.EVENT_CHANGE_TYPE||(t.EVENT_CHANGE_TYPE={}));f=function(n){function t(t){var i=n.call(this)||this;return i._dic=null,i._onChange=t,i}return __extends(t,n),t.prototype.isHasProp=function(){return!0},t.prototype.getProp=function(n){if(!this._dic)return null;var i=u(n),t=this._dic[i];return t?t:null},t.prototype.setProp=function(n,t){if(this._dic||!t||(this._dic=e()),this._dic){var i=u(n),r=this._dic[i];if(!t&&!!r){delete this._dic[i];!this._onChange||(this._onChange(this,{name:i,changeType:2,oldVal:r,newVal:null}),this.objEvents.raiseProp(n));return}this._dic[i]=t;!this._onChange||(r?this._onChange(this,{name:i,changeType:3,oldVal:r,newVal:t}):this._onChange(this,{name:i,changeType:1,oldVal:null,newVal:t}),this.objEvents.raiseProp(n))}},Object.defineProperty(t.prototype,"isPropertyBag",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.trigger=function(n,t){if(!this._dic)return!1;var i=this._dic[n];return i?(t=t||{},i.canExecute(t)?(i.execute(t),!0):!1):!1},t.prototype.toString=function(){return"EventBag"},t.prototype.dispose=function(){!this._dic||(this._dic=null);this._onChange=null;n.prototype.dispose.call(this)},t}(i.BaseObject);t.EventBag=f});define("jriapp_ui/utils/propbag",["require","exports","jriapp_shared"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PropertyBag=void 0;var u=i.Utils,r=u.str.trimBrackets,f=function(n){function t(t){var i=n.call(this)||this;return i._el=t,i}return __extends(t,n),t.prototype.isHasProp=function(n){var t=r(n);return t in this._el},t.prototype.getProp=function(n){var t=r(n);return this._el[t]},t.prototype.setProp=function(n,t){var i=r(n),u=this._el[i];u!==t&&(this._el[i]=t,this.objEvents.raiseProp(n))},Object.defineProperty(t.prototype,"isPropertyBag",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"PropertyBag"},t}(i.BaseObject);t.PropertyBag=f});define("jriapp_ui/utils/cssbag",["require","exports","jriapp_shared","jriapp/utils/dom"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CSSBag=void 0;var e=i.Utils,f=e.check,o=f._undefined,s=f.isArray,h=f.isString,u=r.DomUtils,c=e.str.trimBrackets,l=function(n){function t(t){var i=n.call(this)||this;return i._el=t,i}return __extends(t,n),t.prototype.isHasProp=function(){return!0},t.prototype.getProp=function(){return o},t.prototype.setProp=function(n,t){if(t!==o){var i=c(n);if(i==="*"){t?s(t)?u.setClasses([this._el],t):h(t)&&u.setClasses([this._el],t.split(" ")):u.removeClass([this._el],null);return}u.setClass([this._el],i,!t)}},Object.defineProperty(t.prototype,"isPropertyBag",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"CSSBag"},t}(i.BaseObject);t.CSSBag=l});define("jriapp_ui/baseview",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/utils/viewchecks","jriapp/bootstrapper","jriapp_ui/utils/eventbag","jriapp_ui/utils/propbag","jriapp_ui/utils/cssbag"],function(n,t,i,r,u,f,e,o,s){"use strict";function a(n,t,i,r){var u=c.getSvc("ITooltipService");u.addToolTip(n,t,i,r)}function k(){return c.getSvc("IUIErrorsService")}var l;Object.defineProperty(t,"__esModule",{value:!0});t.BaseElView=t.addToolTip=t.EVENT_CHANGE_TYPE=void 0;var y=i.Utils,p=y.core.getNewID,h=r.DomUtils,v=y.check._undefined,c=f.bootstrapper,w=u.ViewChecks,b=f.subscribeWeakMap;w.isElView=function(n){return!!n&&n instanceof l};t.addToolTip=a;l=function(n){function t(t,i){var r=n.call(this)||this,u;return r._el=t,r._bindingState=0,r._bindCompleteList=null,i=i||{},u={tip:i.tip?i.tip:null,css:i.css?i.css:null,errorsService:i.errorsService?i.errorsService:null,_eventBag:null,_propBag:null,_classBag:null,_display:null,_errors:null},r._uniqueID=p("elv"),r._viewState=u,r._subscribeFlags=i.nodelegate?0:1,!u.css||h.addClass([t],u.css),r._applyToolTip(),r._getStore().setElView(t,r),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();try{h.events.offNS(this.el,this.uniqueID);this.validationErrors=null;a(this.el,null);this._subscribeFlags!==0&&(b.delete(this.el),this._subscribeFlags=0);!this._viewState._eventBag||this._viewState._eventBag.dispose();!this._viewState._propBag||this._viewState._propBag.dispose();!this._viewState._classBag||this._viewState._classBag.dispose();this._viewState={}}finally{this._getStore().setElView(this.el,null);n.prototype.dispose.call(this)}}},t.prototype._getStore=function(){return this.app.viewFactory.store},t.prototype._onBindCompleted=function(){var n,t,i;if(this._bindCompleteList)try{for(n=0,t=this._bindCompleteList;n<t.length;n++)i=t[n],i()}finally{this._bindCompleteList=null}},t.prototype._onEventChanged=function(n){switch(n.changeType){case 1:this._onEventAdded(n.name,n.newVal);break;case 2:this._onEventDeleted(n.name,n.oldVal)}},t.prototype._onEventAdded=function(n){var t=this;if(!this.getIsStateDirty())h.events.on(this.el,n,function(i){!t._viewState._eventBag||t._viewState._eventBag.trigger(n,i)},this.uniqueID)},t.prototype._onEventDeleted=function(n){h.events.off(this.el,n,this.uniqueID)},t.prototype._applyToolTip=function(){!this.toolTip||a(this.el,this.toolTip)},t.prototype._setIsSubcribed=function(n){this._subscribeFlags|=1<<n},t.prototype._setErrors=function(n,t){this._viewState._errors=t;var i=this._viewState.errorsService?this._viewState.errorsService:k();i.setErrors(n,t,this.toolTip)},t.prototype._registerOnBindCompleted=function(n){this._bindCompleteList?this._bindCompleteList.push(n):this._bindCompleteList=[n]},t.prototype.isSubscribed=function(n){return!!(this._subscribeFlags&1<<n)},t.prototype.toString=function(){return"BaseElView"},Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){var n=this.el.style.display;return!(n==="none")},set:function(n){n=!!n;n!==this.isVisible&&(n?this.el.style.display=this._viewState._display?this._viewState._display:"":(this._viewState._display=this.el.style.display,this._viewState._display==="none"&&(this._viewState._display=null),this.el.style.display="none"),this.objEvents.raiseProp("isVisible"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"validationErrors",{get:function(){return this._viewState._errors},set:function(n){this.getIsDisposed()||this._viewState._errors===n||(this._setErrors(this.el,n),this.objEvents.raiseProp("validationErrors"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataName",{get:function(){return this._el.getAttribute("data-name")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"toolTip",{get:function(){return this._viewState.tip},set:function(n){this.toolTip!==n&&(this._viewState.tip=n,a(this.el,n),this.objEvents.raiseProp("toolTip"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){var n=this;if(!this._viewState._eventBag){if(this.getIsStateDirty())return v;this._viewState._eventBag=new e.EventBag(function(t,i){n._onEventChanged(i)})}return this._viewState._eventBag},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"props",{get:function(){if(!this._viewState._propBag){if(this.getIsStateDirty())return v;this._viewState._propBag=new o.PropertyBag(this.el)}return this._viewState._propBag},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classes",{get:function(){if(!this._viewState._classBag){if(this.getIsStateDirty())return v;this._viewState._classBag=new s.CSSBag(this.el)}return this._viewState._classBag},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDelegationOn",{get:function(){return!!(this._subscribeFlags&1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"css",{get:function(){return this._viewState.css},set:function(n){var t=[];this.css!==n&&(!this.css||t.push("-"+this.css),this._viewState.css=n,!this.css||t.push("+"+this.css),h.setClasses([this._el],t),this.objEvents.raiseProp("css"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bindingState",{get:function(){return this._bindingState},set:function(n){this._bindingState!==n&&(this._bindingState=n,this._bindingState!==0||!this._bindCompleteList||this._onBindCompleted())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"app",{get:function(){return c.app},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.BaseElView=l;c.registerElView("generic",l);c.registerElView("baseview",l)});define("jriapp_ui/input",["require","exports","jriapp_ui/baseview"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.InputElView=void 0;var r=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"InputElView"},Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this.el.disabled},set:function(n){var t=this.el;n!==t.disabled&&(t.disabled=n,this.objEvents.raiseProp("isDisabled"),this.objEvents.raiseProp("isEnabled"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return!this.isDisabled},set:function(n){this.isDisabled=!n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.el.value},set:function(n){var t=this.value,i=""+n;n=n?i:"";t!==n&&(this.el.value=n,this.objEvents.raiseProp("value"))},enumerable:!1,configurable:!0}),t}(i.BaseElView);t.InputElView=r});define("jriapp_ui/textbox",["require","exports","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/input"],function(n,t,i,r,u){"use strict";var f,o,s,e;Object.defineProperty(t,"__esModule",{value:!0});t.TextBoxElView=void 0;f=i.DomUtils;o=r.subscribeWeakMap,function(n){n.keypress="keypress"}(s||(s={}));e=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;if(r.isDelegationOn){if(o.set(t,r),!i.updateOnInput)r._setIsSubcribed(2);else f.events.on(t,"input",function(n){n.stopPropagation();u.handle_change(n)},r.uniqueID);r._setIsSubcribed(3);!i.updateOnKeyUp||r._setIsSubcribed(5)}else{f.events.on(t,"keypress",function(n){u.handle_keypress(n)},r.uniqueID);if(!i.updateOnInput)f.events.on(t,"change",function(n){n.stopPropagation();u.handle_change(n)},r.uniqueID);else f.events.on(t,"input",function(n){n.stopPropagation();u.handle_change(n)},r.uniqueID);if(!!i.updateOnKeyUp)f.events.on(t,"keyup",function(n){u.handle_keyup(n)},r.uniqueID)}return r}return __extends(t,n),t.prototype.handle_change=function(){return this.objEvents.raiseProp("value"),!0},t.prototype.handle_keypress=function(n){var t={keyCode:n.which,value:n.target.value,isCancel:!1};return this.objEvents.raise("keypress",t),t.isCancel&&n.preventDefault(),!0},t.prototype.handle_keyup=function(){this.objEvents.raiseProp("value")},t.prototype.addOnKeyPress=function(n,t){this.objEvents.on("keypress",n,t)},t.prototype.offOnKeyPress=function(n){this.objEvents.off("keypress",n)},t.prototype.toString=function(){return"TextBoxElView"},Object.defineProperty(t.prototype,"color",{get:function(){return this.el.style.color},set:function(n){var t=this.el.style.color;n!==t&&(this.el.style.color=n,this.objEvents.raiseProp("color"))},enumerable:!1,configurable:!0}),t}(u.InputElView);t.TextBoxElView=e;r.bootstrapper.registerElView("input:text",e)});define("jriapp_ui/content/string",["require","exports","jriapp_ui/textbox","jriapp_ui/content/basic"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StringContent=void 0;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"allowedKeys",{get:function(){return t._allowedKeys||(t._allowedKeys=[0,8,127,37,39,35,36,9,27,13]),t._allowedKeys},enumerable:!1,configurable:!0}),t.prototype.createView=function(){n.prototype.createView.call(this);var t=this,r=t.getFieldInfo();t.view instanceof i.TextBoxElView&&t.view.addOnKeyPress(function(n,i){i.isCancel=!t.previewKeyPress(r,i.keyCode,i.value)})},t.prototype.previewKeyPress=function(n,t,i){return this.allowedKeys.indexOf(t)>-1?!0:!(n.maxLength>0&&i.length>=n.maxLength)},t.prototype.toString=function(){return"StringContent"},t._allowedKeys=null,t}(r.BasicContent);t.StringContent=u});define("jriapp_ui/textarea",["require","exports","jriapp/bootstrapper","jriapp_ui/textbox"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TextAreaElView=void 0;var u=function(n){function t(t,i){var r=n.call(this,t,i)||this;return!i.wrap||(t.wrap=i.wrap),r}return __extends(t,n),t.prototype.toString=function(){return"TextAreaElView"},Object.defineProperty(t.prototype,"wrap",{get:function(){return this.el.wrap},set:function(n){var t=this.wrap;t!==n&&(this.el.wrap=n,this.objEvents.raiseProp("wrap"))},enumerable:!1,configurable:!0}),t}(r.TextBoxElView);t.TextAreaElView=u;i.bootstrapper.registerElView("textarea",u)});define("jriapp_ui/content/multyline",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/textarea","jriapp_ui/content/basic"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MultyLineContent=void 0;var s=i.Utils,e="multyline",h=s.str.format,c=r.DomUtils,o=c.document,l=function(n){function t(t){var r=this;if(t.contentOptions.name!==e)throw new Error(h(i.LocaleERRS.ERR_ASSERTION_FAILED,"contentOptions.name === '"+e+"'"));return n.call(this,t)||this}return __extends(t,n),Object.defineProperty(t.prototype,"allowedKeys",{get:function(){return t._allowedKeys||(t._allowedKeys=[0,8,127,37,39,35,36,9,27,13]),t._allowedKeys},enumerable:!1,configurable:!0}),t.prototype.createdEditingView=function(){var i=this.getViewName(!0),r=o.createElement("textarea"),u=this.options.options,n=f.getView(r,i,u),t;return!n||this.lfScope.addObj(n),t=f.getBindingOption(!0,this.options.fieldName,n,this.dataContext,"value",this.getConverter(!0),this.getParam(!0)),this.lfScope.addObj(this.app.bind(t)),n},t.prototype.createdReadingView=function(){var i=this.getViewName(!1),r=o.createElement("div"),n=f.getView(r,i,{}),t;return!n||this.lfScope.addObj(n),t=f.getBindingOption(!1,this.options.fieldName,n,this.dataContext,"value",this.getConverter(!1),this.getParam(!1)),this.lfScope.addObj(this.app.bind(t)),n},t.prototype.createView=function(){n.prototype.createView.call(this);var t=this,i=t.getFieldInfo();t.view instanceof u.TextAreaElView&&t.view.addOnKeyPress(function(n,r){r.isCancel=!t.previewKeyPress(i,r.keyCode,r.value)})},t.prototype.previewKeyPress=function(n,t,i){return this.allowedKeys.indexOf(t)>-1?!0:!(n.maxLength>0&&i.length>=n.maxLength)},t.prototype.toString=function(){return"MultyLineContent"},t._allowedKeys=null,t}(f.BasicContent);t.MultyLineContent=l});define("jriapp_ui/content/bool",["require","exports","jriapp/utils/dom","jriapp_ui/content/basic"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BoolContent=void 0;var u=i.DomUtils,f=u.document,e=function(n){function t(t){var i=n.call(this,t)||this;return i._label=null,i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),n.prototype.dispose.call(this),!this._label||(u.removeNode(this._label),this._label=null))},t.prototype.createCheckBoxView=function(){var e=this.getFieldInfo(),s=e?e.isNullable:!1,i=document.createElement("input"),n,t,o;return i.setAttribute("type","checkbox"),u.addClass([i],"ria-checkbox"),n=s?r.getView(i,"checkbox3",{}):r.getView(i,"checkbox",{}),!n||this.lfScope.addObj(n),t=f.createElement("label"),u.addClass([t],"ria-checkbox"),t.appendChild(n.el),t.appendChild(f.createElement("span")),this._label=t,o=r.getBindingOption(!0,this.options.fieldName,n,this.dataContext,"checked"),this.lfScope.addObj(this.app.bind(o)),n},t.prototype.createdEditingView=function(){return this.createCheckBoxView()},t.prototype.createdReadingView=function(){return this.createCheckBoxView()},t.prototype.beforeCreateView=function(){var n=!this.view&&!!this.options.fieldName;return!this.view||this.updateCss(),n},t.prototype.afterCreateView=function(){this.parentEl.appendChild(this._label)},t.prototype.updateCss=function(){n.prototype.updateCss.call(this);var t=this.el;t.disabled=this.isEditing&&this.getIsCanBeEdited()?!1:!0},t.prototype.toString=function(){return"BoolContent"},t}(r.BasicContent);t.BoolContent=e});define("jriapp_ui/content/number",["require","exports","jriapp/bootstrapper","jriapp_ui/textbox","jriapp_ui/content/basic"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NumberContent=void 0;var f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"allowedKeys",{get:function(){return t._allowedKeys||(t._allowedKeys=[0,8,127,37,39,35,36,9,27,13]),t._allowedKeys},enumerable:!1,configurable:!0}),t.prototype.getConverter=function(){var n=this.getFieldInfo();switch(n.dataType){case 3:return this.app.getConverter("integerConverter");case 4:return this.app.getConverter("decimalConverter");default:return this.app.getConverter("floatConverter")}},t.prototype.createView=function(){n.prototype.createView.call(this);var t=this;t.view instanceof r.TextBoxElView&&t.view.addOnKeyPress(function(n,i){i.isCancel=!t.previewKeyPress(i.keyCode,i.value)})},t.prototype.previewKeyPress=function(n,t){var r=String.fromCharCode(n),u=i.bootstrapper.defaults;return"~@#$%^&*()+=_".indexOf(r)>-1?!1:this.allowedKeys.indexOf(n)>-1?!0:r==="-"&&t.length===0?!0:r===u.decimalPoint?t.length===0?!1:t.indexOf(r)<0:r===u.thousandSep?!0:"1234567890".indexOf(r)>-1},t.prototype.toString=function(){return"NumberContent"},t._allowedKeys=null,t}(u.BasicContent);t.NumberContent=f});define("jriapp_ui/content/date",["require","exports","jriapp_shared","jriapp_ui/content/basic"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateContent=void 0;var f=i.Utils,e=f.str.format,u="datepicker",o=function(n){function t(t){var r=this;if(t.contentOptions.name!==u)throw new Error(e(i.LocaleERRS.ERR_ASSERTION_FAILED,"contentOptions.name === '"+u+"'"));return n.call(this,t)||this}return __extends(t,n),t.prototype.getConverter=function(){return this.app.getConverter("dateConverter")},t.prototype.getViewName=function(n){return n?u:null},t.prototype.toString=function(){return"DateContent"},t}(r.BasicContent);t.DateContent=o});define("jriapp_ui/content/datetime",["require","exports","jriapp/bootstrapper","jriapp_ui/content/basic"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateTimeContent=void 0;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.getParam=function(){var t=this.getFieldInfo(),n=i.bootstrapper.defaults;switch(t.dataType){case 6:return n.dateTimeFormat;case 7:return n.dateFormat;case 8:return n.timeFormat;default:return null}},t.prototype.getConverter=function(){return this.app.getConverter("dateTimeConverter")},t.prototype.toString=function(){return"DateTimeContent"},t}(r.BasicContent);t.DateTimeContent=u});define("jriapp_ui/listbox",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r,u,f){"use strict";function e(n){return o(n)?"":""+n}var w,b;Object.defineProperty(t,"__esModule",{value:!0});t.ListBoxElView=t.ListBox=void 0;var a=i.Utils,v=r.DomUtils,g=v.document,c=a.sys,y=a.check,s=y._undefined,nt=y.isString,o=y.isNt,l=a.core,p=l.forEach,tt=l.extend,it=l.getNewID,h=l.Indexer,rt=u.bootstrapper,k=u.subscribeWeakMap,d;(function(n){n.refreshed="refreshed"})(d||(d={}));w=function(n){function t(t,r){var u=n.call(this)||this,f=u,e;if(r=tt({dataSource:null,valuePath:null,textPath:null,statePath:null,syncSetDatasource:!1,nodelegate:!1},r),!!r.dataSource&&!c.isCollection(r.dataSource))throw new Error(i.LocaleERRS.ERR_LISTBOX_DATASRC_INVALID);if(u._el=t,u._options=r,u._uniqueID=it("lst"),u._isDSFilled=!1,u._textProvider=null,u._stateProvider=null,u._isRefreshing=!1,u._selectedValue=null,u._dsDebounce=new i.Debounce,u._stDebounce=new i.Debounce,u._txtDebounce=new i.Debounce,u._changeDebounce=new i.Debounce,u._keyMap=h(),u._valMap=h(),u._savedVal=s,u._fnState=function(n){if(n&&n.item&&!n.item.getIsStateDirty()){var t=n.item,i=f.statePath,u=i?c.resolvePath(t,i):null,r=f._stateProvider;n.op.className=r?r.getCSS(t,n.op.index,u):""}},u._options.nodelegate)v.events.on(t,"change",function(n){return u.handle_change(n)},u._uniqueID);else k.set(t,u);return e=u._options.dataSource,u.setDataSource(e),u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._options.nodelegate||k.delete(this._el),v.events.offNS(this._el,this._uniqueID),this._dsDebounce.dispose(),this._stDebounce.dispose(),this._txtDebounce.dispose(),this._changeDebounce.dispose(),this._fnCheckSelected=null,this._unbindDS(),this._clear(),this._el=null,this._selectedValue=s,this._savedVal=s,this._options={},this._textProvider=null,this._stateProvider=null,this._isDSFilled=!1,n.prototype.dispose.call(this))},t.prototype._bindDS=function(){var n=this,t=this.dataSource;t&&(t.addOnCollChanged(n._onDSCollectionChanged,n._uniqueID,n),t.addOnBeginEdit(function(t,i){n._onEdit(i.item,!0,!1)},n._uniqueID),t.addOnEndEdit(function(t,i){n._onEdit(i.item,!1,i.isCanceled)},n._uniqueID),t.addOnStatusChanged(function(t,i){n._onStatusChanged(i.item,i.oldStatus)},n._uniqueID),t.addOnCommitChanges(function(t,i){n._onCommitChanges(i.item,i.isBegin,i.isRejected,i.status)},n._uniqueID))},t.prototype._unbindDS=function(){var t=this,n=this.dataSource;n&&n.objEvents.offNS(t._uniqueID)},t.prototype._addOption=function(n,t){var o=n?n._key:"",i,f,s,r,u,h;if(!!this._keyMap[o])return null;if(i=this.el,f="",n?f=this._getText(n,i.options.length):nt(this._options.emptyOptionText)&&(f=this._options.emptyOptionText),s=e(this._getValue(n)),r=g.createElement("option"),r.text=f,r.value=o,u={item:n,op:r},this._keyMap[o]=u,!s||(this._valMap[s]=u),t?i.options.length<2?i.add(r,null):(h=i.options[1],i.add(r,h)):i.add(r,null),!!n){if(!!this.statePath)n.objEvents.onProp(this.statePath,this._fnState,this._uniqueID);this._fnState(u)}return u},t.prototype._mapByValue=function(){var n=this;this._valMap=h();p(this._keyMap,function(t){var i=n._keyMap[t],r=e(n._getValue(i.item));!r||(n._valMap[r]=i)})},t.prototype._resetText=function(){var n=this;p(this._keyMap,function(t){var i=n._keyMap[t];i.op.text=n._getText(i.item,i.op.index)})},t.prototype._resetState=function(){var n=this;p(this._keyMap,function(t){n._fnState(n._keyMap[t])})},t.prototype._removeOption=function(n){var t,i,r,u,f;if(!!n){if(t=n._key,i=this._keyMap[t],!i)return;n.objEvents.offNS(this._uniqueID);this.el.remove(i.op.index);r=e(this._getValue(n));delete this._keyMap[t];!r||delete this._valMap[r];u=this.getByIndex(this.selectedIndex);f=u?this._getValue(u.item):null;this._selectedValue=f;this.updateSelected(f)}},t.prototype._clear=function(){for(var u,n,t=this,f=Object.keys(t._keyMap),i=0,r=f;i<r.length;i++)u=r[i],n=t._keyMap[u],!n||!n.item||n.item.objEvents.offNS(t._uniqueID);this.el.options.length=0;this._keyMap=h();this._valMap=h()},t.prototype._refresh=function(){var t=this,u=this.dataSource,i,n,r,f;this.beginTrackSelected();this._isRefreshing=!0;try{if(this._clear(),this._options.noEmptyOption||this._addOption(null,!1),i=0,!!u)for(n=0,r=u.items;n<r.length;n++)f=r[n],t._addOption(f,!1),++i;!this._isDSFilled||o(this._selectedValue)||this.getByValue(this._selectedValue)?t.updateSelected(this._selectedValue):this.selectedValue=null;i>0&&(this._isDSFilled=!0)}finally{t._isRefreshing=!1;this.endTrackSelected()}this.objEvents.raise("refreshed",{})},t.prototype._onSelectedChanged=function(){var n=this.getByIndex(this.selectedIndex),t;if(!n){this.selectedValue=null;return}t=this._getValue(n.item);this.selectedValue=t},t.prototype._getValue=function(n){return n?this._options.valuePath?c.resolvePath(n,this._options.valuePath):null:null},t.prototype._getText=function(n,t){var i="",r;return n?(this._options.textPath?(r=c.resolvePath(n,this._options.textPath),i=e(r)):i=e(this._getValue(n)),this._textProvider?this._textProvider.getText(n,t,i):i):i},t.prototype._onDSCollectionChanged=function(n,t){var i=this,u,o,f,s,r,e;this.beginTrackSelected();try{switch(t.changeType){case 2:this._refresh();break;case 1:for(u=0,o=t.items;u<o.length;u++)r=o[u],i._addOption(r,r._aspect.isNew);break;case 0:for(f=0,s=t.items;f<s.length;f++)r=s[f],i._removeOption(r);!i._textProvider||i._resetText();break;case 3:e=i._keyMap[t.old_key];!e||(delete i._keyMap[t.old_key],i._keyMap[t.new_key]=e,e.op.value=t.new_key)}}finally{this.endTrackSelected()}},t.prototype._onEdit=function(n,t,i){var u=this,r,c,f,h;if(t)this.beginTrackSelected(),this._savedVal=this._getValue(n);else try{i||(r=this._savedVal,this._savedVal=s,c=n._key,f=u._keyMap[c],f?(f.op.text=u._getText(n,f.op.index),h=this._getValue(n),r!==h&&(o(r)||delete u._valMap[e(r)],o(h)||(u._valMap[e(h)]=f))):o(r)||delete u._valMap[e(r)])}finally{this.endTrackSelected()}},t.prototype._onStatusChanged=function(n){var t=n._aspect.status;this.beginTrackSelected();t===3&&(this._removeOption(n),!this._textProvider||this._resetText());this.endTrackSelected()},t.prototype._onCommitChanges=function(n,t,i,r){var f=this,h,c,u;if(t){if(this.beginTrackSelected(),i&&r===1)return;if(!i&&r===3)return;this._savedVal=this._getValue(n)}else{if(h=this._savedVal,this._savedVal=s,i&&r===3){this._addOption(n,!0);this.endTrackSelected();return}try{c=this._getValue(n);u=f._keyMap[n._key];h!==c&&(o(h)||delete f._valMap[e(h)],!u||o(c)||(f._valMap[e(c)]=u));!u||(u.op.text=f._getText(n,u.op.index))}finally{this.endTrackSelected()}}},t.prototype.getItemIndex=function(n){if(!n||n.getIsStateDirty())return-1;var t=this._keyMap[n._key];return t?t.op.index:-1},t.prototype.getByValue=function(n){if(o(n))return null;var i=e(n),t=this._valMap[i];return t?t:null},t.prototype.getByIndex=function(n){if(n>=0&&n<this.el.length){var t=this.el.options[n],i=t.value;return this._keyMap[i]}return null},t.prototype.updateSelected=function(n){var t=o(n)?null:this.getByValue(n),i=t?t.op.index:0,r=this._isRefreshing;this._isRefreshing=!0;try{this.selectedIndex=i}finally{this._isRefreshing=r}},t.prototype.beginTrackSelected=function(){if(!this._fnCheckSelected){var n=this,t=e(n.selectedValue),i=n.selectedItem;this._fnCheckSelected=function(){n._fnCheckSelected=null;var r=e(n.selectedValue),u=n.selectedItem;t!==r&&n.objEvents.raiseProp("selectedValue");i!==u&&n.objEvents.raiseProp("selectedItem")}}},t.prototype.endTrackSelected=function(){var n=this;this._changeDebounce.enque(function(){var t=n._fnCheckSelected;n._fnCheckSelected=null;!t||t()})},t.prototype.setIsEnabled=function(n,t){n.disabled=!t},t.prototype.getIsEnabled=function(n){return!n.disabled},t.prototype.setDataSource=function(n){var t=this,i;this._isDSFilled=!1;this.beginTrackSelected();this._unbindDS();this._options.dataSource=n;i=function(){try{var n=t._options.dataSource;t._txtDebounce.cancel();t._stDebounce.cancel();!n||n.getIsStateDirty()?(t._clear(),t._options.noEmptyOption||t._addOption(null,!1)):(t._bindDS(),t._refresh())}finally{t.endTrackSelected()}};this._options.syncSetDatasource?i():this._dsDebounce.enque(i)},Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return!this.el||this.el.length==0?-1:this.el.selectedIndex},set:function(n){!!this.el&&this.el.length>n&&this.selectedIndex!==n&&(this.el.selectedIndex=n)},enumerable:!1,configurable:!0}),t.prototype.isSubscribed=function(n){return!this._options.nodelegate&&n===2},t.prototype.handle_change=function(){return this._isRefreshing?!0:(this._onSelectedChanged(),!0)},t.prototype.addOnRefreshed=function(n,t,i){this.objEvents.on("refreshed",n,t,i)},t.prototype.offOnRefreshed=function(n){this.objEvents.off("refreshed",n)},t.prototype.getText=function(n){var t=this.getByValue(n);return t?t.op.text:""},t.prototype.toString=function(){return"ListBox"},Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(n){this.dataSource!==n&&(this.setDataSource(n),this.objEvents.raiseProp("dataSource"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){return!o(this._selectedValue)&&!this.getByValue(this._selectedValue)?s:this._selectedValue},set:function(n){if(this._selectedValue!==n){var t=this.selectedItem;this._selectedValue=n;this.updateSelected(n);this._fnCheckSelected=null;this.objEvents.raiseProp("selectedValue");t!==this.selectedItem&&this.objEvents.raiseProp("selectedItem")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){var n=this.getByValue(this._selectedValue);return n?n.item:null},set:function(n){var t=this._getValue(n),r=this.selectedItem,i;this._selectedValue!==t&&(this._selectedValue=t,i=this.getByValue(t),this.selectedIndex=i?i.op.index:0,this._fnCheckSelected=null,this.objEvents.raiseProp("selectedValue"),r!==this.selectedItem&&this.objEvents.raiseProp("selectedItem"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valuePath",{get:function(){return this._options.valuePath},set:function(n){n!==this.valuePath&&(this._options.valuePath=n,this._mapByValue(),this.objEvents.raiseProp("valuePath"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textPath",{get:function(){return this._options.textPath},set:function(n){n!==this.textPath&&(this._options.textPath=n,this._resetText(),this.objEvents.raiseProp("textPath"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"statePath",{get:function(){return this._options.statePath},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.getIsEnabled(this.el)},set:function(n){n!==this.isEnabled&&(this.setIsEnabled(this.el,n),this.objEvents.raiseProp("isEnabled"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textProvider",{get:function(){return this._textProvider},set:function(n){var t=this;n!==this._textProvider&&(this._textProvider=n,this._txtDebounce.enque(function(){t._resetText()}),this.objEvents.raiseProp("textProvider"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stateProvider",{get:function(){return this._stateProvider},set:function(n){var t=this;n!==this._stateProvider&&(this._stateProvider=n,this._stDebounce.enque(function(){t._resetState()}),this.objEvents.raiseProp("stateProvider"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.ListBox=w;b=function(n){function t(t,i){var u=n.call(this,t,i)||this,r=u;r._listBox=new w(t,i);r._listBox.objEvents.onProp("*",function(n,t){switch(t.property){case"dataSource":case"isEnabled":case"selectedValue":case"selectedItem":case"valuePath":case"textPath":case"textProvider":case"stateProvider":r.objEvents.raiseProp(t.property)}},r.uniqueID);return u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._listBox.getIsStateDirty()||this._listBox.dispose(),n.prototype.dispose.call(this))},t.prototype.toString=function(){return"ListBoxElView"},t.prototype.addOnRefreshed=function(n,t,i){this._listBox.objEvents.on("refreshed",n,t,i)},t.prototype.offOnRefreshed=function(n){this._listBox.objEvents.off("refreshed",n)},t.prototype.getText=function(n){return this._listBox.getText(n)},Object.defineProperty(t.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(n){n=!n;n!==!this.isEnabled&&(this.el.disabled=n,this.objEvents.raiseProp("isEnabled"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._listBox.dataSource},set:function(n){var t=this;t.dataSource!==n&&(t._listBox.dataSource=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedValue",{get:function(){return this.getIsStateDirty()?s:this._listBox.selectedValue},set:function(n){this._listBox.selectedValue!==n&&(this._listBox.selectedValue=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this.getIsStateDirty()?s:this._listBox.selectedItem},set:function(n){this._listBox.selectedItem=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valuePath",{get:function(){return this._listBox.valuePath},set:function(n){this._listBox.valuePath=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textPath",{get:function(){return this._listBox.textPath},set:function(n){this._listBox.textPath=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textProvider",{get:function(){return this._listBox.textProvider},set:function(n){this._listBox.textProvider=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stateProvider",{get:function(){return this._listBox.stateProvider},set:function(n){this._listBox.stateProvider=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"listBox",{get:function(){return this._listBox},enumerable:!1,configurable:!0}),t}(f.BaseElView);t.ListBoxElView=b;rt.registerElView("select",b)});define("jriapp_ui/content/lookup",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/listbox","jriapp_ui/content/basic"],function(n,t,i,r,u,f){"use strict";var h,c;Object.defineProperty(t,"__esModule",{value:!0});t.LookupContent=void 0;var e=i.Utils,l=r.DomUtils,a=l.document,v=e.check._undefined,y=e.str.format,p=e.core.getNewID,o=e.sys,s;(function(n){n.obj_created="object_created";n.obj_needed="object_needed"})(s||(s={}));h=function(){function n(n){this._content=n}return n.prototype.convertToSource=function(){return v},n.prototype.convertToTarget=function(n){return this._content.getLookupText(n)},n.prototype.toString=function(){return"LookupConverter"},n}();c=function(n){function t(t){var r=this;if(t.contentOptions.name!=="lookup")throw new Error(y(i.LocaleERRS.ERR_ASSERTION_FAILED,"contentOptions.name === 'lookup'"));return r=n.call(this,t)||this,r._converter=new h(r),r._listBox=null,r._isListBoxCachedExternally=!1,r._uniqueID=p("lkup"),!r.options.initContentFn||r.options.initContentFn(r),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._listBox||(this._listBox.objEvents.offNS(this.uniqueID),this._isListBoxCachedExternally||this._listBox.getIsStateDirty()||this._listBox.dispose(),this._listBox=null),this._converter=null,n.prototype.dispose.call(this))},t.prototype.getConverter=function(n){return n?null:this._converter},t.prototype.getListBox=function(){var t,i;if(!!this._listBox)return this._listBox;var u=this.options.options,r="listBox",n={objectKey:r,result:null};return(this.objEvents.raise("object_needed",n),!n.result||(this._isListBoxCachedExternally=!0,this._listBox=n.result),!!this._listBox)?(this._listBox.addOnRefreshed(this.onListRefreshed,this.uniqueID,this),this._listBox):(t=this.createListBox(u),i={objectKey:r,result:t,isCachedExternally:!1},this.objEvents.raise("object_created",i),this._isListBoxCachedExternally=i.isCachedExternally,this._listBox=t,this._listBox.addOnRefreshed(this.onListRefreshed,this.uniqueID,this),this._listBox)},t.prototype.onListRefreshed=function(){for(var n,r=this.lfScope.getObjs().filter(function(n){return o.isBinding(n)}).map(function(n){return n}),t=0,i=r;t<i.length;t++)n=i[t],n.targetPath.length>0&&n.targetPath[0]==="value"&&n.updateTarget()},t.prototype.createListBox=function(n){var t=a.createElement("select"),i={valuePath:n.valuePath,textPath:n.textPath,statePath:n.statePath?n.statePath:null,syncSetDatasource:!0,dataSource:o.resolvePath(this.app,n.dataSource)};return t.setAttribute("size","1"),new u.ListBoxElView(t,i)},t.prototype.cleanUp=function(){n.prototype.cleanUp.call(this);!!this._listBox&&this._isListBoxCachedExternally&&(this._listBox.objEvents.offNS(this.uniqueID),this._listBox=null)},t.prototype.bindToList=function(n){var t={target:n,source:this.dataContext,targetPath:"selectedValue",sourcePath:this.options.fieldName,isSourceFixed:!1,mode:2,converter:null,param:null,isBind:!1};return this.app.bind(t)},t.prototype.createdEditingView=function(){var n=this.getListBox();return this.lfScope.addObj(this.bindToList(n)),n},t.prototype.beforeCreateView=function(){return this.cleanUp(),!!this.options.fieldName},t.prototype.addOnObjectCreated=function(n,t){this.objEvents.on("object_created",n,t)},t.prototype.offOnObjectCreated=function(n){this.objEvents.off("object_created",n)},t.prototype.addOnObjectNeeded=function(n,t){this.objEvents.on("object_needed",n,t)},t.prototype.offOnObjectNeeded=function(n){this.objEvents.off("object_needed",n)},t.prototype.getLookupText=function(n){var t=this.getListBox();return t.getText(n)},t.prototype.toString=function(){return"LookupContent"},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),t}(f.BasicContent);t.LookupContent=c});define("jriapp_ui/content/factory",["require","exports","jriapp_shared","jriapp_ui/content/basic","jriapp_ui/content/template","jriapp_ui/content/string","jriapp_ui/content/multyline","jriapp_ui/content/bool","jriapp_ui/content/number","jriapp_ui/content/date","jriapp_ui/content/datetime","jriapp_ui/content/lookup","jriapp/bootstrapper"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function b(){v||(v=new w,a.bootstrapper.contentFactory.addFactory(function(){return v}))}Object.defineProperty(t,"__esModule",{value:!0});t.initContentFactory=void 0;var p=i.Utils,y=p.str.format,v,w=function(){function n(n){this._nextFactory=n}return n.prototype.getContentType=function(n){if(!!n.template)return u.TemplateContent;if(!n.fieldName)throw new Error(y(i.LocaleERRS.ERR_PARAM_INVALID,"options","fieldName"));if(n.name==="lookup")return l.LookupContent;var a=n.fieldInfo,t;switch(a.dataType){case 0:t=r.BasicContent;break;case 1:t=n.name==="multyline"?e.MultyLineContent:f.StringContent;break;case 2:t=o.BoolContent;break;case 3:t=s.NumberContent;break;case 4:case 5:t=s.NumberContent;break;case 6:case 8:t=c.DateTimeContent;break;case 7:t=n.name==="datepicker"?h.DateContent:c.DateTimeContent;break;case 9:case 10:t=r.BasicContent;break;default:throw new Error(y(i.LocaleERRS.ERR_FIELD_DATATYPE,a.dataType));}if(t)return t;if(this._nextFactory)return this._nextFactory.getContentType(n);throw new Error(i.LocaleERRS.ERR_BINDING_CONTENT_NOT_FOUND);},n.prototype.isExternallyCachable=function(n){return l.LookupContent===n?!0:this._nextFactory?this._nextFactory.isExternallyCachable(n):!1},n}();t.initContentFactory=b});define("jriapp_ui/utils/jquery",["require","exports","jriapp_shared"],function(n,t,i){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),t.JQueryUtils=t.$=void 0,!("jQuery"in window))throw new Error(i.LocaleERRS.ERR_APP_NEED_JQUERY);t.$=jQuery;var r=function(){function n(){}return n.dispose$Plugin=function(n,t){var i=n.data(t);!i||n[t]("destroy")},n.$=jQuery,n}();t.JQueryUtils=r});define("jriapp_ui/utils/tooltip",["require","exports","jriapp_ui/utils/jquery","jriapp/utils/dom"],function(n,t,i,r){"use strict";function o(){return new f}var u,e,f;Object.defineProperty(t,"__esModule",{value:!0});t.createToolTipSvc=t.css=void 0;u=r.DomUtils.window,function(n){n.toolTip="qtip-light";n.toolTipError="qtip-red"}(e=t.css||(t.css={}));t.createToolTipSvc=o;f=function(){function n(){}return n.prototype.addToolTip=function(n,t,r,f){var e=i.$(n),o={content:{text:t},style:{classes:!r?"qtip-light":"qtip-red"},position:{my:"top left",at:!f?"bottom right":f,viewport:i.$(u),adjust:{method:"flip",x:0,y:0}},hide:{event:"unfocus click mouseleave",leave:!0}};e.data("qtip")?t?e.qtip("option","content.text",t):e.qtip("destroy",!0):!t||e.qtip(o)},n}()});define("jriapp_ui/utils/datepicker",["require","exports","jriapp_shared","jriapp_ui/utils/jquery"],function(n,t,i,r){"use strict";function e(){return new f}var u,f;Object.defineProperty(t,"__esModule",{value:!0});t.createDatepickerSvc=void 0;u=i.LocaleERRS;t.createDatepickerSvc=e;f=function(n){function t(){var t=n.call(this)||this;if(t._dateFormat=null,t._datepickerRegion="",!r.$.datepicker)throw new Error(u.ERR_JQUERY_DATEPICKER_NOTFOUND);return t.dateFormat="dd.mm.yy",t}return __extends(t,n),t.prototype.toString=function(){return"Datepicker"},t.prototype.attachTo=function(n,t,i){var u=r.$(n);t?u.datepicker(t):u.datepicker();!i||u.datepicker("option","onSelect",function(n){i(n)})},t.prototype.detachFrom=function(n){r.JQueryUtils.dispose$Plugin(r.$(n),"datepicker")},t.prototype.parseDate=function(n){return this.datePickerFn.parseDate(this.dateFormat,n)},t.prototype.formatDate=function(n){return this.datePickerFn.formatDate(this.dateFormat,n)},Object.defineProperty(t.prototype,"dateFormat",{get:function(){if(this._dateFormat)return this._dateFormat;var n=this.datePickerFn.regional[this._datepickerRegion];return n.dateFormat},set:function(n){if(this.dateFormat!==n){this._dateFormat=n;var t=this.datePickerFn.regional[this._datepickerRegion];!this._dateFormat||(t.dateFormat=this._dateFormat,this.datePickerFn.setDefaults(t));this.objEvents.raiseProp("dateFormat")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datepickerRegion",{get:function(){return this._datepickerRegion},set:function(n){var i,t;n||(n="");i=this.dateFormat;this._datepickerRegion!==n&&(t=this.datePickerFn.regional[n],!t||(this._datepickerRegion=n,t.dateFormat=i,this.datePickerFn.setDefaults(t),this.objEvents.raiseProp("datepickerRegion")))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"datePickerFn",{get:function(){return r.$.datepicker},enumerable:!1,configurable:!0}),t}(i.BaseObject)});define("jriapp_ui/utils/errors",["require","exports","jriapp_shared","jriapp/bootstrapper","jriapp/utils/dom"],function(n,t,i,r,u){"use strict";function e(n,t,i,r){var u=a.getSvc("ITooltipService");u.addToolTip(n,t,i,r)}function v(n){for(var s,t,r,f,h,e=["<b>",i.LocaleSTRS.VALIDATE.errorInfo,"<\/b>","<br/>"],u=0,o=n;u<o.length;u++){for(s=o[u],t="",r=0,f=s.errors;r<f.length;r++)h=f[r],t=t+" "+h;e.push(t);t=""}return e.join("")}function y(n){for(var r,e,o,u=["<b>",i.LocaleSTRS.VALIDATE.errorInfo,"<\/b>","<ul>"],f=0,s=n;f<s.length;f++){var h=s[f],c=h.fieldName,t="";for(!c||(t=i.LocaleSTRS.VALIDATE.errorField+" "+c),r=0,e=h.errors;r<e.length;r++)o=e[r],t=t?t+" -> "+o:o;u.push("<li>"+t+"<\/li>");t=""}return u.push("<\/ul>"),u.join("")}function s(n,t){f.setClass([n],"ria-field-error",!t)}function h(n){s(n,!0)}function c(n){s(n,!1)}function p(){return new l}var l;Object.defineProperty(t,"__esModule",{value:!0});t.createUIErrorsSvc=void 0;var a=r.bootstrapper,f=u.DomUtils,o=i.createWeakMap();l=function(){function n(){}return n.prototype.setErrors=function(n,t,i){!!t&&t.length>0?(e(n,v(t),!0),h(n)):(e(n,i),c(n))},n.prototype.setFormErrors=function(n,t){var i=o.get(n);!!t&&t.length>0?(i||(i=f.fromHTML('<div data-name="error_info" class="ria-form-error" />')[0],f.prepend(n,i),o.set(n,i)),e(i,y(t),!0),h(n)):(!i||(e(i,null),o.delete(n),f.removeNode(i)),c(n))},n}();t.createUIErrorsSvc=p});define("jriapp_ui/dialog",["require","exports","jriapp_shared","jriapp_ui/utils/jquery","jriapp/utils/dom","jriapp/template","jriapp/bootstrapper","jriapp/mvvm"],function(n,t,i,r,u,f,e,o){"use strict";var k,v,y,d;Object.defineProperty(t,"__esModule",{value:!0});t.DialogVM=t.DataEditDialog=t.DIALOG_ACTION=void 0;var s=i.Utils,p=s.check,g=p._undefined,w=p.isFunc,nt=s.str.format,c=s.core,tt=c.extend,it=c.getNewID,h=c.Indexer,l=s.sys,rt=s.async,ut=u.DomUtils,ft=ut.document,a=s.err,b=e.bootstrapper,et;(function(n){n[n.Default=0]="Default";n[n.StayOpen=1]="StayOpen"})(et=t.DIALOG_ACTION||(t.DIALOG_ACTION={})),function(n){n.close="close";n.refresh="refresh"}(k||(k={}));v=function(){function n(n){this._dataContext=n;this._submitError=!1;this._editable=l.getEditable(this._dataContext)}return n.prototype.submit=function(){var i=this,n=l.getSubmittable(this._dataContext),t;return!n||!n.isCanSubmit?rt.resolve():(t=n.submitChanges(),t.then(function(){i._submitError=!1}).catch(function(){i._submitError=!0}),t)},n.prototype.reject=function(){var n=l.getSubmittable(this._dataContext);!n||n.rejectChanges();this._submitError=!1},n.prototype.cancel=function(){!this._editable||this._editable.cancelEdit();!this._submitError||this.reject()},n.prototype.endEdit=function(){return!!this._editable&&this._editable.isEditing?this._editable.endEdit():!0},n.prototype.beginEdit=function(){return!this._editable?!1:this._editable.isEditing||this._editable.beginEdit()},Object.defineProperty(n.prototype,"dataContext",{get:function(){return this._dataContext},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"submitError",{get:function(){return this._submitError},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"editable",{get:function(){return this._editable},enumerable:!1,configurable:!0}),n}();y=function(n){function t(t){var i=n.call(this)||this,r=i;return t=tt({dataContext:null,templateID:null,width:500,height:350,title:"Data edit dialog",submitOnOK:!1,canRefresh:!1,canCancel:!0,fn_OnClose:null,fn_OnOK:null,fn_OnShow:null,fn_OnOpen:null,fn_OnCancel:null,fn_OnTemplateCreated:null,fn_OnTemplateDestroy:null},t),i._uniqueID=it("dlg"),i._dataContext=t.dataContext,i._templateID=t.templateID,i._submitOnOK=t.submitOnOK,i._canRefresh=t.canRefresh,i._canCancel=t.canCancel,i._fnOnClose=t.fn_OnClose,i._fnOnOK=t.fn_OnOK,i._fnOnShow=t.fn_OnShow,i._fnOnOpen=t.fn_OnOpen,i._fnOnCancel=t.fn_OnCancel,i._fnOnTemplateCreated=t.fn_OnTemplateCreated,i._fnOnTemplateDestroy=t.fn_OnTemplateDestroy,i._template=null,i._$dlgEl=null,i._result=null,i._selectedControl=null,i._submitInfo=null,i._options={width:t.width,height:t.height,title:t.title,autoOpen:!1,modal:!0,open:function(){r._onOpen()},close:function(){r._onClose()},buttons:r._getButtons()},i._deferredTemplate=s.async.createDeferred(),i._createDialog(),i}return __extends(t,n),t.prototype.addOnClose=function(n,t,i){this.objEvents.on("close",n,t,i)},t.prototype.offOnClose=function(n){this.objEvents.off("close",n)},t.prototype.addOnRefresh=function(n,t,i){this.objEvents.on("refresh",n,t,i)},t.prototype.offOnRefresh=function(n){this.objEvents.off("refresh",n)},t.prototype._createDialog=function(){try{this._template=this._createTemplate();this._$dlgEl=r.$(this._template.el);ft.body.appendChild(this._template.el);this._$dlgEl.dialog(this._options)}catch(n){a.reThrow(n,this.handleError(n,this))}},t.prototype.templateLoading=function(){},t.prototype.templateLoaded=function(n,t){if(this.getIsStateDirty()||!!t){!this._deferredTemplate||this._deferredTemplate.reject(t);return}!this._fnOnTemplateCreated||this._fnOnTemplateCreated(n);this._deferredTemplate.resolve(n)},t.prototype.templateUnLoading=function(n){!this._fnOnTemplateDestroy||this._fnOnTemplateDestroy(n)},t.prototype._createTemplate=function(){var n=f.createTemplate({parentEl:null,templEvents:this});return n.templateID=this._templateID,n},t.prototype._destroyTemplate=function(){!this._template||this._template.dispose()},t.prototype._getButtons=function(){var n=this,t=[{id:n._uniqueID+"_Refresh",text:i.LocaleSTRS.TEXT.txtRefresh,icon:"fas fa-retweet","class":"btn btn-info btn-sm",click:function(){n._onRefresh()}},{id:n._uniqueID+"_Ok",text:i.LocaleSTRS.TEXT.txtOk,icon:"fas fa-check","class":"btn btn-info btn-sm",click:function(){n._onOk()}},{id:n._uniqueID+"_Cancel",text:i.LocaleSTRS.TEXT.txtCancel,icon:"fas fa-times","class":"btn btn-info btn-sm",click:function(){n._onCancel()}}];return this.canRefresh||t.shift(),this.canCancel||t.pop(),t},t.prototype._getOkButton=function(){return r.$("#"+this._uniqueID+"_Ok")},t.prototype._getCancelButton=function(){return r.$("#"+this._uniqueID+"_Cancel")},t.prototype._getRefreshButton=function(){return r.$("#"+this._uniqueID+"_Refresh")},t.prototype._getAllButtons=function(){return[this._getOkButton(),this._getCancelButton(),this._getRefreshButton()]},t.prototype._updateStyles=function(){var n=this._getAllButtons();n.forEach(function(n){n.removeClass("ui-button");n.find("span.ui-button-icon").removeClass("ui-button-icon ui-icon")})},t.prototype._disableButtons=function(n){var t=this._getAllButtons();t.forEach(function(t){t.prop("disabled",!!n)})},t.prototype._onOk=function(){var n=this,f=!this._fnOnOK?0:this._fnOnOK(this),r,u,t;if(f!==1){if(!this._dataContext){n.hide();return}(r=this._submitInfo.endEdit(),r)&&(this._submitOnOK?(this._disableButtons(!0),u=this.title,this.title=i.LocaleSTRS.TEXT.txtSubmitting,t=this._submitInfo.submit(),t.finally(function(){n._disableButtons(!1);n.title=u}),t.then(function(){n._result="ok";n.hide()}).catch(function(){n._submitInfo.beginEdit()||(n._result="cancel",n.hide())})):(n._result="ok",n.hide()))}},t.prototype._onCancel=function(){var n=!this._fnOnCancel?0:this._fnOnCancel(this);n!==1&&(this._submitInfo.cancel(),this._result="cancel",this.hide())},t.prototype._onRefresh=function(){var t={isHandled:!1},n;(this.objEvents.raise("refresh",t),t.isHandled)||(n=this._dataContext,!n||(w(n.refresh)?n.refresh():!!n._aspect&&w(n._aspect.refresh)&&n._aspect.refresh()))},t.prototype._onOpen=function(){!this._fnOnOpen||this._fnOnOpen(this)},t.prototype._onClose=function(){try{this._result==="ok"||!this._submitInfo||this._submitInfo.cancel();!this._fnOnClose||this._fnOnClose(this);this.objEvents.raise("close",{})}finally{this._template.dataContext=null;this._submitInfo=null}var n=this._selectedControl;this._selectedControl=null;s.queue.enque(function(){b.selectedControl=n;n=null})},t.prototype._onShow=function(){this._selectedControl=b.selectedControl;this._submitInfo=new v(this.dataContext);this._updateStyles();!this._fnOnShow||this._fnOnShow(this)},t.prototype.show=function(){var n=this;return n.getIsStateDirty()?s.async.createDeferred().reject():(n._result=null,this._deferredTemplate.promise().then(function(t){(n.getIsStateDirty()||!n._$dlgEl)&&a.abort();n._$dlgEl.dialog("option","buttons",n._getButtons());t.dataContext=n._dataContext;n._onShow();n._$dlgEl.dialog("open")}).then(function(){return n},function(t){return n.getIsStateDirty()||n.handleError(t,n),a.abort()}))},t.prototype.hide=function(){var n=this;this._$dlgEl&&n._$dlgEl.dialog("close")},t.prototype.getOption=function(n){return this._$dlgEl?this._$dlgEl.dialog("option",n):g},t.prototype.setOption=function(n,t){var i=this;i._$dlgEl.dialog("option",n,t)},t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this.hide(),this._destroyTemplate(),this._$dlgEl=null,this._template=null,this._dataContext=null,this._submitInfo=null,n.prototype.dispose.call(this))},Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){n!==this._dataContext&&(this._dataContext=n,this._submitInfo=new v(this._dataContext),this.objEvents.raiseProp("dataContext"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"result",{get:function(){return this._result},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubmitOnOK",{get:function(){return this._submitOnOK},set:function(n){this._submitOnOK!==n&&(this._submitOnOK=n,this.objEvents.raiseProp("isSubmitOnOK"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.getOption("width")},set:function(n){var t=this.getOption("width");n!==t&&(this.setOption("width",n),this.objEvents.raiseProp("width"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getOption("height")},set:function(n){var t=this.getOption("height");n!==t&&(this.setOption("height",n),this.objEvents.raiseProp("height"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getOption("title")},set:function(n){var t=this.getOption("title");n!==t&&(this.setOption("title",n),this.objEvents.raiseProp("title"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canRefresh",{get:function(){return this._canRefresh},set:function(n){var t=this._canRefresh;n!==t&&(this._canRefresh=n,this.objEvents.raiseProp("canRefresh"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canCancel",{get:function(){return this._canCancel},set:function(n){var t=this._canCancel;n!==t&&(this._canCancel=n,this.objEvents.raiseProp("canCancel"))},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DataEditDialog=y;d=function(n){function t(t){var i=n.call(this,t)||this;return i._factories=h(),i._dialogs=h(),i}return __extends(t,n),t.prototype.createDialog=function(n,t){var i=this;return this._factories[n]=function(){var r=i._dialogs[n];return r||(r=new y(t),i._dialogs[n]=r),r},this._factories[n]},t.prototype.showDialog=function(n,t){var i=this.getDialog(n);if(!i)throw new Error(nt("Invalid DataEditDialog name:  {0}",n));return i.dataContext=t,setTimeout(function(){i.show()},0),i},t.prototype.getDialog=function(n){var t=this._factories[n];return t?t():null},t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();for(var t in this._dialogs)this._dialogs[t].dispose();this._factories=h();this._dialogs=h();n.prototype.dispose.call(this)}},t}(o.ViewModel);t.DialogVM=d});define("jriapp_ui/dynacontent",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/template","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DynaContentElView=void 0;var o=i.Utils,h=o.sys,c=r.DomUtils,s=function(n){function t(t,r){var u=n.call(this,t,r)||this;return u._dataContext=null,u._prevTemplateID=null,u._templateID=null,u._template=null,u._animation=null,u._tDebounce=new i.Debounce,u._dsDebounce=new i.Debounce,u}return __extends(t,n),t.prototype.templateLoading=function(n){if(!this.getIsStateDirty()){var t=!this._prevTemplateID,i=!!this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!t);i&&this._animation.beforeShow(n,t)}},t.prototype.templateLoaded=function(n){if(!this.getIsStateDirty()){c.isContained(n.el,this.el)||this.el.appendChild(n.el);var t=!this._prevTemplateID,i=!!this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!t);i&&this._animation.show(n,t)}},t.prototype.templateUnLoading=function(){},t.prototype._templateChanging=function(n,t){var i=this;try{if(!t&&!!i._template){!!i._animation&&i._template.isLoaded?(i._animation.stop(),i._animation.beforeHide(i._template),i._animation.hide(i._template).finally(function(){i.getIsStateDirty()||(i._template.dispose(),i._template=null,i.objEvents.raiseProp("template"))})):(i._template.dispose(),i._template=null,i.objEvents.raiseProp("template"));return}if(!i._template){i._template=u.createTemplate({parentEl:null,dataContext:i._dataContext,templEvents:i});i._template.templateID=t;i.objEvents.raiseProp("template");return}!!i._animation&&i._template.isLoaded?(i._animation.stop(),i._animation.beforeHide(i._template),i._animation.hide(i._template).finally(function(){i.getIsStateDirty()||(i._template.templateID=t)})):i._template.templateID=t}catch(r){o.err.reThrow(r,i.handleError(r,i))}},t.prototype.dispose=function(){var t,i;this.getIsDisposed()||(this.setDisposing(),this._tDebounce.dispose(),this._dsDebounce.dispose(),t=this._animation,this._animation=null,i=this._template,this._template=null,h.isBaseObj(t)&&t.dispose(),!i||i.dispose(),this._dataContext=null,n.prototype.dispose.call(this))},Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templateID",{get:function(){return this._templateID},set:function(n){var i=this,t=i._templateID;t!==n&&(this._prevTemplateID=t,this._templateID=n,this._tDebounce.enque(function(){i._templateChanging(t,n)}),this.objEvents.raiseProp("templateID"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){var t=this;this._dataContext!==n&&(this._dataContext=n,this._dsDebounce.enque(function(){var n=t._dataContext;!t._template||(t._template.dataContext=n)}),this.objEvents.raiseProp("dataContext"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._animation},set:function(n){this._animation!==n&&(this._animation=n,this.objEvents.raiseProp("animation"))},enumerable:!1,configurable:!0}),t}(e.BaseElView);t.DynaContentElView=s;f.bootstrapper.registerElView("dynacontent",s)});define("jriapp_ui/content/int",["require","exports","jriapp_shared","jriapp/utils/parser"],function(n,t,i,r){"use strict";function s(n){var i={name:null,readOnly:!1,initContentFn:null,fieldInfo:null,css:null,template:null,fieldName:null,options:null},r=o.parseOptions(n),t;return r?(t=r,t.template||!t.fieldName?!t.template||(i.template=t.template,i.css=t.css,t.readOnly!==e&&(i.readOnly=f(t.readOnly))):(i.css=t.css,i.fieldName=t.fieldName,!t.name||(i.name=t.name),!t.options||(i.options=t.options),t.readOnly!==e&&(i.readOnly=f(t.readOnly))),i):i}Object.defineProperty(t,"__esModule",{value:!0});t.parseContentAttr=void 0;var u=i.Utils,f=u.core.parseBool,e=u.check._undefined,o=r.Parser;t.parseContentAttr=s});define("jriapp_ui/datagrid/consts",["require","exports"],function(n,t){"use strict";var i,r,u,f,e;Object.defineProperty(t,"__esModule",{value:!0});t.PROP_NAME=t.txtMap=t.css=t.ROW_ACTION=t.ROW_POSITION=t.COLUMN_TYPE=void 0,function(n){n.DATA="data";n.ROW_EXPANDER="row_expander";n.ROW_ACTIONS="row_actions";n.ROW_SELECTOR="row_selector"}(i=t.COLUMN_TYPE||(t.COLUMN_TYPE={})),function(n){n[n.Up=0]="Up";n[n.Bottom=1]="Bottom";n[n.Details=2]="Details"}(r=t.ROW_POSITION||(t.ROW_POSITION={})),function(n){n[n.OK=0]="OK";n[n.EDIT=1]="EDIT";n[n.CANCEL=2]="CANCEL";n[n.DELETE=3]="DELETE"}(u=t.ROW_ACTION||(t.ROW_ACTION={})),function(n){n.container="ria-table-container";n.dataTable="ria-data-table";n.columnInfo="ria-col-info";n.column="ria-col-ex";n.headerDiv="ria-table-header";n.wrapDiv="ria-table-wrap";n.dataColumn="ria-data-column";n.dataCell="ria-data-cell";n.rowCollapsed="ria-row-collapsed";n.rowExpanded="ria-row-expanded";n.rowExpander="ria-row-expander";n.columnSelected="ria-col-selected";n.rowActions="ria-row-actions";n.rowDetails="ria-row-details";n.rowSelector="ria-row-selector";n.rowHighlight="ria-row-highlight";n.rowDeleted="ria-row-deleted";n.rowError="ria-row-error";n.fillVSpace="ria-fill-vspace";n.nobr="ria-nobr";n.colSortable="ria-sortable";n.colSortAsc="ria-sort-asc";n.colSortDesc="ria-sort-desc"}(f=t.css||(t.css={}));t.txtMap={img_ok:"txtOk",img_cancel:"txtCancel",img_edit:"txtEdit",img_delete:"txtDelete"},function(n){n.isCurrent="isCurrent";n.isSelected="isSelected";n.sortOrder="sortOrder";n.checked="checked";n.editingRow="editingRow";n.dataSource="dataSource";n.currentRow="currentRow";n.grid="grid";n.animation="animation";n.stateProvider="stateProvider"}(e=t.PROP_NAME||(t.PROP_NAME={}))});define("jriapp_ui/datagrid/animation",["require","exports","jriapp_shared","jriapp_ui/utils/jquery"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DefaultAnimation=void 0;var u=function(n){function t(){var t=n.call(this)||this;return t._$el=null,t}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();try{this.stop()}finally{n.prototype.dispose.call(this)}}},t.prototype.beforeShow=function(n){this.stop();this._$el=r.$(n);this._$el.hide()},t.prototype.show=function(n){this._$el.slideDown(400,n)},t.prototype.beforeHide=function(n){this.stop();this._$el=r.$(n)},t.prototype.hide=function(n){this._$el.slideUp(400,n)},t.prototype.stop=function(){!this._$el||(this._$el.finish(),this._$el=null)},t}(i.BaseObject);t.DefaultAnimation=u});define("jriapp_ui/utils/dblclick",["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DblClick=void 0;var i=function(){function n(n){n===void 0&&(n=0);this._isDisposed=!1;this._timer=null;this._interval=n?n:0;this._fnOnClick=null;this._fnOnDblClick=null}return n.prototype.click=function(){var n=this;this._timer?(clearTimeout(this._timer),this._timer=null,this._fnOnDblClick?this._fnOnDblClick():!this._fnOnClick||this._fnOnClick()):!this._fnOnClick||(this._timer=setTimeout(function(){n._timer=null;!n._fnOnClick||n._fnOnClick()},n._interval))},n.prototype.add=function(n,t){this.getIsDisposed()||(this._fnOnClick=n,this._fnOnDblClick=t)},n.prototype.dispose=function(){this.getIsDisposed()||(this._isDisposed=!0,clearTimeout(this._timer),this._timer=null,this._fnOnClick=null,this._fnOnDblClick=null)},n.prototype.getIsDisposed=function(){return this._isDisposed},Object.defineProperty(n.prototype,"interval",{get:function(){return this._interval},set:function(n){this._interval=n},enumerable:!1,configurable:!0}),n}();t.DblClick=i});define("jriapp_ui/datagrid/columns/base",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/template","jriapp_ui/baseview","jriapp/bootstrapper"],function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseColumn=void 0;var s=i.Utils,o=r.DomUtils,h=o.document,c=s.core.getNewID,l=function(n){function t(t,i){var r=n.call(this)||this,l=r,s;r._grid=t;r._th=i.th;r._options=i.colInfo;r._isSelected=!1;r._uniqueID=c("th");s=h.createElement("div");r._col=s;o.addClass([s],"ria-col-ex");!r._options.colCellCss||o.addClass([s],r._options.colCellCss);r._grid._getInternal().getHeader().appendChild(s);e.selectableProviderWeakMap.set(r._col,r._grid);o.events.on(r._col,"click",function(){t._getInternal().setCurrentColumn(l);l._onColumnClicked()},r.uniqueID);return!r._options.width||(r._th.style.width=r._options.width),r._options.templateID?(r._template=u.createTemplate({parentEl:s,templEvents:r}),r._template.templateID=r._options.templateID):!r._options.title||(s.innerHTML=r._options.title),!r._options.tip||f.addToolTip(s,r._options.tip,!1,"bottom center"),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),e.selectableProviderWeakMap.delete(this._col),o.events.offNS(this.grid.table,this.uniqueID),!this._options.tip||f.addToolTip(this._col,null),!this._template||(this._template.dispose(),this._template=null),o.events.offNS(this._col,this.uniqueID),this._col=null,this._th=null,this._grid=null,this._options=null,n.prototype.dispose.call(this))},t.prototype.templateLoading=function(){},t.prototype.templateLoaded=function(){},t.prototype.templateUnLoading=function(){},t.prototype.scrollIntoView=function(n){this.getIsStateDirty()||this._col.scrollIntoView(!!n)},t.prototype.updateWidth=function(){this._col.style.width=this._th.offsetWidth+"px"},t.prototype._onColumnClicked=function(){},t.prototype.toString=function(){return"BaseColumn"},Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._th.offsetWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"th",{get:function(){return this._th},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._options.title},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(n){!this._col||this._isSelected===n||(this._isSelected=n,o.setClass([this._col],"ria-col-selected",!this._isSelected))},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.BaseColumn=l});define("jriapp_ui/datagrid/columns/expander",["require","exports","jriapp/utils/dom","jriapp_ui/datagrid/columns/base"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExpanderColumn=void 0;var u=i.DomUtils,f=function(n){function t(t,i){var r=n.call(this,t,i)||this;return u.addClass([r.col],"ria-row-expander"),r}return __extends(t,n),t.prototype.toString=function(){return"ExpanderColumn"},t}(r.BaseColumn);t.ExpanderColumn=f});define("jriapp_ui/datagrid/cells/expander",["require","exports","jriapp/utils/dom","jriapp_ui/datagrid/cells/base"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExpanderCell=void 0;var u=i.DomUtils,f=function(n){function t(t){var i=n.call(this,t)||this,r=i;return i._click.add(function(){r._onCellClicked(r.row)}),u.addClass([i.td],"ria-row-collapsed"),u.addClass([i.td],"ria-row-expander"),i}return __extends(t,n),t.prototype._onCellClicked=function(t){var i=t||this.row;i&&(n.prototype._onCellClicked.call(this,i),i.isExpanded=!i.isExpanded)},t.prototype.toggleImage=function(){this.row.isExpanded?(u.removeClass([this.td],"ria-row-collapsed"),u.addClass([this.td],"ria-row-expanded")):(u.removeClass([this.td],"ria-row-expanded"),u.addClass([this.td],"ria-row-collapsed"))},t.prototype.toString=function(){return"ExpanderCell"},t}(r.BaseCell);t.ExpanderCell=f});define("jriapp_ui/datagrid/columns/data",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/datagrid/columns/base"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataColumn=void 0;var e=i.Utils,o=e.core,c=o.Indexer,l=o.forEach,s=r.DomUtils,h=u.bootstrapper,a=function(n){function t(t,i){var r=n.call(this,t,i)||this,u;return r._objCache=c(),r._contentType=null,u="ria-data-column",r._sortOrder=null,r.isSortable&&(u+=" ria-sortable"),s.addClass([r.col],u),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this;this._contentType=null;l(t._objCache,function(n){t._objCache[n].dispose()});t._objCache=null;n.prototype.dispose.call(this)}},t.prototype._onColumnClicked=function(){if(this.isSortable&&!!this.sortMemberName){var n=this._sortOrder;this.grid._getInternal().resetColumnsSort();this.sortOrder=n===0?1:0;this.grid.sortByColumn(this)}},t.prototype._cacheObject=function(n,t){this._objCache[n]=t},t.prototype._getCachedObject=function(n){return this._objCache[n]},t.prototype._getInitContentFn=function(){var n=this;return function(t){t.addOnObjectCreated(function(t,i){n._cacheObject(i.objectKey,i.result);i.isCachedExternally=!!n._getCachedObject(i.objectKey)});t.addOnObjectNeeded(function(t,i){i.result=n._getCachedObject(i.objectKey)})}},t.prototype.updateContentOptions=function(){var n=this.options.content;if(!!n.fieldName&&(n.fieldInfo=this.grid.dataSource.getFieldInfo(n.fieldName),!n.fieldInfo))throw new Error(e.str.format(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,"",n.fieldName));this._contentType=h.contentFactory.getContentType(n);h.contentFactory.isExternallyCachable(this._contentType)&&(n.initContentFn=this._getInitContentFn());this.grid.isHasEditor&&(n.readOnly=!0)},t.prototype.toString=function(){return"DataColumn"},Object.defineProperty(t.prototype,"contentType",{get:function(){return this._contentType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSortable",{get:function(){return!!this.options.sortable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortMemberName",{get:function(){return this.options.sortMemberName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortOrder",{get:function(){return this._sortOrder},set:function(n){if(this._sortOrder!==n){this._sortOrder=n;var t=[(n===0?"+":"-")+"ria-sort-asc",(n===1?"+":"-")+"ria-sort-desc"];s.setClasses([this.col],t);this.objEvents.raiseProp("sortOrder")}},enumerable:!1,configurable:!0}),t}(f.BaseColumn);t.DataColumn=a});define("jriapp_ui/datagrid/cells/data",["require","exports","jriapp/utils/dom","jriapp_ui/datagrid/cells/base"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataCell=void 0;var u=i.DomUtils,f=function(n){function t(t){var i=n.call(this,t)||this,r=i;return i._content=null,i._click.interval=350,i._click.add(function(){r._onCellClicked(r.row)},function(){r._onDblClicked(r.row)}),u.addClass([i.td],"ria-data-cell"),i._initContent(),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._content||(this._content.dispose(),this._content=null),n.prototype.dispose.call(this))},t.prototype._initContent=function(){var n=this.column.contentType;this._content=new n({parentEl:this.td,contentOptions:this.column.options.content,dataContext:this.item,isEditing:this.item._aspect.isEditing});this._content.render()},t.prototype._beginEdit=function(){this._content.isEditing||(this._content.isEditing=!0)},t.prototype._endEdit=function(){this._content.isEditing&&(this._content.isEditing=!1)},t.prototype.toString=function(){return"DataCell"},t}(r.BaseCell);t.DataCell=f});define("jriapp_ui/datagrid/columns/actions",["require","exports","jriapp/utils/dom","jriapp_ui/datagrid/columns/base"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActionsColumn=void 0;var u=i.DomUtils,f=function(n){function t(t,i){var f=n.call(this,t,i)||this,r=f;u.addClass([f.col],"ria-row-actions");u.events.on(f.grid.table,"click",function(n){var i=n.target,f=i.getAttribute("data-name"),t=u.getData(i,"cell");r.grid.currentRow=t.row;switch(f){case"img_ok":r._onOk(t);break;case"img_cancel":r._onCancel(t);break;case"img_edit":r._onEdit(t);break;case"img_delete":r._onDelete(t)}},{nmspace:f.uniqueID,matchElement:function(n){var t=n.getAttribute("data-scope"),i=n.tagName.toLowerCase();return r.uniqueID===t&&i==="span"}});return f.grid.addOnRowAction(function(n,t){switch(t.action){case 0:r._onOk(t.row.actionsCell);break;case 1:r._onEdit(t.row.actionsCell);break;case 2:r._onCancel(t.row.actionsCell);break;case 3:r._onDelete(t.row.actionsCell)}},f.uniqueID),f}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),u.events.offNS(this.grid.table,this.uniqueID),this.grid.objEvents.offNS(this.uniqueID),n.prototype.dispose.call(this))},t.prototype._onOk=function(n){n.row&&(n.row.endEdit(),n.update())},t.prototype._onCancel=function(n){n.row&&(n.row.cancelEdit(),n.update())},t.prototype._onDelete=function(n){n.row&&n.row.deleteRow()},t.prototype._onEdit=function(n){n.row&&(n.row.beginEdit(),n.update(),this.grid.showEditDialog())},t.prototype.toString=function(){return"ActionsColumn"},t}(r.BaseColumn);t.ActionsColumn=f});define("jriapp_ui/datagrid/cells/actions",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/int","jriapp_ui/baseview","jriapp_ui/datagrid/consts","jriapp_ui/datagrid/cells/base"],function(n,t,i,r,u,f,e,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ActionsCell=t.deleteName=t.editName=void 0;var a=i.Utils,s=r.DomUtils,l=a.str.format;t.editName="img_edit";t.deleteName="img_delete";var v='span[data-role="row-action"]',y=['<span data-role="row-action" data-name="img_ok" class="{0}"><\/span>','<span data-role="row-action" data-name="img_cancel" class="{1}"><\/span>'],p=['<span data-role="row-action" data-name="img_edit" class="{0}"><\/span>','<span data-role="row-action" data-name="img_delete" class="{1}"><\/span>'],h=null,c=null,w=function(n){function t(t){var i=n.call(this,t)||this;return i._isEditing=!1,s.addClass([i.td],"ria-row-actions ria-nobr"),i._createButtons(i.row.isEditing),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._cleanUp(this.td),n.prototype.dispose.call(this))},t.prototype._setupButtons=function(n){for(var t,h,r=this,c=r.grid.options.isActionsToolTips,u=0,o=n;u<o.length;u++)t=o[u],s.setData(t,"cell",r),h=t.getAttribute("data-name"),c&&f.addToolTip(t,i.LocaleSTRS.TEXT[e.txtMap[h]]),t.setAttribute("data-scope",r.column.uniqueID)},t.prototype._cleanUp=function(n){for(var i,u=this,e=s.queryAll(n,v),o=u.grid.options.isActionsToolTips,t=0,r=e;t<r.length;t++)i=r[t],s.removeData(i),o&&f.addToolTip(i,null)},Object.defineProperty(t.prototype,"editBtnsHTML",{get:function(){return h||(h=y.map(function(n){return l(n,u.ButtonCss.OK,u.ButtonCss.Cancel)})),h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewBtnsHTML",{get:function(){return c||(c=p.map(function(n){return l(n,u.ButtonCss.Edit,u.ButtonCss.Delete)})),c},enumerable:!1,configurable:!0}),t.prototype._createButtons=function(n){var t=this,r=this.td,i;this._cleanUp(r);r.innerHTML="";n?(t._isEditing=!0,i=t.editBtnsHTML.map(function(n){return s.fromHTML(n)}).map(function(n){return n[0]})):(t._isEditing=!1,i=t.viewBtnsHTML.map(function(n,i){return t.isCanEdit||i!==0?t.isCanDelete||i!==1?s.fromHTML(n):null:null}).filter(function(n){return!!n}).map(function(n){return n[0]}));t._setupButtons(i);s.append(r,i)},t.prototype.update=function(){this.getIsStateDirty()||this._isEditing===this.row.isEditing||this._createButtons(this.row.isEditing)},t.prototype.toString=function(){return"ActionsCell"},Object.defineProperty(t.prototype,"isCanEdit",{get:function(){return this.grid.isCanEdit},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanDelete",{get:function(){return this.grid.isCanDelete},enumerable:!1,configurable:!0}),t}(o.BaseCell);t.ActionsCell=w});define("jriapp_ui/datagrid/columns/rowselector",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/datagrid/columns/base"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RowSelectorColumn=void 0;var o=i.Utils,f=r.DomUtils,e=f.document,s=o.check._undefined,h=function(n){function t(t,i){var r=n.call(this,t,i)||this,s=r,o,u;f.addClass([r.col],"ria-row-selector");o=e.createElement("label");u=e.createElement("input");u.type="checkbox";u.checked=!1;u.className="ria-row-selector";o.className="ria-row-selector";o.appendChild(u);o.appendChild(e.createElement("span"));r.col.appendChild(o);r._chk=u;f.events.on(u,"change",function(n){n.stopPropagation();s.objEvents.raiseProp("checked");s.grid.selectRows(u.checked)},r.uniqueID);f.events.on(r.grid.table,"click",function(n){var i=n.target,t=f.getData(i,"cell");!t||t.getIsStateDirty()||t.isDisabled||(t.row.isSelected=t.checked)},{nmspace:r.uniqueID,matchElement:function(n){var t=n.getAttribute("data-scope"),i=n.tagName.toLowerCase();return s.uniqueID===t&&i==="input"}});return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),f.events.offNS(this._chk,this.uniqueID),f.events.offNS(this.grid.table,this.uniqueID),n.prototype.dispose.call(this))},t.prototype.toString=function(){return"RowSelectorColumn"},Object.defineProperty(t.prototype,"checked",{get:function(){return!this._chk?s:this._chk.checked},set:function(n){var t=!!n,i=this._chk;t!==i.checked&&(i.checked=t,this.objEvents.raiseProp("checked"))},enumerable:!1,configurable:!0}),t}(u.BaseColumn);t.RowSelectorColumn=h});define("jriapp_ui/datagrid/cells/rowselector",["require","exports","jriapp/utils/dom","jriapp_ui/datagrid/cells/base"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RowSelectorCell=void 0;var u=i.DomUtils,f=u.document,e=function(n){function t(t){var r=n.call(this,t)||this,e,i;return u.addClass([r.td],"ria-row-selector"),e=f.createElement("label"),i=f.createElement("input"),i.type="checkbox",i.checked=!1,i.className="ria-row-selector",e.className="ria-row-selector",i.setAttribute("data-scope",r.column.uniqueID),e.appendChild(i),e.appendChild(f.createElement("span")),r.td.appendChild(e),r._chk=i,u.setData(i,"cell",r),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),u.removeData(this._chk),n.prototype.dispose.call(this))},Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this._chk.disabled},set:function(n){var t=this._chk;n!==t.disabled&&(t.disabled=n,n&&(this.checked=!1),this.objEvents.raiseProp("isDisabled"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"checked",{get:function(){return this._chk.checked},set:function(n){var t=!!n;this.isDisabled||t===this._chk.checked||(this._chk.checked=t)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"RowSelectorCell"},t}(r.BaseCell);t.RowSelectorCell=e});define("jriapp_ui/datagrid/rows/row",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/datagrid/cells/expander","jriapp_ui/datagrid/cells/data","jriapp_ui/datagrid/cells/actions","jriapp_ui/datagrid/cells/rowselector","jriapp_ui/datagrid/columns/expander","jriapp_ui/datagrid/columns/actions","jriapp_ui/datagrid/columns/rowselector"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function a(n){var t=n.grid.options.rowStateField,i=!n.item||!t?null:w.resolvePath(n.item,t),r=n.grid._getInternal().onRowStateChanged(n,i);n._setState(r)}var y;Object.defineProperty(t,"__esModule",{value:!0});t.Row=void 0;var v=i.Utils,l=r.DomUtils,p=l.document,w=v.sys,b=v.core.getNewID;y=function(n){function t(t,i){var r=n.call(this)||this,u=i.item;return r._grid=t,r._tr=null,r._item=u,r._cells=[],r._uniqueID=b("tr"),r._expanderCell=null,r._actionsCell=null,r._rowSelectorCell=null,r._isDeleted=!1,r._isSelected=!1,r._isDetached=!1,r._stateCss=null,r._isDeleted=u._aspect.isDeleted,r._loadDOM(),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=this._grid;!t||this._isDetached||t._getInternal().removeRow(this);this._unloadDOM();this._item=null;this._grid=null;n.prototype.dispose.call(this)}},t.prototype._createCells=function(){for(var t=this,i=t.columns,r=i.length,n=0;n<r;n+=1)t._cells.push(t._createCell(i[n],n))},t.prototype._createCell=function(n,t){var r=this,i;return n instanceof s.ExpanderColumn?(this._expanderCell=new u.ExpanderCell({row:r,column:n,num:t}),i=this._expanderCell):n instanceof h.ActionsColumn?(this._actionsCell=new e.ActionsCell({row:r,column:n,num:t}),i=this._actionsCell):n instanceof c.RowSelectorColumn?(this._rowSelectorCell=new o.RowSelectorCell({row:r,column:n,num:t}),i=this._rowSelectorCell):i=new f.DataCell({row:r,column:n,num:t}),i},t.prototype._loadDOM=function(){if(!this._tr){var n=this,t=p.createElement("tr");if(this._tr=t,this._isDeleted&&l.addClass([t],"ria-row-deleted"),this._createCells(),!!this._item){if(!!this.isHasStateField)this._item.objEvents.onProp(this._grid.options.rowStateField,function(){a(n)},this._uniqueID);a(n)}}},t.prototype._unloadDOM=function(){var t,i,n;if(this._tr){for(this._item.objEvents.offNS(this._uniqueID),l.removeNode(this._tr),t=this._cells,i=t.length,n=0;n<i;n+=1)t[n].dispose();this._cells=[];this._expanderCell=null;this._rowSelectorCell=null;this._actionsCell=null;this._tr=null}},t.prototype._setState=function(n){if(this._stateCss!==n){var t=[];!this._stateCss||t.push("-"+this._stateCss);this._stateCss=n;!this._stateCss||t.push("+"+this._stateCss);l.setClasses([this.tr],t)}},t.prototype._onBeginEdit=function(){this._cells.forEach(function(n){n instanceof f.DataCell&&n._beginEdit()});!this._actionsCell||this._actionsCell.update()},t.prototype._onEndEdit=function(n){this._cells.forEach(function(t){t instanceof f.DataCell&&t._endEdit(n)});!this._actionsCell||this._actionsCell.update()},t.prototype.beginEdit=function(){return this._item._aspect.beginEdit()},t.prototype.endEdit=function(){return this._item._aspect.endEdit()},t.prototype.cancelEdit=function(){return this._item._aspect.cancelEdit()},t.prototype.deleteRow=function(){return this._item._aspect.deleteItem()},t.prototype.updateErrorState=function(){var n=this._item._aspect.getIsHasErrors();l.setClass([this._tr],"ria-row-error",!n)},t.prototype.updateUIState=function(){a(this)},t.prototype.scrollIntoView=function(n,t){this.grid.scrollToRow({row:this,animate:n,pos:t})},t.prototype.toString=function(){return"Row"},Object.defineProperty(t.prototype,"rect",{get:function(){return this.tr.getBoundingClientRect()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.tr.offsetHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.tr.offsetWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tr",{get:function(){return this._tr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cells",{get:function(){return this._cells},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._grid.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemKey",{get:function(){return this._item?this._item._key:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCurrent",{get:function(){return this.grid.currentItem===this.item},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(n){if(this._isSelected!==n){this._isSelected=n;!this._rowSelectorCell||(this._rowSelectorCell.checked=this._isSelected);this.objEvents.raiseProp("isSelected");this.grid._getInternal().onRowSelectionChanged(this)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this.grid._getInternal().isRowExpanded(this)},set:function(n){n!==this.isExpanded&&(!n&&this.isExpanded?this.grid._getInternal().expandDetails(this,!1):n&&this.grid._getInternal().expandDetails(this,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expanderCell",{get:function(){return this._expanderCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actionsCell",{get:function(){return this._actionsCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSelectorCell",{get:function(){return this._rowSelectorCell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(n){this._isDeleted!==n&&(this._isDeleted=n,this._isDeleted&&(this.isExpanded=!1),l.setClass([this._tr],"ria-row-deleted",!this._isDeleted))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDetached",{get:function(){return this._isDetached},set:function(n){this._isDetached=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return!!this._item&&this._item._aspect.isEditing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHasStateField",{get:function(){return!!this._grid.options.rowStateField},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Row=y});define("jriapp_ui/datagrid/cells/base",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/utils/dblclick"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseCell=void 0;var s=i.Utils,e=r.DomUtils,h=e.document,o=u.subscribeWeakMap,c=function(n){function t(t){var i=n.call(this)||this;return t=s.core.extend({row:null,column:null,num:0},t),i._row=t.row,i._td=h.createElement("td"),o.set(i._td,i),i._column=t.column,i._num=t.num,!i._column.options.rowCellCss||e.addClass([i._td],i._column.options.rowCellCss),i._click=new f.DblClick,i._row.tr.appendChild(i._td),i}return __extends(t,n),t.prototype._onCellClicked=function(){},t.prototype._onDblClicked=function(){this.grid._getInternal().onCellDblClicked(this)},t.prototype.isSubscribed=function(n){return n===1},t.prototype.handle_click=function(){this.grid._getInternal().setCurrentColumn(this.column);this.click()},t.prototype.click=function(){this.grid.currentRow=this._row;this._click.click()},t.prototype.scrollIntoView=function(){this.row.scrollIntoView()},t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),o.delete(this._td),!this._click||(this._click.dispose(),this._click=null),e.removeData(this._td),n.prototype.dispose.call(this))},t.prototype.toString=function(){return"BaseCell"},Object.defineProperty(t.prototype,"td",{get:function(){return this._td},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._row.grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._row.item},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._row.uniqueID+"_"+this._num},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"num",{get:function(){return this._num},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.BaseCell=c});define("jriapp_ui/datagrid/cells/details",["require","exports","jriapp_shared","jriapp/template","jriapp/utils/dom"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsCell=void 0;var f=u.DomUtils,e=f.document,o=function(n){function t(t){var i=n.call(this)||this;return(i._row=t.row,i._td=e.createElement("td"),i._td.colSpan=i.grid.columns.length,!t.details_id)?i:(i._row.tr.appendChild(i._td),i._template=r.createTemplate({parentEl:null}),i._template.templateID=t.details_id,i._td.appendChild(i._template.el),i)}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._template||(this._template.dispose(),this._template=null),this._row=null,this._td=null,n.prototype.dispose.call(this))},t.prototype.toString=function(){return"DetailsCell"},Object.defineProperty(t.prototype,"td",{get:function(){return this._td},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._row.grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._template.dataContext},set:function(n){this._template.dataContext=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return this._template},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DetailsCell=o});define("jriapp_ui/datagrid/rows/details",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/datagrid/cells/details"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DetailsRow=void 0;var e=i.Utils,o=e.core,f=r.DomUtils,s=f.document,h=o.getNewID,c=function(n){function t(t){var i=n.call(this)||this,u=i,r=s.createElement("tr");return i._grid=t.grid,i._tr=r,i._item=null,i._cell=null,i._parentRow=null,i._isFirstShow=!0,i._uniqueID=h("drow"),i._createCell(t.details_id),f.addClass([r],"ria-row-details"),i._grid.addOnRowExpanded(function(n,t){t.isExpanded||!t.collapsedRow||u._setParentRow(null)},i._uniqueID),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._grid.objEvents.offNS(this._uniqueID),!this._cell||(this._cell.dispose(),this._cell=null),f.removeNode(this._tr),this._item=null,this._tr=null,this._grid=null,n.prototype.dispose.call(this))},t.prototype._createCell=function(n){this._cell=new u.DetailsCell({row:this,details_id:n})},t.prototype._setParentRow=function(n){var t=this;if(!t.getIsStateDirty()){if(this._item=null,this._cell.item=null,f.removeNode(this.tr),!n||n.getIsStateDirty()){this._parentRow=null;return}this._parentRow=n;this._item=n.item;this._cell.item=this._item;this._isFirstShow&&this._initShow();f.insertAfter(this.tr,n.tr);this._show(function(){var n=t._parentRow;n&&!n.getIsStateDirty()&&t.grid.options.isUseScrollIntoDetails&&n.scrollIntoView(!0,2)})}},t.prototype._initShow=function(){var n=this._grid.animation;n.beforeShow(this._cell.template.el)},t.prototype._show=function(n){var t=this._grid.animation;this._isFirstShow=!1;t.beforeShow(this._cell.template.el);t.show(n)},t.prototype._hide=function(n){var t=this._grid.animation;t.beforeHide(this._cell.template.el);t.hide(n)},t.prototype.toString=function(){return"DetailsRow"},Object.defineProperty(t.prototype,"rect",{get:function(){return this.tr.getBoundingClientRect()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.tr.offsetHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.tr.offsetHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tr",{get:function(){return this._tr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},set:function(n){this._item!==n&&(this._item=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemKey",{get:function(){return this._item?this._item._key:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentRow",{get:function(){return this._parentRow},set:function(n){var t=this;n!==this._parentRow&&(t._parentRow?t._hide(function(){t._setParentRow(n)}):t._setParentRow(n))},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DetailsRow=c});define("jriapp_ui/datagrid/cells/fillspace",["require","exports","jriapp_shared","jriapp/utils/dom"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FillSpaceCell=void 0;var u=r.DomUtils,f=u.document,e=function(n){function t(t){var i=n.call(this)||this;return i._row=t.row,i._td=document.createElement("td"),i._td.colSpan=i.grid.columns.length,i._row.tr.appendChild(i._td),i._div=f.createElement("div"),i._div.className="ria-fill-vspace",i._td.appendChild(i._div),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._row=null,this._td=null,this._div=null,n.prototype.dispose.call(this))},t.prototype.toString=function(){return"FillSpaceCell"},Object.defineProperty(t.prototype,"td",{get:function(){return this._td},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._row.grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"div",{get:function(){return this._div},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._div.offsetHeight},set:function(n){this._div.style.height=(n?n:0)+"px"},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.FillSpaceCell=e});define("jriapp_ui/datagrid/rows/fillspace",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/datagrid/cells/fillspace"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FillSpaceRow=void 0;var f=r.DomUtils,e=f.document,o=function(n){function t(t){var i=n.call(this)||this,r=e.createElement("tr");return i._grid=t.grid,i._tr=r,i._cell=null,i._createCell(),f.addClass([r],"ria-fill-vspace"),i}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._cell||(this._cell.dispose(),this._cell=null),f.removeNode(this.tr),this._tr=null,this._grid=null,n.prototype.dispose.call(this))},t.prototype._createCell=function(){this._cell=new u.FillSpaceCell({row:this})},t.prototype.toString=function(){return"FillSpaceRow"},t.prototype.attach=function(){this._grid._tBodyEl.appendChild(this.tr)},t.prototype.detach=function(){f.removeNode(this.tr)},Object.defineProperty(t.prototype,"tr",{get:function(){return this._tr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._cell.height},set:function(n){this._cell.height=n},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.FillSpaceRow=o});define("jriapp_ui/datagrid/datagrid",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/utils/parser","jriapp/bootstrapper","jriapp_ui/baseview","jriapp_ui/content/int","jriapp_ui/dialog","jriapp_ui/datagrid/animation","jriapp_ui/datagrid/rows/row","jriapp_ui/datagrid/rows/details","jriapp_ui/datagrid/rows/fillspace","jriapp_ui/datagrid/columns/expander","jriapp_ui/datagrid/columns/data","jriapp_ui/datagrid/columns/actions","jriapp_ui/datagrid/columns/rowselector","jriapp_ui/datagrid/rows/row","jriapp_ui/datagrid/columns/base","jriapp_ui/datagrid/consts","jriapp_ui/datagrid/animation","jriapp_ui/utils/jquery"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";function ii(){var n=[];for(var t in rt)n.push(rt[t]);return n}function ri(n){var i,t;for(i in rt)if(t=rt[i],!!t.table&&t.table.getAttribute("data-name")===n)return t;return null}function pt(){ei();lt=ht.requestAnimationFrame(pt)}function ui(n){rt[n.uniqueID]=n;et+=1;et===1&&(lt=ht.requestAnimationFrame(pt))}function fi(n){delete rt[n.uniqueID];et-=1;et===0&&ht.cancelAnimationFrame(lt)}function ei(){bt(rt,function(n){var t=rt[n];t.getIsStateDirty()||t._getInternal().columnWidthCheck()})}var wt,at,ot;Object.defineProperty(t,"__esModule",{value:!0});t.DataGridElView=t.DataGrid=t.findDataGrid=t.getDataGrids=t.DefaultAnimation=t.ROW_ACTION=t.COLUMN_TYPE=t.ROW_POSITION=t.DataGridColumn=t.DataGridRow=void 0;Object.defineProperty(t,"DataGridRow",{enumerable:!0,get:function(){return b.Row}});Object.defineProperty(t,"DataGridColumn",{enumerable:!0,get:function(){return k.BaseColumn}});Object.defineProperty(t,"ROW_POSITION",{enumerable:!0,get:function(){return d.ROW_POSITION}});Object.defineProperty(t,"COLUMN_TYPE",{enumerable:!0,get:function(){return d.COLUMN_TYPE}});Object.defineProperty(t,"ROW_ACTION",{enumerable:!0,get:function(){return d.ROW_ACTION}});Object.defineProperty(t,"DefaultAnimation",{enumerable:!0,get:function(){return g.DefaultAnimation}});var it=i.Utils,vt=it.str.format,ft=it.core,bt=ft.forEach,kt=ft.merge,dt=ft.getNewID,yt=ft.extend,st=ft.Indexer,gt=it.err,ni=it.sys,tt=r.DomUtils,ti=u.Parser,ut=tt.document,ht=tt.window,ct=f.bootstrapper,lt,et=0,rt=st();t.getDataGrids=ii;t.findDataGrid=ri,function(n){n.row_expanded="row_expanded";n.row_selected="row_selected";n.page_changed="page_changed";n.row_state_changed="row_state_changed";n.cell_dblclicked="cell_dblclicked";n.row_action="row_action";n.refresh="refresh"}(wt||(wt={}));at=function(n){function t(t,r){var u=n.call(this)||this,e=u,o,s;if(r=kt(r,{dataSource:null,animation:null,isUseScrollInto:!0,isUseScrollIntoDetails:!0,containerCss:null,wrapCss:null,headerCss:null,rowStateField:null,isCanEdit:null,isCanDelete:null,isHandleAddNew:!1,isPrependNewRows:!1,isPrependAllRows:!1,isActionsToolTips:!1,syncSetDatasource:!1}),!!r.dataSource&&!ni.isCollection(r.dataSource))throw new Error(i.LocaleERRS.ERR_GRID_DATASRC_INVALID);return u._options=r,u._table=t,tt.addClass([t],"ria-data-table"),u._name=t.getAttribute("data-name"),u._uniqueID=dt("grd"),u._rowMap=st(),u._rows=[],u._columns=[],u._expandedRow=null,u._details=null,u._fillSpace=null,u._expanderCol=null,u._actionsCol=null,u._rowSelectorCol=null,u._currentColumn=null,u._editingRow=null,u._dialog=null,u._header=null,u._wrapper=null,u._contaner=null,u._wrapTable(),u._scrollDebounce=new i.Debounce,u._dsDebounce=new i.Debounce,u._pageDebounce=new i.Debounce,u._refreshCounter=0,u._selectable={onKeyDown:function(n,t){e._onKeyDown(n,t)},onKeyUp:function(n,t){e._onKeyUp(n,t)}},u._updateCurrent=function(){},o=t.offsetWidth,u._internal={isRowExpanded:function(n){return e._isRowExpanded(n)},getHeader:function(){return e._header},getContainer:function(){return e._contaner},getWrapper:function(){return e._wrapper},setCurrentColumn:function(n){e._setCurrentColumn(n)},onRowStateChanged:function(n,t){return e._onRowStateChanged(n,t)},onCellDblClicked:function(n){e._onCellDblClicked(n)},onRowSelectionChanged:function(n){e._onRowSelectionChanged(n)},resetColumnsSort:function(){e._resetColumnsSort()},getLastRow:function(){return e._getLastRow()},removeRow:function(n){e._removeRow(n)},expandDetails:function(n,t){e._expandDetails(n,t)},columnWidthCheck:function(){if(!e.getIsStateDirty()){var n=t.offsetWidth;o!==n&&(o=n,e.updateColumnsSize())}}},u._createColumns(),f.selectableProviderWeakMap.set(t,u),ui(u),s=u._options.dataSource,u.setDataSource(s),u}return __extends(t,n),t.prototype.dispose=function(){var t,i,r;if(!this.getIsDisposed()){for(this.setDisposing(),f.selectableProviderWeakMap.delete(this._table),this._scrollDebounce.dispose(),this._dsDebounce.dispose(),this._pageDebounce.dispose(),this._updateCurrent=function(){},this._clearGrid(),this._unbindDS(),fi(this),!this._details||(this._details.dispose(),this._details=null),!this._fillSpace||(this._fillSpace.dispose(),this._fillSpace=null),this._options.animation&&(this._options.animation.stop(),this._options.animation=null),!this._dialog||(this._dialog.dispose(),this._dialog=null),this._unWrapTable(),tt.removeClass([this._table],"ria-data-table"),tt.removeClass([this._tHeadRow],"ria-col-info"),t=0,i=this._columns;t<i.length;t++)r=i[t],r.dispose();this._columns=[];this._table=null;this._options={};this._selectable=null;this._internal=null;n.prototype.dispose.call(this)}},t.prototype._updateContentOptions=function(){this.columns.filter(function(n){return n instanceof y.DataColumn}).forEach(function(n){n.updateContentOptions()})},t.prototype._onKeyDown=function(n,t){var i=this.dataSource,u=this,r;if(i){r=this.currentRow;switch(n){case 38:t.preventDefault();i.movePrev(!0)&&u.isUseScrollInto&&u.scrollToCurrent(0);break;case 40:t.preventDefault();i.moveNext(!0)&&u.isUseScrollInto&&u.scrollToCurrent(1);break;case 34:t.preventDefault();this._pageDebounce.enque(function(){i.pageIndex>0&&(i.pageIndex=i.pageIndex-1)});break;case 33:t.preventDefault();this._pageDebounce.enque(function(){i.pageIndex=i.pageIndex+1});break;case 13:!r||!this._actionsCol||t.preventDefault();break;case 27:!r||!this._actionsCol||r.isEditing&&t.preventDefault();break;case 32:!this._rowSelectorCol||!r||r.isExpanded||r.isEditing||t.preventDefault()}}},t.prototype._onKeyUp=function(n,t){var r=this.dataSource,i;if(r){i=this.currentRow;switch(n){case 13:!i||!this._actionsCol||(t.preventDefault(),i.isEditing?this.objEvents.raise("row_action",{row:i,action:0}):this.objEvents.raise("row_action",{row:i,action:1}));break;case 27:!i||!this._actionsCol||i.isEditing&&(t.preventDefault(),this.objEvents.raise("row_action",{row:i,action:2}));break;case 32:!this._rowSelectorCol||!i||i.isExpanded||i.isEditing||(t.preventDefault(),i.isSelected=!i.isSelected)}}},t.prototype._isRowExpanded=function(n){return this._expandedRow===n},t.prototype._setCurrentColumn=function(n){!this._currentColumn||(this._currentColumn.isSelected=!1);this._currentColumn=n;!this._currentColumn||(this._currentColumn.isSelected=!0)},t.prototype._onRowStateChanged=function(n,t){var i={row:n,val:t,css:null};return this.objEvents.raise("row_state_changed",i),i.css},t.prototype._onCellDblClicked=function(n){var t={cell:n};this.objEvents.raise("cell_dblclicked",t)},t.prototype._onRowSelectionChanged=function(n){this.objEvents.raise("row_selected",{row:n})},t.prototype._resetColumnsSort=function(){this.columns.forEach(function(n){n instanceof y.DataColumn&&(n.sortOrder=null)})},t.prototype._getLastRow=function(){if(this._rows.length===0)return null;for(var n=this._rows.length-1,t=this._rows[n];t.isDeleted&&n>0;)n-=1,t=this._rows[n];return t.isDeleted?null:t},t.prototype._removeRow=function(n){if(this._isRowExpanded(n)&&this.collapseDetails(),this._rows.length===0)return-1;var t=n.itemKey,i=it.arr.remove(this._rows,n);try{i>-1&&(n.getIsStateDirty()||n.dispose())}finally{!this._rowMap[t]||delete this._rowMap[t]}return i},t.prototype._expandDetails=function(n,t){if(this._options.details){this._details||(this._details=this._createDetails(),this._fillSpace=this._createFillSpace());var i=this._expandedRow;i===n&&i&&t||(this._expandedRow=null,this._details.parentRow=null,t?(this._expandedRow=n,this._details.parentRow=n,this._expandedRow.expanderCell.toggleImage(),this._fillSpace.attach()):(this._expandedRow=null,this._details.parentRow=null,!i||i.expanderCell.toggleImage(),this._fillSpace.detach(),this._fillSpace.height=0),i===n||!i||i.expanderCell.toggleImage(),this.objEvents.raise("row_expanded",{collapsedRow:i,expandedRow:n,isExpanded:t}))}},t.prototype._parseColumnAttr=function(n,t){var r={type:"data",title:null,sortable:!1,sortMemberName:null,content:null},i,u=ti.parseOptions(n);return i=u?yt(r,u):r,!t||(i.content=o.parseContentAttr(t),i.sortMemberName||!i.content.fieldName||(i.sortMemberName=i.content.fieldName)),i},t.prototype._findUndeleted=function(n,t){if(!n)return null;if(!n.isDeleted)return n;var u=this.rows.indexOf(n),r=this.rows.length,i=u;if(t){for(i+=1,i<r&&(n=this.rows[i]);i<r&&n.isDeleted;)i+=1,i<r&&(n=this.rows[i]);n.isDeleted&&(n=null)}else{for(i-=1,i>=0&&(n=this.rows[i]);i>=0&&n.isDeleted;)i-=1,i>=0&&(n=this.rows[i]);n.isDeleted&&(n=null)}return n},t.prototype._onDSCurrentChanged=function(n,t){if(n!==t){var i=n?this._rowMap[n._key]:null,r=t?this._rowMap[t._key]:null;!i||(i.objEvents.raiseProp("isCurrent"),tt.removeClass([i.tr],"ria-row-highlight"));!r||(r.objEvents.raiseProp("isCurrent"),tt.addClass([r.tr],"ria-row-highlight"))}},t.prototype._onDSCollectionChanged=function(n,t){var r=this,u,f,e;switch(t.changeType){case 2:t.reason===0&&r._resetColumnsSort();r._refresh(t.reason===1);break;case 1:r._appendItems(t.items);r._updateTableDisplay();break;case 0:u=-1;t.items.forEach(function(n){var t=r._rowMap[n._key];!t||(u=r._removeRow(t))});f=this._rows.length;u>-1&&f>0&&(this.currentRow=u<f?this._rows[u]:this._rows[f-1]);r._updateTableDisplay();break;case 3:e=r._rowMap[t.old_key];!e||(delete r._rowMap[t.old_key],r._rowMap[t.new_key]=e);break;default:throw new Error(vt(i.LocaleERRS.ERR_COLLECTION_CHANGETYPE_INVALID,t.changeType));}},t.prototype._updateTableDisplay=function(){this._table&&(this._table.style.visibility=this.dataSource&&this.dataSource.count!==0?"visible":"hidden")},t.prototype._onPageChanged=function(){!this._rowSelectorCol||(this._rowSelectorCol.checked=!1);this.objEvents.raise("page_changed",{})},t.prototype._onItemEdit=function(n,t,i){var r=this._rowMap[n._key];r&&(t?(r._onBeginEdit(),this._editingRow=r):(r._onEndEdit(i),this._editingRow=null),this.objEvents.raiseProp("editingRow"))},t.prototype._onItemAdded=function(n,t){var i=t.item,r=this._rowMap[i._key];r&&(this.scrollToCurrent(),this._options.isHandleAddNew&&!t.isAddNewHandled&&(t.isAddNewHandled=this.showEditDialog()))},t.prototype._onItemStatusChanged=function(n,t){var u=n._aspect.status,f=this.dataSource,i=this._rowMap[n._key],r;i&&(u===3?(i.isDeleted=!0,r=this._findUndeleted(i,!0),r||(r=this._findUndeleted(i,!1)),!r||(f.currentItem=r.item)):t===3&&(i.isDeleted=!1))},t.prototype._onDSErrorsChanged=function(n,t){var i=this._rowMap[t.item._key];i&&i.updateErrorState()},t.prototype._getRefreshHandler=function(n,t){var i=this;return function(){i.getIsStateDirty()||i._refreshCounter!==n||t()}},t.prototype._bindDS=function(){var r=this,n=this,t=this.dataSource,i;if(!t){this._updateTableDisplay();return}i=null;this._updateCurrent=function(){var t=r.dataSource;n._onDSCurrentChanged(i,t.currentItem);i=t.currentItem};t.addOnCollChanged(n._onDSCollectionChanged,n._uniqueID,n);t.addOnCurrentChanged(function(){n._updateCurrent()},n._uniqueID,n);t.addOnBeginEdit(function(t,i){n._onItemEdit(i.item,!0,!1)},n._uniqueID);t.addOnEndEdit(function(t,i){n._onItemEdit(i.item,!1,i.isCanceled)},n._uniqueID);t.addOnErrorsChanged(n._onDSErrorsChanged,n._uniqueID,n);t.addOnStatusChanged(function(t,i){n._onItemStatusChanged(i.item,i.oldStatus)},n._uniqueID);t.addOnItemAdded(n._onItemAdded,n._uniqueID,n);t.addOnItemAdding(function(){n.collapseDetails()},n._uniqueID)},t.prototype._unbindDS=function(){var t=this,n=this.dataSource;(this._updateTableDisplay(),n)&&n.objEvents.offNS(t._uniqueID)},t.prototype._clearGrid=function(){var u=this,r,n,t,i;if(this._rows.length!==0){this.collapseDetails();var f=this,e=f._tBodyEl,o=ut.createElement("tbody");for(this.table.replaceChild(o,e),r=this._rows,this._rows=[],this._rowMap=st(),n=0,t=r;n<t.length;n++)i=t[n],i.isDetached=!0,i.dispose();this._refreshCounter++;it.async.getTaskQueue().enque(this._getRefreshHandler(this._refreshCounter,function(){return u.objEvents.raise("refresh",{})}))}},t.prototype._wrapTable=function(){var n=this._options,t=ut.createElement("div"),i=ut.createElement("div"),r=ut.createElement("div");tt.addClass([t],"ria-table-wrap");tt.addClass([i],"ria-table-container");tt.addClass([r],"ria-table-header");n.wrapCss&&tt.addClass([t],n.wrapCss);n.containerCss&&tt.addClass([i],n.containerCss);n.headerCss&&tt.addClass([r],n.headerCss);tt.wrap(this.table,t);tt.wrap(t,i);tt.insertBefore(r,t);tt.addClass([this._tHeadRow],"ria-col-info");this._wrapper=t;this._header=r;this._contaner=i;f.selectableProviderWeakMap.set(this._contaner,this)},t.prototype._unWrapTable=function(){this._header&&(f.selectableProviderWeakMap.delete(this._contaner),tt.removeNode(this._header),this._header=null,tt.unwrap(this.table),tt.unwrap(this.table),this._wrapper=null,this._contaner=null)},t.prototype._createColumns=function(){for(var n,s,t,u,h,f,i=this,c=this._tHeadCells,e=[],r=0,o=c;r<o.length;r++)n=o[r],s=this._parseColumnAttr(n.getAttribute("data-column"),n.getAttribute("data-content")),e.push({th:n,colInfo:s});for(t=0,u=e;t<u.length;t++)h=u[t],f=i._createColumn(h),!f||i._columns.push(f);i.updateColumnsSize()},t.prototype._createColumn=function(n){var t;switch(n.colInfo.type){case"row_expander":this._expanderCol||(t=new v.ExpanderColumn(this,n),this._expanderCol=t);break;case"row_actions":this._actionsCol||(t=new p.ActionsColumn(this,n),this._actionsCol=t);break;case"row_selector":this._rowSelectorCol||(t=new w.RowSelectorColumn(this,n),this._rowSelectorCol=t);break;case"data":t=new y.DataColumn(this,n);break;default:throw new Error(vt(i.LocaleERRS.ERR_GRID_COLTYPE_INVALID,n.colInfo.type));}return t},t.prototype._appendItems=function(n){var t=this,e=this._tBodyEl,r=t.options.isPrependAllRows,o=t.options.isPrependNewRows,f,s,u,i;if(n.length===1)i=n[0],t._rowMap[i._key]||(r=r||o&&i._aspect.isNew,t._createRowForItem(e,i,r));else{for(f=ut.createDocumentFragment(),s=n.length,u=0;u<s;u+=1)i=n[u],t._rowMap[i._key]||t._createRowForItem(f,i,o&&i._aspect.isNew);t._addNodeToParent(e,f,r)}t.updateColumnsSize()},t.prototype._refresh=function(n){var s=this,t=this,u=this.dataSource,i,r,o;if(u&&!t.getIsStateDirty()){this._clearGrid();var f=ut.createDocumentFragment(),h=this._tBodyEl,e=ut.createElement("tbody");for(i=0,r=u.items;i<r.length;i++)o=r[i],t._createRowForItem(f,o,!1);e.appendChild(f);t.table.replaceChild(e,h);n&&t._onPageChanged();t.isUseScrollInto&&t.scrollToCurrent();t.updateColumnsSize();t._updateTableDisplay();t._updateCurrent();this._refreshCounter++;it.async.getTaskQueue().enque(this._getRefreshHandler(this._refreshCounter,function(){return s.objEvents.raise("refresh",{})}))}},t.prototype._addNodeToParent=function(n,t,i){i?tt.prepend(n,t):tt.append(n,[t])},t.prototype._createRowForItem=function(n,t,i){var r=this,u=new c.Row(r,{item:t});return r._rowMap[t._key]=u,i?r._rows.unshift(u):r._rows.push(u),r._addNodeToParent(n,u.tr,i),u},t.prototype._createDetails=function(){var n=this._options.details.templateID;return new l.DetailsRow({grid:this,details_id:n})},t.prototype._createFillSpace=function(){return new a.FillSpaceRow({grid:this})},t.prototype._scrollTo=function(n,t){t?nt.$(this._wrapper).animate({scrollTop:n},{duration:500,specialEasing:{width:"linear",height:"easeOutBounce"}}):this._wrapper.scrollTop=n},t.prototype.setDataSource=function(n){var t=this,i;this._unbindDS();this._options.dataSource=n;i=function(){var n=t.dataSource;!n||n.getIsStateDirty()?t._clearGrid():(t._updateContentOptions(),t._bindDS(),t._refresh(!1))};this._options.syncSetDatasource?i():this._dsDebounce.enque(i)},t.prototype._getInternal=function(){return this._internal},t.prototype.updateColumnsSize=function(){var r,e,n,u,i,f,t;if(!this.getIsStateDirty()){for(r=0,e=this._header,n=0,u=this._columns;n<u.length;n++)t=u[n],r+=t.width;for(e.style.width=r+"px",i=0,f=this._columns;i<f.length;i++)t=f[i],t.updateWidth()}},t.prototype.sortByColumn=function(n){var t=this.dataSource,i,r;return t?(i=n.sortMemberName.split(";"),r=t.sort(i,n.sortOrder),r):it.async.reject("DataGrid's datasource is not set")},t.prototype.selectRows=function(n){for(var i,u,t=0,r=this._rows;t<r.length;t++)i=r[t],u=i.rowSelectorCell,i.isDeleted||u&&u.isDisabled||(i.isSelected=n)},t.prototype.findRowByItem=function(n){var t=this._rowMap[n._key];return t?t:null},t.prototype.collapseDetails=function(){if(this._details){var n=this._expandedRow;!n||this._expandDetails(n,!1)}},t.prototype.getSelectedRows=function(){for(var n,i=[],t=0,r=this._rows;t<r.length;t++)n=r[t],n.isDeleted||n.isSelected&&i.push(n);return i},t.prototype.showEditDialog=function(){if(!this.isHasEditor||!this._editingRow)return!1;var t,n=this._editingRow.item;return n._aspect.isEditing||n._aspect.beginEdit(),this._dialog?this._dialog.dataContext=n:(t=yt({dataContext:n,templateID:null},this._options.editor),this._dialog=new s.DataEditDialog(t)),this._dialog.canRefresh=!!this.dataSource.permissions.canRefreshRow&&!n._aspect.isNew,this._dialog.show(),!0},t.prototype.scrollToRow=function(n){var u,f,i,s;if(n&&n.row){u=n.row;f=this._wrapper;!this._fillSpace||(this._fillSpace.height=0);var a=!!n.animate,h=n.pos===1,e=f.clientHeight,v=f.getBoundingClientRect(),y=u.height,o=f.scrollTop,t=o+u.rect.top-v.top;t=h?Math.floor(t+1):Math.floor(t-1);i=y;u.isExpanded&&(i=i+this._details.height);i=Math.min(e,i);var c=e-i,r=t,l=0;(h&&(r-=c),s=this.table.offsetHeight-e+1,r<0?r=0:r>s&&(l=r-s),!this._fillSpace||(this._fillSpace.height=l),n.pos!==2&&o<t&&o>t-c)||this._scrollTo(r,a)}},t.prototype.scrollToCurrent=function(n,t){var i=this;this._scrollDebounce.enque(function(){i.scrollToRow({row:i.currentRow,animate:t,pos:n})})},t.prototype.focus=function(){this.scrollToCurrent(0);ct.selectedControl=this},t.prototype.addNew=function(){var t=this.dataSource;try{t.addNew();this.showEditDialog()}catch(n){gt.reThrow(n,this.handleError(n,this))}},t.prototype.addOnRowExpanded=function(n,t,i){this.objEvents.on("row_expanded",n,t,i)},t.prototype.offOnRowExpanded=function(n){this.objEvents.off("row_expanded",n)},t.prototype.addOnRowSelected=function(n,t,i){this.objEvents.on("row_selected",n,t,i)},t.prototype.offOnRowSelected=function(n){this.objEvents.off("row_selected",n)},t.prototype.addOnPageChanged=function(n,t,i){this.objEvents.on("page_changed",n,t,i)},t.prototype.offOnPageChanged=function(n){this.objEvents.off("page_changed",n)},t.prototype.addOnRefresh=function(n,t,i){var r=this;this.objEvents.on("refresh",n,t,i);it.async.getTaskQueue().enque(this._getRefreshHandler(this._refreshCounter,function(){return n(r,{})}))},t.prototype.offOnRefresh=function(n){this.objEvents.off("refresh",n)},t.prototype.addOnRowStateChanged=function(n,t,i){this.objEvents.on("row_state_changed",n,t,i)},t.prototype.offOnRowStateChanged=function(n){this.objEvents.off("row_state_changed",n)},t.prototype.addOnCellDblClicked=function(n,t,i){this.objEvents.on("cell_dblclicked",n,t,i)},t.prototype.offOnCellDblClicked=function(n){this.objEvents.off("cell_dblclicked",n)},t.prototype.addOnRowAction=function(n,t,i){this.objEvents.on("row_action",n,t,i)},t.prototype.offOnRowAction=function(n){this.objEvents.off("row_action",n)},Object.defineProperty(t.prototype,"selectable",{get:function(){return this._selectable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tBodyEl",{get:function(){return this.table.tBodies[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tHeadEl",{get:function(){return this.table.tHead},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tFootEl",{get:function(){return this.table.tFoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tHeadRow",{get:function(){if(!this._tHeadEl)return null;var n=this._tHeadEl.rows;return n.length===0?null:n[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_tHeadCells",{get:function(){var n=this._tHeadRow;return n?it.arr.fromList(n.cells):[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(n){n!==this.dataSource&&(this.setDataSource(n),this.objEvents.raiseProp("dataSource"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSelectorCol",{get:function(){return this._rowSelectorCol},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){var n=this.dataSource;return n?n.currentItem:null},set:function(n){var t=this.dataSource;t&&(t.currentItem=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentRow",{get:function(){var n=this.currentItem;return n?this._rowMap[n._key]:null},set:function(n){!n||n.getIsStateDirty()?this.currentItem=null:n.item!==this.currentItem&&(this.currentItem=n.item)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"editingRow",{get:function(){return this._editingRow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHasEditor",{get:function(){return!!this._options.editor&&!!this._options.editor.templateID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanEdit",{get:function(){if(this._options.isCanEdit!==null)return this._options.isCanEdit;var n=this.dataSource;return!!n&&n.permissions.canEditRow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanDelete",{get:function(){if(this._options.isCanDelete!==null)return this._options.isCanDelete;var n=this.dataSource;return!!n&&n.permissions.canDeleteRow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCanAddNew",{get:function(){var n=this.dataSource;return!!n&&n.permissions.canAddRow},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUseScrollInto",{get:function(){return this._options.isUseScrollInto},set:function(n){this._options.isUseScrollInto=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"syncSetDatasource",{get:function(){return this._options.syncSetDatasource},set:function(n){this._options.syncSetDatasource=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this.options.animation||(this.options.animation=new h.DefaultAnimation),this.options.animation},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.DataGrid=at;ot=function(n){function t(t,r){var u=n.call(this,t,r)||this;return u._stateProvider=null,u._stateDebounce=new i.Debounce,u._grid=new at(t,r),u._bindGridEvents(),u}return __extends(t,n),t.prototype.toString=function(){return"DataGridElView"},t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._stateDebounce.dispose(),this._grid.getIsStateDirty()||this._grid.dispose(),this._stateProvider=null,n.prototype.dispose.call(this))},t.prototype._bindGridEvents=function(){var n=this;this._grid.addOnRowStateChanged(function(t,i){!n._stateProvider||(i.css=n._stateProvider.getCSS(i.row.item,i.val))},this.uniqueID);n._grid.objEvents.onProp("*",function(t,i){switch(i.property){case"dataSource":n.objEvents.raiseProp(i.property)}},n.uniqueID)},t.prototype._setErrors=function(){},Object.defineProperty(t.prototype,"dataSource",{get:function(){return this.grid.dataSource},set:function(n){this.grid.dataSource=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stateProvider",{get:function(){return this._stateProvider},set:function(n){var t=this;n!==this._stateProvider&&(this._stateProvider=n,this._stateDebounce.enque(function(){var n,i,r;if(t._grid&&!t._grid.getIsStateDirty())for(n=0,i=t._grid.rows;n<i.length;n++)r=i[n],r.updateUIState()}),this.objEvents.raiseProp("stateProvider"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"animation",{get:function(){return this._grid.options.animation},set:function(n){this.animation!==n&&(this._grid.options.animation=n,this.objEvents.raiseProp("animation"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this._grid.selectable},enumerable:!1,configurable:!0}),t}(e.BaseElView);t.DataGridElView=ot;ct.registerElView("table",ot);ct.registerElView("datagrid",ot)});define("jriapp_ui/pager",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/baseview","jriapp_ui/baseview","jriapp/bootstrapper"],function(n,t,i,r,u,f,e){"use strict";function w(n){for(var r,t=0,i=n;t<i.length;t++)r=i[t],u.addToolTip(r,null)}var a,v;Object.defineProperty(t,"__esModule",{value:!0});t.PagerElView=t.Pager=void 0;var c=i.Utils,o=r.DomUtils,l=o.document,b=c.sys,h=c.str.format,y=c.core,k=y.getNewID,d=y.extend,g=e.bootstrapper,s=i.LocaleSTRS.PAGER,p;(function(n){n.interval="ria-pager-interval";n.pager="ria-pager";n.info="ria-pager-info";n.page="ria-pager-page";n.currentPage="ria-pager-current-page";n.otherPage="ria-pager-other-page"})(p||(p={}));a=function(n){function t(t,r){var u=n.call(this)||this,f;if(r=d({dataSource:null,showTip:!0,showInfo:!1,showNumbers:!0,showPreviousAndNext:!1,useSlider:!0,hideOnSinglePage:!0,sliderSize:10},r),f=u,u._display=null,!!r.dataSource&&!b.isCollection(r.dataSource))throw new Error(i.LocaleERRS.ERR_PAGER_DATASRC_INVALID);u._options=r;r.sliderSize=r.sliderSize<3?3:r.sliderSize;u._el=t;u._uniqueID=k("pgr");u._rowsPerPage=0;u._rowCount=0;u._currentPage=1;u._toolTips=[];u._pageDebounce=new i.Debounce;u._dsDebounce=new i.Debounce;o.events.on(t,"click",function(n){n.preventDefault();var i=n.target,t=parseInt(i.getAttribute("data-page"),10);f._pageDebounce.enque(function(){f.currentPage=t;f._dsDebounce.enque(function(){!f.dataSource||(f.dataSource.pageIndex=t-1)})})},{nmspace:u._uniqueID,matchElement:function(n){var t=n.getAttribute("data-scope");return f._uniqueID===t}});return u._bindDS(),e.selectableProviderWeakMap.set(t,u),u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),e.selectableProviderWeakMap.delete(this._el),this.parentControl=null,this._pageDebounce.dispose(),this._dsDebounce.dispose(),this._unbindDS(),this._clearContent(),o.events.offNS(this._el,this._uniqueID),this._el=null,this._options={},n.prototype.dispose.call(this))},t.prototype._addToolTip=function(n,t){u.addToolTip(n,t);!t||this._toolTips.push(n)},t.prototype._createElement=function(n){return l.createElement(n)},t.prototype._clearContent=function(){this._el.innerHTML="";w(this._toolTips);this._toolTips=[]},t.prototype.render=function(){var a=l.createElement("div"),n=l.createDocumentFragment(),it=this._toolTips,p,b,c,g,tt;if(this._toolTips=[],o.addClass([a],"ria-pager"),!(this.rowsPerPage<=0)){var u=this.rowCount,i=this.currentPage,t=this.pageCount;if(u>0&&(!this.showPreviousAndNext||this.hideOnSinglePage&&t===1||(n.appendChild(this._createFirst()),n.appendChild(this._createPrevious()),n.appendChild(this._createCurrent()),n.appendChild(this._createNext()),n.appendChild(this._createLast())),this.showNumbers&&i>0&&!(this.hideOnSinglePage&&t===1))){var v=this.sliderSize,y=1,e=t,k=void 0,f=void 0,r=void 0;for(this.useSlider&&v>0&&v<t-3&&(k=Math.floor((v-1)/2),f=i+k+(v-1)%2,r=i-k,r<1&&(f+=1-r,r=1),f>t&&(r-=f-t,r<1&&(r=1),f=t),y=r,e=f),p=y===1?2:y,b=e===t?e-1:e,1===i?n.appendChild(this._createCurrent()):n.appendChild(this._createOther(1)),p>2&&(p===3?n.appendChild(this._createOther(2)):n.appendChild(this._createInterval())),c=p;c<=b;c++)c===i?n.appendChild(this._createCurrent()):n.appendChild(this._createOther(c));b<t-1&&(b===t-2?n.appendChild(this._createOther(t-1)):n.appendChild(this._createInterval()));t===i?n.appendChild(this._createCurrent()):n.appendChild(this._createOther(t))}if(this.showInfo&&u>0&&i>0){var nt=this.rowsPerPage,y=u===0?0:(i-1)*nt+1,e=u===0?0:i===t?u:i*nt,d=this._createElement("span"),rt=h(s.pageInfo,y,e,u);o.addClass([d],"ria-pager-info");d.innerHTML=rt;g=this._createElement("span");g.innerHTML="&nbsp;&nbsp;";n.appendChild(g);n.appendChild(d)}a.appendChild(n);tt=this._el.firstChild;tt?this._el.replaceChild(a,this._el.firstChild):this._el.appendChild(a);w(it)}},t.prototype._onPageSizeChanged=function(n){this.rowsPerPage=n.pageSize},t.prototype._onPageIndexChanged=function(n){this.currentPage=n.pageIndex+1},t.prototype._onTotalCountChanged=function(n){this.rowCount=n.totalCount},t.prototype._bindDS=function(){var n=this,t=this.dataSource;t&&(t.addOnCollChanged(function(t,i){switch(i.changeType){case 2:i.reason!==1&&n._reset()}},n._uniqueID),t.addOnPageIndexChanged(n._onPageIndexChanged,n._uniqueID,n),t.addOnPageSizeChanged(n._onPageSizeChanged,n._uniqueID,n),t.addOnTotalCountChanged(n._onTotalCountChanged,n._uniqueID,n),this._reset())},t.prototype._unbindDS=function(){var t=this,n=this.dataSource;n&&n.objEvents.offNS(t._uniqueID)},t.prototype._reset=function(){var n=this.dataSource;if(!n){this._currentPage=1;this._rowsPerPage=100;this._rowCount=0;this.render();return}this._currentPage=n.pageIndex+1;this._rowsPerPage=n.pageSize;this._rowCount=n.totalCount;this.render()},t.prototype._createLink=function(n){var t=this._createElement("a");return t.textContent=""+n,t.setAttribute("href","javascript:void(0)"),t},t.prototype._addScope=function(n,t){n.setAttribute("data-scope",this._uniqueID);n.setAttribute("data-page",""+t)},t.prototype._createFirst=function(){var n=this._createElement("span"),t,i;return this.showTip&&(t=s.firstPageTip,this._addToolTip(n,t)),i=this._createLink(s.firstText),o.addClass([n],"ria-pager-page"),o.addClass([n],"ria-pager-other-page"),n.appendChild(i),this._addScope(n,1),n},t.prototype._createPrevious=function(){var n=this._createElement("span"),t=this.currentPage-1,i,r;return t<1&&(t=1),this.showTip&&(i=h(s.prevPageTip,t),this._addToolTip(n,i)),r=this._createLink(s.previousText),o.addClass([n],"ria-pager-page"),o.addClass([n],"ria-pager-other-page"),n.appendChild(r),this._addScope(n,t),n},t.prototype._createCurrent=function(){var n=this._createElement("span"),t=this.currentPage;return n.textContent=""+t,this.showTip&&this._addToolTip(n,this._buildTip(t)),o.addClass([n],"ria-pager-page"),o.addClass([n],"ria-pager-current-page"),n},t.prototype._createInterval=function(){var n=this._createElement("span");return o.addClass([n],"ria-pager-interval"),n.textContent="...",n},t.prototype._createOther=function(n){var t=this._createElement("span"),i,r;return this.showTip&&(i=this._buildTip(n),this._addToolTip(t,i)),r=this._createLink(""+n),o.addClass([t],"ria-pager-page"),o.addClass([t],"ria-pager-other-page"),t.appendChild(r),this._addScope(t,n),t},t.prototype._createNext=function(){var n=this._createElement("span"),i=this.pageCount,t=this.currentPage+1,r,u;return t>i&&(t=i),this.showTip&&(r=h(s.nextPageTip,t),this._addToolTip(n,r)),u=this._createLink(s.nextText),o.addClass([n],"ria-pager-page"),o.addClass([n],"ria-pager-other-page"),n.appendChild(u),this._addScope(n,t),n},t.prototype._createLast=function(){var n=this._createElement("span"),t,i;return this.showTip&&(t=s.lastPageTip,this._addToolTip(n,t)),i=this._createLink(s.lastText),o.addClass([n],"ria-pager-page"),o.addClass([n],"ria-pager-other-page"),n.appendChild(i),this._addScope(n,this.pageCount),n},t.prototype._buildTip=function(n){var i=this.rowsPerPage,t=this.rowCount,r=(n-1)*i+1,u=n===this.pageCount?t:n*i;return n===this.currentPage?h(s.showingTip,r,u,t):h(s.showTip,r,u,t)},t.prototype.setDataSource=function(n){this._unbindDS();this._options.dataSource=n;this._bindDS()},t.prototype.toString=function(){return"Pager"},Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(n){n!==this.dataSource&&(this.setDataSource(n),this.objEvents.raiseProp("dataSource"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCount",{get:function(){var n=this.rowCount,t=this.rowsPerPage,i;return n===0||t===0?0:n%t==0?n/t:(i=n/t,Math.floor(i)+1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowCount",{get:function(){return this._rowCount},set:function(n){this._rowCount!==n&&(this._rowCount=n,this.render(),this.objEvents.raiseProp("rowCount"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowsPerPage",{get:function(){return this._rowsPerPage},set:function(n){this._rowsPerPage!==n&&(this._rowsPerPage=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPage",{get:function(){return this._currentPage},set:function(n){this._currentPage!==n&&(this._currentPage=n,this.render(),this.objEvents.raiseProp("currentPage"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useSlider",{get:function(){return this._options.useSlider},set:function(n){this.useSlider!==n&&(this._options.useSlider=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sliderSize",{get:function(){return this._options.sliderSize},set:function(n){this.sliderSize!==n&&(this._options.sliderSize=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hideOnSinglePage",{get:function(){return this._options.hideOnSinglePage},set:function(n){this.hideOnSinglePage!==n&&(this._options.hideOnSinglePage=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showTip",{get:function(){return this._options.showTip},set:function(n){this.showTip!==n&&(this._options.showTip=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showInfo",{get:function(){return this._options.showInfo},set:function(n){this._options.showInfo!==n&&(this._options.showInfo=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPreviousAndNext",{get:function(){return this._options.showPreviousAndNext},set:function(n){this.showPreviousAndNext!==n&&(this._options.showPreviousAndNext=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showNumbers",{get:function(){return this._options.showNumbers},set:function(n){this.showNumbers!==n&&(this._options.showNumbers=n,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){var n=this.el.style.display;return!(n==="none")},set:function(n){n=!!n;n!==this.isVisible&&(n?this.el.style.display=this._display?this._display:"":(this._display=this.el.style.display,this._display==="none"&&(this._display=null),this.el.style.display="none"),this.objEvents.raiseProp("isVisible"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this._parentControl?this._parentControl.selectable:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentControl",{get:function(){return this._parentControl},set:function(n){this._parentControl!==n&&(this._parentControl=n,this.objEvents.raiseProp("parentControl"))},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.Pager=a;v=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;r._pager=new a(t,i);u._pager.objEvents.onProp("*",function(n,t){switch(t.property){case"dataSource":case"parentControl":u.objEvents.raiseProp(t.property)}},u.uniqueID);return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._pager.getIsStateDirty()||this._pager.dispose(),n.prototype.dispose.call(this))},t.prototype._setErrors=function(){},t.prototype.toString=function(){return"PagerElView"},Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._pager.dataSource},set:function(n){this._pager.dataSource=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pager",{get:function(){return this._pager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this._pager.selectable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentControl",{get:function(){return this._pager.parentControl},set:function(n){this._pager.parentControl=n},enumerable:!1,configurable:!0}),t}(f.BaseElView);t.PagerElView=v;g.registerElView("pager",v)});define("jriapp_ui/stackpanel",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/template","jriapp_ui/baseview","jriapp/bootstrapper"],function(n,t,i,r,u,f,e){"use strict";var w,b,y,s;Object.defineProperty(t,"__esModule",{value:!0});t.StackPanelElView=t.StackPanel=void 0;var c=i.Utils,o=r.DomUtils,l=o.document,k=c.sys,d=c.str.format,a=c.core,g=a.getNewID,nt=a.extend,v=a.Indexer,h=e.bootstrapper,p;(function(n){n.stackpanel="ria-stackpanel";n.item="ria-stackpanel-item";n.horizontal="ria-horizontal-panel";n.currentItem="ria-current-item";n.itemDeleted="ria-item-deleted"})(p||(p={})),function(n){n.VERTICAL="vertical";n.HORIZONTAL="horizontal"}(w||(w={})),function(n){n.item_clicked="item_clicked"}(b||(b={}));y=function(n){function t(t,r){var u=n.call(this)||this,f=u,s,h;if(r=nt({el:null,dataSource:null,templateID:null,orientation:"vertical",syncSetDatasource:!1},r),!!r.dataSource&&!k.isCollection(r.dataSource))throw new Error(i.LocaleERRS.ERR_STACKPNL_DATASRC_INVALID);if(!r.templateID)throw new Error(i.LocaleERRS.ERR_STACKPNL_TEMPLATE_INVALID);u._options=r;u._el=t;o.addClass([t],"ria-stackpanel");s=t.tagName.toLowerCase();u._itemTag=s==="ul"||s==="ol"?"li":"div";u.orientation==="horizontal"&&o.addClass([t],"ria-horizontal-panel");u._debounce=new i.Debounce;u._uniqueID=g("pnl");u._isKeyNavigation=!1;u._currentItem=null;u._itemMap=v();u._selectable={onKeyDown:function(n,t){f._onKeyDown(n,t)},onKeyUp:function(n,t){f._onKeyUp(n,t)}};o.events.on(t,"click",function(n){var i=n.target,t=o.getData(i,"data");f._onItemClicked(t.el,t.item)},{nmspace:u.uniqueID,matchElement:function(n){var t=n.getAttribute("data-scope"),i=n.tagName.toLowerCase();return f.uniqueID===t&&i===f._itemTag}});return e.selectableProviderWeakMap.set(t,u),h=u._options.dataSource,u.setDataSource(h),u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),e.selectableProviderWeakMap.delete(this._el),this._debounce.dispose(),this._unbindDS(),this._clearContent(),o.removeClass([this._el],"ria-stackpanel"),this.orientation==="horizontal"&&o.removeClass([this.el],"ria-horizontal-panel"),o.events.offNS(this._el,this.uniqueID),this._currentItem=null,this._itemMap=v(),this._options=v(),n.prototype.dispose.call(this))},t.prototype._onKeyDown=function(n,t){var i=this.dataSource,r=this;if(i){if(this.orientation==="horizontal")switch(n){case 37:t.preventDefault();this._isKeyNavigation=!0;i.movePrev(!0)&&r.scrollToItem(i.currentItem,!0);break;case 39:t.preventDefault();this._isKeyNavigation=!0;i.moveNext(!0)&&r.scrollToItem(i.currentItem,!1)}else switch(n){case 38:t.preventDefault();this._isKeyNavigation=!0;i.movePrev(!0)&&r.scrollToItem(i.currentItem,!0);break;case 40:t.preventDefault();this._isKeyNavigation=!0;i.moveNext(!0)&&r.scrollToItem(i.currentItem,!1)}this._isKeyNavigation=!1}},t.prototype._onKeyUp=function(){},t.prototype._updateCurrent=function(n,t){var r=this,u=r._currentItem,i;u!==n&&(this._currentItem=n,!u||(i=r._itemMap[u._key],!i||o.removeClass([i.el],"ria-current-item")),!n||(i=r._itemMap[n._key],!i||(o.addClass([i.el],"ria-current-item"),t&&!this._isKeyNavigation&&this.scrollToCurrent(!1))),this.objEvents.raiseProp("currentItem"))},t.prototype._onDSCurrentChanged=function(){var t=this.dataSource,n=t.currentItem;this._updateCurrent(n,!!n)},t.prototype._onDSCollectionChanged=function(n,t){var r=this,u,f,o,e;switch(t.changeType){case 2:r._refresh();break;case 1:r._appendItems(t.items);break;case 0:for(u=0,f=t.items;u<f.length;u++)o=f[u],r._removeItem(o);break;case 3:e=r._itemMap[t.old_key];!e||(delete r._itemMap[t.old_key],r._itemMap[t.new_key]=e);break;default:throw new Error(d(i.LocaleERRS.ERR_COLLECTION_CHANGETYPE_INVALID,t.changeType));}},t.prototype._onItemStatusChanged=function(n,t){var r=n._aspect.status,i=this._itemMap[n._key];i&&(r===3?o.addClass([i.el],"ria-item-deleted"):t===3&&o.removeClass([i.el],"ria-item-deleted"))},t.prototype._createTemplate=function(n,t){var i=u.createTemplate({parentEl:t,dataContext:n});return i.templateID=this.templateID,i},t.prototype._appendItems=function(n){var t=this,i=l.createDocumentFragment();n.forEach(function(n){t._itemMap[n._key]||t._appendItem(i,n)});t.el.appendChild(i)},t.prototype._appendItem=function(n,t){var u=this,i=l.createElement(this._itemTag),r;o.addClass([i],"ria-stackpanel-item");i.setAttribute("data-scope",this.uniqueID);n.appendChild(i);r={el:i,template:null,item:t};o.setData(i,"data",r);u._itemMap[t._key]=r;r.template=u._createTemplate(t,r.el)},t.prototype._bindDS=function(){var n=this,t=this.dataSource;t&&(t.addOnCollChanged(n._onDSCollectionChanged,n._uniqueID,n),t.addOnCurrentChanged(n._onDSCurrentChanged,n._uniqueID,n),t.addOnStatusChanged(function(t,i){n._onItemStatusChanged(i.item,i.oldStatus)},n._uniqueID))},t.prototype._unbindDS=function(){var t=this,n=this.dataSource;n&&n.objEvents.offNS(t._uniqueID)},t.prototype._onItemClicked=function(n,t){this._updateCurrent(t,!1);this.dataSource.currentItem=t;this.objEvents.raise("item_clicked",{item:t})},t.prototype._clearContent=function(){var t=this,r=Object.keys(t._itemMap),n,i,u;if(r.length!==0)for(t._el.innerHTML="",n=0,i=r;n<i.length;n++)u=i[n],t._removeItemByKey(u)},t.prototype._removeItemByKey=function(n){var i=this,t=i._itemMap[n];t&&(delete i._itemMap[n],t.template.dispose(),t.template=null,o.removeNode(t.el))},t.prototype._removeItem=function(n){this._removeItemByKey(n._key)},t.prototype._refresh=function(){var r=this.dataSource,u=this,t,n,i,f;if(this._clearContent(),r){for(t=l.createDocumentFragment(),n=0,i=r.items;n<i.length;n++)f=i[n],u._appendItem(t,f);u.el.appendChild(t)}},t.prototype.setDataSource=function(n){var t=this,i;this._unbindDS();this._options.dataSource=n;i=function(){var n=t._options.dataSource;!n||n.getIsStateDirty()?t._clearContent():(t._bindDS(),t._refresh())};this._options.syncSetDatasource?i():this._debounce.enque(i)},t.prototype.addOnItemClicked=function(n,t,i){this.objEvents.on("item_clicked",n,t,i)},t.prototype.offOnItemClicked=function(n){this.objEvents.off("item_clicked",n)},t.prototype.getDivElementByItem=function(n){var t=this._itemMap[n._key];return t?t.el:null},t.prototype.scrollToItem=function(n,t){var o;if(n&&(o=this._itemMap[n._key],o)){var i=this.orientation==="vertical",s=o.el,r=this._el,h=r.getBoundingClientRect(),c=s.getBoundingClientRect(),l=i?r.clientHeight:r.clientWidth,v=i?s.offsetHeight:s.offsetWidth,u=i?r.scrollTop:r.scrollLeft,f=i?u+c.top-h.top:u+c.left-h.left,y=Math.min(v,l),a=l-y,e=t?Math.floor(f-1):Math.floor(f-a+1);(e<0&&(e=0),u<f&&u>f-a)||(i?this._el.scrollTop=e:this._el.scrollLeft=e)}},t.prototype.scrollToCurrent=function(n){this.scrollToItem(this._currentItem,n)},t.prototype.focus=function(){this.scrollToCurrent(!0);h.selectedControl=this},t.prototype.toString=function(){return"StackPanel"},Object.defineProperty(t.prototype,"selectable",{get:function(){return this._selectable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._uniqueID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"orientation",{get:function(){return this._options.orientation},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"templateID",{get:function(){return this._options.templateID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(n){n!==this.dataSource&&(this.setDataSource(n),this.objEvents.raiseProp("dataSource"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentItem",{get:function(){return this._currentItem},enumerable:!1,configurable:!0}),t}(i.BaseObject);t.StackPanel=y;s=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;r._panelEvents=null;r._panel=new y(t,i);r._panel.addOnItemClicked(function(n,t){if(!!u._panelEvents)u._panelEvents.onItemClicked(t.item)},r.uniqueID);r._panel.objEvents.onProp("*",function(n,t){switch(t.property){case"dataSource":u.objEvents.raiseProp(t.property)}},u.uniqueID);return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._panel.getIsStateDirty()||this._panel.dispose(),this._panelEvents=null,n.prototype.dispose.call(this))},t.prototype.toString=function(){return"StackPanelElView"},Object.defineProperty(t.prototype,"dataSource",{get:function(){return this._panel.dataSource},set:function(n){this._panel.dataSource=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panelEvents",{get:function(){return this._panelEvents},set:function(n){var t=this._panelEvents;n!==t&&(this._panelEvents=n,this.objEvents.raiseProp("panelEvents"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"panel",{get:function(){return this._panel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectable",{get:function(){return this._panel.selectable},enumerable:!1,configurable:!0}),t}(f.BaseElView);t.StackPanelElView=s;h.registerElView("stackpanel",s);h.registerElView("ul",s);h.registerElView("ol",s)});define("jriapp_ui/tabs",["require","exports","jriapp_shared","jriapp_ui/utils/jquery","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TabsElView=void 0;var e=i.Utils,s=e.core,o=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._tabOpts=i,r._tabsEvents=null,r._tabsCreated=!1,r._createTabs(),r}return __extends(t,n),t.prototype._createTabs=function(){var i=r.$(this.el),n=this,t={activate:function(){if(!!n._tabsEvents)n._tabsEvents.onTabSelected(n);n.objEvents.raiseProp("tabIndex")}};t=s.extend(t,n._tabOpts);i.tabs(t);e.queue.enque(function(){n.getIsStateDirty()||(n._tabsCreated=!0,n._onTabsCreated(),n.objEvents.raiseProp("tabIndex"))})},t.prototype._destroyTabs=function(){var n=r.$(this.el);r.JQueryUtils.dispose$Plugin(n,"tabs");this._tabsCreated=!1;!this._tabsEvents||this._tabsEvents.removeTabs()},t.prototype._onTabsCreated=function(){var n=this;if(!n._tabsEvents||n._tabsEvents.addTabs(n),!!n._tabsEvents)n._tabsEvents.onTabSelected(n)},t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._destroyTabs(),this._tabsEvents=null,n.prototype.dispose.call(this))},t.prototype.toString=function(){return"TabsElView"},Object.defineProperty(t.prototype,"tabsEvents",{get:function(){return this._tabsEvents},set:function(n){var t=this._tabsEvents;n!==t&&(!t||t.removeTabs(),this._tabsEvents=n,this.objEvents.raiseProp("tabsEvents"),this._tabsCreated&&this._onTabsCreated())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tabIndex",{get:function(){var n=r.$(this.el);return n.tabs("option","active")},set:function(n){var t=r.$(this.el);t.tabs("option","active",n)},enumerable:!1,configurable:!0}),t}(f.BaseElView);t.TabsElView=o;u.bootstrapper.registerElView("tabs",o)});define("jriapp_ui/template",["require","exports","jriapp_shared","jriapp/utils/viewchecks","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r,u,f){"use strict";var e;Object.defineProperty(t,"__esModule",{value:!0});t.TemplateElView=void 0;var o=i.Utils,s=r.ViewChecks,h=u.bootstrapper,c=o.err;s.isTemplateElView=function(n){return!!n&&n instanceof e};e=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._command=null,r}return __extends(t,n),t.prototype.invokeCommand=function(n){var t=this._command;!t||t.execute(n)},t.prototype.templateLoading=function(){},t.prototype.templateLoaded=function(n,t){var i,r;if(!t){i=this;try{r={template:n,isLoaded:!0};i.invokeCommand(r)}catch(u){c.reThrow(u,this.handleError(u,this))}}},t.prototype.templateUnLoading=function(n){var i=this,t;try{t={template:n,isLoaded:!1};i.invokeCommand(t)}catch(r){this.handleError(r,this)}},t.prototype.toString=function(){return"TemplateElView"},Object.defineProperty(t.prototype,"command",{get:function(){return this._command},set:function(n){n!==this._command&&(this._command=n,this.objEvents.raiseProp("command"))},enumerable:!1,configurable:!0}),t}(f.BaseElView);t.TemplateElView=e;h.registerElView("template",e)});define("jriapp_ui/dataform",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/utils/viewchecks","jriapp/bootstrapper","jriapp_ui/baseview","jriapp_ui/content/int"],function(n,t,i,r,u,f,e,o){"use strict";function d(n,t){return n?!!n._aspect&&p(n._aspect.getFieldInfo)?n._aspect.getFieldInfo(t):p(n.getFieldInfo)?n.getFieldInfo(t):null:null}function g(){return l.getSvc("IUIErrorsService")}var a,v;Object.defineProperty(t,"__esModule",{value:!0});t.DataFormElView=t.DataForm=void 0;var s=i.Utils,y=r.DomUtils,p=s.check.isFunc,w=s.core.getNewID,b=s.str.format,c=s.sys,l=f.bootstrapper,h=u.ViewChecks,k=s.async.reject;h.isDataForm=function(n){if(!n)return!1;var t=n.getAttribute("data-view");return t?t==="dataform":!1};h.isInsideDataForm=function(n){if(!n)return!1;var t=n.parentElement;return!t?!1:h.isDataForm(t)?!0:h.isInsideDataForm(t)};h.isInNestedForm=function(n,t,i){var f=t.length,r,u;if(f===0)return!1;for(r=i.parentElement;!!r;){for(u=0;u<f;u+=1)if(r===t[u])return!0;if(!!n&&r===n)return!1;r=r.parentElement}return!1};h.getParentDataForm=function(n,t){if(!t)return null;var i=t.parentElement;return!i?null:i===n?n:h.isDataForm(i)?i:h.getParentDataForm(n,i)};a=function(n){function t(t,i){var r=n.call(this)||this,u=r,f;return r._el=t,r._uniqueID=w("frm"),r._dataContext=null,r._errorsService=i.formErrorsService?i.formErrorsService:g(),y.addClass([t],"ria-dataform"),r._isEditing=!1,r._content=[],r._lfTime=null,r._contentCreated=!1,r._editable=null,r._errNotification=null,r._parentDataForm=null,r._contentPromise=null,f=h.getParentDataForm(null,t),!f||(u._parentDataForm=r.app.viewFactory.getElView(f),u._parentDataForm.objEvents.addOnDisposed(function(){u.getIsStateDirty()||u.dispose()},u._uniqueID)),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();this._setErrors(null);this._clearContent();y.removeClass([this.el],"ria-dataform");this._unbindDS();var t=this._parentDataForm;this._parentDataForm=null;!t||t.getIsStateDirty()||t.objEvents.offNS(this._uniqueID);this._dataContext=null;this._errorsService=null;this._contentCreated=!1;this._contentPromise=null;this._el=null;n.prototype.dispose.call(this)}},t.prototype._getBindings=function(){return this._lfTime?this._lfTime.findAll(c.isBinding):[]},t.prototype._createContent=function(){var u=this._dataContext,r=this,f,c,e,v,n,y,a,p;if(!u)return k("DataForm's DataContext is not set");var w=s.arr.fromList(this._el.querySelectorAll(t._DATA_CONTENT_SELECTOR)),g=this.isEditing,nt=s.arr.fromList(this._el.querySelectorAll(t._DATA_FORM_SELECTOR));for(f=0,c=w;f<c.length;f++)if(e=c[f],!h.isInNestedForm(r._el,nt,e)){if(v=e.getAttribute("data-content"),n=o.parseContentAttr(v),!!n.fieldName&&!n.fieldInfo&&(n.fieldInfo=d(u,n.fieldName),!n.fieldInfo))throw new Error(b(i.LocaleERRS.ERR_DBSET_INVALID_FIELDNAME,"",n.fieldName));y=l.contentFactory.getContentType(n);a=new y({parentEl:e,contentOptions:n,dataContext:u,isEditing:g});r._content.push(a);a.render()}return p=r.app._getInternal().bindElements({scope:this._el,bind:2,dataContext:u}),p.then(function(n){var e,t,i,f;if(r.getIsStateDirty()){n.dispose();return}for(r._lfTime=n,e=r._getBindings(),t=0,i=e;t<i.length;t++)f=i[t],f.isSourceFixed||(f.source=u);r._contentCreated=!0})},t.prototype._updateCreatedContent=function(){var e=this._dataContext,c=this,n,i,r,o,t,u,f;try{for(n=0,i=this._content;n<i.length;n++)r=i[n],r.dataContext=e,r.isEditing=c.isEditing;for(o=this._getBindings(),t=0,u=o;t<u.length;t++)f=u[t],f.isSourceFixed||(f.source=e)}catch(h){s.err.reThrow(h,this.handleError(h,this))}},t.prototype._updateContent=function(){var n=this;try{n._contentCreated?n._updateCreatedContent():n._contentPromise?n._contentPromise.then(function(){n.getIsStateDirty()||n._updateCreatedContent()},function(t){n.getIsStateDirty()||n.handleError(t,n)}):n._contentPromise=n._createContent()}catch(t){s.err.reThrow(t,n.handleError(t,n))}},t.prototype._onDSErrorsChanged=function(){if(!!this._errNotification){var n=this._errNotification.getAllErrors();this._setErrors(n)}},t.prototype._bindDS=function(){var t=this._dataContext,n=this;if(t){if(!t||(this._editable=c.getEditable(t),this._errNotification=c.getErrorNotification(t)),t.objEvents.addOnDisposed(function(){n.dataContext=null},n._uniqueID),!!this._editable)this._editable.objEvents.onProp("isEditing",n._onIsEditingChanged,n._uniqueID,n);!this._errNotification||this._errNotification.addOnErrorsChanged(n._onDSErrorsChanged,n._uniqueID,n)}},t.prototype._unbindDS=function(){var n=this._dataContext;this._setErrors(null);!n||n.getIsStateDirty()||(n.objEvents.offNS(this._uniqueID),!this._editable||this._editable.objEvents.offNS(this._uniqueID),!this._errNotification||this._errNotification.offOnErrorsChanged(this._uniqueID));this._editable=null;this._errNotification=null},t.prototype._clearContent=function(){for(var i,n=0,t=this._content;n<t.length;n++)i=t[n],i.dispose();this._content=[];!this._lfTime||(this._lfTime.dispose(),this._lfTime=null);this._contentCreated=!1},t.prototype._setErrors=function(n){this._errorsService.setFormErrors(this.el,n)},t.prototype._onIsEditingChanged=function(){this.isEditing=this._editable.isEditing},t.prototype.toString=function(){return"DataForm"},Object.defineProperty(t.prototype,"app",{get:function(){return l.app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"el",{get:function(){return this._el},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._dataContext},set:function(n){if(n!==this._dataContext){if(!!n&&!c.isBaseObj(n))throw new Error(i.LocaleERRS.ERR_DATAFRM_DCTX_INVALID);this._unbindDS();this._dataContext=n;this._bindDS();this._updateContent();!this._dataContext||(!this._editable||this._isEditing===this._editable.isEditing||(this.isEditing=this._editable.isEditing),!this._errNotification||this._onDSErrorsChanged());this.objEvents.raiseProp("dataContext")}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEditing",{get:function(){return this._isEditing},set:function(n){var r=this._dataContext,i,t;if(r){if(i=this._isEditing,!this._editable||(t=this._editable),!t&&n!==i){this._isEditing=n;this._updateContent();this.objEvents.raiseProp("isEditing");return}if(n!==i&&!!t)try{n?t.beginEdit():t.endEdit()}catch(u){s.err.reThrow(u,this.handleError(u,r))}!t||t.isEditing===i||(this._isEditing=t.isEditing,this._updateContent(),this.objEvents.raiseProp("isEditing"))}},enumerable:!1,configurable:!0}),t._DATA_FORM_SELECTOR="*[data-view='dataform']",t._DATA_CONTENT_SELECTOR="*[data-content]:not([data-column])",t}(i.BaseObject);t.DataForm=a;v=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;r._form=new a(t,i);r._form.objEvents.onProp("dataContext",function(){u.objEvents.raiseProp("dataContext")},r.uniqueID);return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._form.getIsStateDirty()||this._form.dispose(),n.prototype.dispose.call(this))},t.prototype._setErrors=function(){},t.prototype.toString=function(){return"DataFormElView"},Object.defineProperty(t.prototype,"dataContext",{get:function(){return this._form.dataContext},set:function(n){this.dataContext!==n&&(this._form.dataContext=n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"form",{get:function(){return this._form},enumerable:!1,configurable:!0}),t}(e.BaseElView);t.DataFormElView=v;l.registerElView("dataform",v)});define("jriapp_ui/datepicker",["require","exports","jriapp/bootstrapper","jriapp_ui/textbox"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DatePickerElView=void 0;var u=i.bootstrapper,f=function(n){function t(t,i){var r=n.call(this,t,i)||this,f=u.getSvc("IDatepicker");if(!f)throw new Error("IDatepicker service is not registered");return f.attachTo(t,i.datepicker,function(n){t.value=n;r.objEvents.raiseProp("value")}),r}return __extends(t,n),t.prototype.dispose=function(){if(!this.getIsDisposed()){this.setDisposing();var t=u.getSvc("IDatepicker");if(!t)throw new Error("IDatepicker service is not registered");t.detachFrom(this.el);n.prototype.dispose.call(this)}},t.prototype.toString=function(){return"DatePickerElView"},t}(r.TextBoxElView);t.DatePickerElView=f;u.registerElView("datepicker",f)});define("jriapp_ui/command",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp_ui/baseview"],function(n,t,i,r,u){"use strict";var e,f,o,s;Object.defineProperty(t,"__esModule",{value:!0});t.CommandElView=void 0;e=i.Utils;f=r.DomUtils,function(n){n[n.PreventDefault=0]="PreventDefault";n[n.StopPropagation=1]="StopPropagation";n[n.Disabled=2]="Disabled";n[n.NoCheckCanExecute=3]="NoCheckCanExecute"}(o||(o={}));s=function(n){function t(t,r){var u=n.call(this,t,r)||this,e;return u._command=null,u._commandParam=null,u._commandFlags=0,u._debounce=new i.Debounce,u._setCommandFlag(!!r.preventDefault,0),u._setCommandFlag(!!r.stopPropagation,1),e="disabled"in t&&t.disabled,e&&u._setCommandFlag(e,2),u._setCommandFlag(!!r.noCheckCanExecute,3),f.setClass([t],"disabled",u.isEnabled),u}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),this._debounce.dispose(),!this._command||this._command.offOnCanExecuteChanged(this.uniqueID),this._command=null,this._commandParam=null,n.prototype.dispose.call(this))},t.prototype._getCommandFlag=function(n){return!!(this._commandFlags&1<<n)},t.prototype._setCommandFlag=function(n,t){n?this._commandFlags|=1<<t:this._commandFlags&=~(1<<t)},t.prototype._onCanExecuteChanged=function(n){this.isEnabled=n.canExecute(this._getCommandParam())},t.prototype._getCommandParam=function(){return this._commandParam},t.prototype._onCommandChanged=function(){!this._command||this._getCommandFlag(3)||(this.isEnabled=this._command.canExecute(this._getCommandParam()))},t.prototype.invokeCommand=function(){var n=this;!!n.command&&n.isEnabled&&e.queue.enque(function(){if(!n.getIsStateDirty())try{!!n.command&&n.isEnabled&&n.command.execute(n._getCommandParam())}catch(t){n.handleError(t,n)}})},t.prototype.viewMounted=function(){var n=this;this._debounce.enque(function(){n._onCommandChanged()})},t.prototype.toString=function(){return"CommandElView"},Object.defineProperty(t.prototype,"command",{get:function(){return this._command},set:function(n){var t=this;n!==this._command&&(!this._command||this._getCommandFlag(3)||this._command.offOnCanExecuteChanged(this.uniqueID),this._command=n,!this._command||this._getCommandFlag(3)||this._command.addOnCanExecuteChanged(this._onCanExecuteChanged,this.uniqueID,this),this._debounce.enque(function(){t._onCommandChanged()}),this.objEvents.raiseProp("command"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"commandParam",{get:function(){return this._commandParam},set:function(n){var t=this;n!==this._commandParam&&(this._commandParam=n,this._debounce.enque(function(){t._onCommandChanged()}),this.objEvents.raiseProp("commandParam"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){var n=this.el;return"disabled"in this.el?!n.disabled:!this._getCommandFlag(2)},set:function(n){var t=this.el;n!==this.isEnabled&&("disabled"in this.el?(t.disabled=!n,this._setCommandFlag(!n,2)):this._setCommandFlag(!n,2),f.setClass([this.el],"disabled",!!n),this.objEvents.raiseProp("isEnabled"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"preventDefault",{get:function(){return this._getCommandFlag(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stopPropagation",{get:function(){return this._getCommandFlag(1)},enumerable:!1,configurable:!0}),t}(u.BaseElView);t.CommandElView=s});define("jriapp_ui/anchor",["require","exports","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/command"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnchorElView=void 0;var f=i.DomUtils,o=r.bootstrapper,s=r.subscribeWeakMap,e=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;if(r._imageSrc=null,r._image=null,r._span=null,r._glyph=null,!i.imageSrc||(r.imageSrc=i.imageSrc),!i.glyph||(r.glyph=i.glyph),f.addClass([t],"ria-command-link"),r.isDelegationOn)s.set(t,r),r._setIsSubcribed(1);else f.events.on(t,"click",function(n){u.handle_click(n)},r.uniqueID);return r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),f.removeClass([this.el],"ria-command-link"),this.imageSrc=null,this.glyph=null,n.prototype.dispose.call(this))},t.prototype.handle_click=function(n){return this.stopPropagation&&n.stopPropagation(),this.preventDefault&&n.preventDefault(),this.onClick(),this.stopPropagation},t.prototype.onClick=function(){this.invokeCommand()},t.prototype._updateImage=function(n){var t=this.el;if(this._imageSrc!==n){if(this._imageSrc=n,!!this._image&&!n){f.removeNode(this._image);this._image=null;return}!n||(this._image||(t.innerHTML="",this._image=new Image,t.appendChild(this._image)),this._image.src=n)}},t.prototype._updateGlyph=function(n){var i=this.el,t;if(this._glyph!==n){if(t=this._glyph,this._glyph=n,!!t&&!n){f.removeNode(this._span);return}!n||(this._span||(i.innerHTML="",this._span=f.document.createElement("span"),i.appendChild(this._span)),!t||f.removeClass([this._span],t),f.addClass([this._span],n))}},t.prototype.toString=function(){return"AnchorElView"},Object.defineProperty(t.prototype,"imageSrc",{get:function(){return this._imageSrc},set:function(n){var t=this._imageSrc;t!==n&&(this._updateImage(n),this.objEvents.raiseProp("imageSrc"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"glyph",{get:function(){return this._glyph},set:function(n){var t=this._glyph;t!==n&&(this._updateGlyph(n),this.objEvents.raiseProp("glyph"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this.el.innerHTML},set:function(n){var t=this.el.innerHTML;n=n?""+n:"";t!==n&&(this.el.innerHTML=n,this.objEvents.raiseProp("html"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.el.textContent},set:function(n){var t=this.el.textContent;n=n?""+n:"";t!==n&&(this.el.textContent=n,this.objEvents.raiseProp("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"href",{get:function(){return this.el.href},set:function(n){var t=this.href;n=n?""+n:"";t!==n&&(this.el.href=n,this.objEvents.raiseProp("href"))},enumerable:!1,configurable:!0}),t}(u.CommandElView);t.AnchorElView=e;o.registerElView("a",e);o.registerElView("abutton",e)});define("jriapp_ui/span",["require","exports","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SpanElView=void 0;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"SpanElView"},Object.defineProperty(t.prototype,"text",{get:function(){return this.el.textContent},set:function(n){var t=this.el,i=t.textContent,r=""+n;n=n===null?"":r;i!==n&&(t.textContent=n,this.objEvents.raiseProp("text"),this.objEvents.raiseProp("value"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.text},set:function(n){this.text=n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this.el.innerHTML},set:function(n){var t=this.el,i=this.el.innerHTML,r=""+n;n=n===null?"":r;i!==n&&(t.innerHTML=n,this.objEvents.raiseProp("html"))},enumerable:!1,configurable:!0}),t}(r.BaseElView);t.SpanElView=u;i.bootstrapper.registerElView("span",u)});define("jriapp_ui/block",["require","exports","jriapp/bootstrapper","jriapp_ui/span"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BlockElView=void 0;var f=i.bootstrapper,u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"BlockElView"},Object.defineProperty(t.prototype,"width",{get:function(){return this.el.offsetWidth},set:function(n){var t=this.width;n!==t&&(this.el.style.width=n+"px",this.objEvents.raiseProp("width"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.el.offsetHeight},set:function(n){var t=this.height;n!==t&&(this.el.style.height=n+"px",this.objEvents.raiseProp("height"))},enumerable:!1,configurable:!0}),t}(r.SpanElView);t.BlockElView=u;f.registerElView("block",u);f.registerElView("div",u);f.registerElView("section",u)});define("jriapp_ui/busy",["require","exports","jriapp_shared","jriapp_ui/utils/jquery","jriapp/bootstrapper","jriapp/utils/dom","jriapp_ui/baseview"],function(n,t,i,r,u,f,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BusyElView=void 0;var h=i.Utils.check.isNt,s=u.bootstrapper,c=f.DomUtils,o=function(n){function t(t,i){var r=n.call(this,t,i)||this,f;return f=i.img?i.img:"loader.gif",r._delay=400,r._timeOut=null,h(i.delay)||(r._delay=parseInt(""+i.delay)),r._loaderPath=u.bootstrapper.getImagePath(f),r._img=new Image,r._img.style.position="absolute",r._img.style.display="none",r._img.style.zIndex="10000",r._img.src=r._loaderPath,r.el.appendChild(r._img),r._isBusy=!1,r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._timeOut||(clearTimeout(this._timeOut),this._timeOut=null),c.removeNode(this._img),n.prototype.dispose.call(this))},t.prototype.toString=function(){return"BusyElView"},Object.defineProperty(t.prototype,"isBusy",{get:function(){return this._isBusy},set:function(n){var t=this,i=function(){t._timeOut=null;t._img.style.display="";r.$(t._img).position({of:r.$(t.el)})};n!==t._isBusy&&(t._isBusy=n,t._isBusy?(!t._timeOut||(clearTimeout(t._timeOut),t._timeOut=null),t._timeOut=setTimeout(i,t._delay)):t._timeOut?(clearTimeout(t._timeOut),t._timeOut=null):t._img.style.display="none",t.objEvents.raiseProp("isBusy"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this._delay},set:function(n){n!==this._delay&&(this._delay=n,this.objEvents.raiseProp("delay"))},enumerable:!1,configurable:!0}),t}(e.BaseElView);t.BusyElView=o;s.registerElView("busy",o);s.registerElView("busy_indicator",o)});define("jriapp_ui/button",["require","exports","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/command"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ButtonElView=void 0;var e=r.bootstrapper,o=i.DomUtils,s=r.subscribeWeakMap,f=function(n){function t(t,i){var r=n.call(this,t,i)||this,u=r;if(r._isButton=r.el.tagName.toLowerCase()==="button",r.isDelegationOn)s.set(t,r),r._setIsSubcribed(1);else o.events.on(t,"click",function(n){u.handle_click(n)},r.uniqueID);return r}return __extends(t,n),t.prototype.handle_click=function(n){return this.stopPropagation&&n.stopPropagation(),this.preventDefault&&n.preventDefault(),this.onClick(),this.stopPropagation},t.prototype.onClick=function(){this.invokeCommand()},t.prototype.toString=function(){return"ButtonElView"},Object.defineProperty(t.prototype,"value",{get:function(){return this._isButton?this.el.textContent:this.el.value},set:function(n){var t=this.value;n=n?""+n:"";t!==n&&(this._isButton?this.el.textContent=n:this.el.value=n,this.objEvents.raiseProp("value"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.el.textContent},set:function(n){var t=this.el.textContent;n=n?""+n:"";t!==n&&(this.el.textContent=n,this.objEvents.raiseProp("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this._isButton?this.el.innerHTML:this.el.value},set:function(n){var t=this.html;n=n?""+n:"";t!==n&&(this._isButton?this.el.innerHTML=n:this.el.value=n,this.objEvents.raiseProp("html"))},enumerable:!1,configurable:!0}),t}(u.CommandElView);t.ButtonElView=f;e.registerElView("input:button",f);e.registerElView("input:submit",f);e.registerElView("button",f)});define("jriapp_ui/checkbox",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/input"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckBoxElView=void 0;var e=r.DomUtils,s=i.Utils.check.isNt,h=u.bootstrapper,c=u.subscribeWeakMap,o=function(n){function t(t,i){var r=n.call(this,t,i)||this,f=r,u;if(r._checked=null,t.checked=!1,r.isDelegationOn)c.set(r.el,r),r._setIsSubcribed(2);else e.events.on(r.el,"change",function(n){n.stopPropagation();f.handle_change(n)},r.uniqueID);return!i.name||(u=e.document.createElement("input"),u.type="hidden",u.name=i.name,e.insertBefore(u,t),r._hidden=u),r._updateState(),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._hidden||(e.removeNode(this._hidden),this._hidden=null),n.prototype.dispose.call(this))},t.prototype.handle_change=function(){var n=this.el;return this.checked!==n.checked&&(this.checked=n.checked),!0},t.prototype._updateState=function(){e.setClass([this.el],"ria-checked-null",!s(this.checked))},t.prototype._setErrors=function(t,i){var r=t.parentElement,u=!!r&&r.tagName.toLowerCase()==="label"?r:t;n.prototype._setErrors.call(this,u,i)},t.prototype.toString=function(){return"CheckBoxElView"},Object.defineProperty(t.prototype,"checked",{get:function(){return this._checked},set:function(n){if(this._checked!==n){this._checked=n;var t=this.el;t.checked=!!n;this._updateState();!this._hidden||(this._hidden.value=!this._checked?s(this._checked)?"":"0":"1");this.objEvents.raiseProp("checked")}},enumerable:!1,configurable:!0}),t}(f.InputElView);t.CheckBoxElView=o;h.registerElView("input:checkbox",o);h.registerElView("checkbox",o)});define("jriapp_ui/checkbox3",["require","exports","jriapp_shared","jriapp/utils/dom","jriapp/bootstrapper","jriapp_ui/input"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckBoxThreeStateElView=void 0;var o=i.Utils.check.isNt,e=r.DomUtils,h=u.bootstrapper,c=u.subscribeWeakMap,s=function(n){function t(t,i){var r=n.call(this,t,i)||this,f=r,u;if(r._checked=null,t.checked=!1,t.indeterminate=r._checked===null,r.isDelegationOn)c.set(r.el,r),r._setIsSubcribed(2);else e.events.on(r.el,"change",function(n){n.stopPropagation();f.handle_change(n)},r.uniqueID);return!i.name||(u=e.document.createElement("input"),u.type="hidden",u.name=i.name,e.insertBefore(u,t),r._hidden=u),r._updateState(),r}return __extends(t,n),t.prototype.dispose=function(){this.getIsDisposed()||(this.setDisposing(),!this._hidden||(e.removeNode(this._hidden),this._hidden=null),n.prototype.dispose.call(this))},t.prototype.handle_change=function(){return this.checked=this.checked===null?!0:this.checked?!1:null,!0},t.prototype._updateState=function(){e.setClass([this.el],"ria-checked-null",!o(this.checked))},t.prototype._setErrors=function(t,i){var r=t.parentElement,u=!!r&&r.tagName.toLowerCase()==="label"?r:t;n.prototype._setErrors.call(this,u,i)},t.prototype.toString=function(){return"CheckBoxThreeStateElView"},Object.defineProperty(t.prototype,"checked",{get:function(){return this._checked},set:function(n){if(this._checked!==n){this._checked=n;var t=this.el;t.checked=!!n;t.indeterminate=o(this._checked);this._updateState();!this._hidden||(this._hidden.value=!this._checked?o(this._checked)?"":"0":"1");this.objEvents.raiseProp("checked")}},enumerable:!1,configurable:!0}),t}(f.InputElView);t.CheckBoxThreeStateElView=s;h.registerElView("threeState",s);h.registerElView("checkbox3",s)});define("jriapp_ui/hidden",["require","exports","jriapp/bootstrapper","jriapp_ui/input"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HiddenElView=void 0;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"HiddenElView"},t}(r.InputElView);t.HiddenElView=u;i.bootstrapper.registerElView("input:hidden",u)});define("jriapp_ui/img",["require","exports","jriapp/bootstrapper","jriapp_ui/baseview"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImgElView=void 0;var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"ImgElView"},Object.defineProperty(t.prototype,"src",{get:function(){return this.el.src},set:function(n){var t=this.src;t!==n&&(this.el.src=n,this.objEvents.raiseProp("src"))},enumerable:!1,configurable:!0}),t}(r.BaseElView);t.ImgElView=u;i.bootstrapper.registerElView("img",u)});define("jriapp_ui/radio",["require","exports","jriapp_shared","jriapp/bootstrapper","jriapp_ui/checkbox"],function(n,t,i,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RadioElView=void 0;var e=i.Utils.check.isNt,f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.toString=function(){return"RadioElView"},Object.defineProperty(t.prototype,"value",{get:function(){return this.el.value},set:function(n){var t=e(n)?"":""+n;t!==this.value&&(this.el.value=t,this.objEvents.raiseProp("value"))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.el.name},enumerable:!1,configurable:!0}),t}(u.CheckBoxElView);t.RadioElView=f;r.bootstrapper.registerElView("input:radio",f)});define("jriapp_ui/content/all",["require","exports","jriapp_ui/content/basic","jriapp_ui/content/template","jriapp_ui/content/string","jriapp_ui/content/multyline","jriapp_ui/content/bool","jriapp_ui/content/number","jriapp_ui/content/date","jriapp_ui/content/datetime","jriapp_ui/content/lookup"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LookupContent=t.DateTimeContent=t.DateContent=t.NumberContent=t.BoolContent=t.MultyLineContent=t.StringContent=t.TemplateContent=t.BasicContent=void 0;Object.defineProperty(t,"BasicContent",{enumerable:!0,get:function(){return i.BasicContent}});Object.defineProperty(t,"TemplateContent",{enumerable:!0,get:function(){return r.TemplateContent}});Object.defineProperty(t,"StringContent",{enumerable:!0,get:function(){return u.StringContent}});Object.defineProperty(t,"MultyLineContent",{enumerable:!0,get:function(){return f.MultyLineContent}});Object.defineProperty(t,"BoolContent",{enumerable:!0,get:function(){return e.BoolContent}});Object.defineProperty(t,"NumberContent",{enumerable:!0,get:function(){return o.NumberContent}});Object.defineProperty(t,"DateContent",{enumerable:!0,get:function(){return s.DateContent}});Object.defineProperty(t,"DateTimeContent",{enumerable:!0,get:function(){return h.DateTimeContent}});Object.defineProperty(t,"LookupContent",{enumerable:!0,get:function(){return c.LookupContent}})});define("jriapp_ui",["require","exports","jriapp/bootstrapper","jriapp_ui/content/factory","jriapp_ui/utils/tooltip","jriapp_ui/utils/datepicker","jriapp_ui/utils/errors","jriapp_ui/dialog","jriapp_ui/dynacontent","jriapp_ui/datagrid/datagrid","jriapp_ui/pager","jriapp_ui/listbox","jriapp_ui/stackpanel","jriapp_ui/tabs","jriapp_ui/baseview","jriapp_ui/template","jriapp_ui/dataform","jriapp_ui/datepicker","jriapp_ui/anchor","jriapp_ui/block","jriapp_ui/busy","jriapp_ui/button","jriapp_ui/checkbox","jriapp_ui/checkbox3","jriapp_ui/command","jriapp_ui/hidden","jriapp_ui/img","jriapp_ui/input","jriapp_ui/radio","jriapp_ui/span","jriapp_ui/textarea","jriapp_ui/textbox","jriapp_ui/utils/dblclick","jriapp_ui/utils/jquery","jriapp_ui/content/all"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VERSION=t.$=t.JQueryUtils=t.DblClick=t.TextBoxElView=t.TextAreaElView=t.SpanElView=t.RadioElView=t.InputElView=t.ImgElView=t.HiddenElView=t.CommandElView=t.CheckBoxThreeStateElView=t.CheckBoxElView=t.ButtonElView=t.BusyElView=t.BlockElView=t.AnchorElView=t.DatePickerElView=t.DataFormElView=t.DataForm=t.TemplateElView=t.addToolTip=t.BaseElView=t.ListBoxElView=t.ListBox=t.getDataGrids=t.findDataGrid=t.ROW_POSITION=t.DataGridElView=t.DataGridRow=t.DataGridColumn=t.DataGrid=t.DynaContentElView=t.DialogVM=t.DataEditDialog=t.DIALOG_ACTION=void 0;Object.defineProperty(t,"DIALOG_ACTION",{enumerable:!0,get:function(){return o.DIALOG_ACTION}});Object.defineProperty(t,"DataEditDialog",{enumerable:!0,get:function(){return o.DataEditDialog}});Object.defineProperty(t,"DialogVM",{enumerable:!0,get:function(){return o.DialogVM}});Object.defineProperty(t,"DynaContentElView",{enumerable:!0,get:function(){return s.DynaContentElView}});Object.defineProperty(t,"DataGrid",{enumerable:!0,get:function(){return h.DataGrid}});Object.defineProperty(t,"DataGridColumn",{enumerable:!0,get:function(){return h.DataGridColumn}});Object.defineProperty(t,"DataGridRow",{enumerable:!0,get:function(){return h.DataGridRow}});Object.defineProperty(t,"DataGridElView",{enumerable:!0,get:function(){return h.DataGridElView}});Object.defineProperty(t,"ROW_POSITION",{enumerable:!0,get:function(){return h.ROW_POSITION}});Object.defineProperty(t,"findDataGrid",{enumerable:!0,get:function(){return h.findDataGrid}});Object.defineProperty(t,"getDataGrids",{enumerable:!0,get:function(){return h.getDataGrids}});__exportStar(c,t);Object.defineProperty(t,"ListBox",{enumerable:!0,get:function(){return l.ListBox}});Object.defineProperty(t,"ListBoxElView",{enumerable:!0,get:function(){return l.ListBoxElView}});__exportStar(a,t);__exportStar(v,t);Object.defineProperty(t,"BaseElView",{enumerable:!0,get:function(){return y.BaseElView}});Object.defineProperty(t,"addToolTip",{enumerable:!0,get:function(){return y.addToolTip}});Object.defineProperty(t,"TemplateElView",{enumerable:!0,get:function(){return p.TemplateElView}});Object.defineProperty(t,"DataForm",{enumerable:!0,get:function(){return w.DataForm}});Object.defineProperty(t,"DataFormElView",{enumerable:!0,get:function(){return w.DataFormElView}});Object.defineProperty(t,"DatePickerElView",{enumerable:!0,get:function(){return b.DatePickerElView}});Object.defineProperty(t,"AnchorElView",{enumerable:!0,get:function(){return k.AnchorElView}});Object.defineProperty(t,"BlockElView",{enumerable:!0,get:function(){return d.BlockElView}});Object.defineProperty(t,"BusyElView",{enumerable:!0,get:function(){return g.BusyElView}});Object.defineProperty(t,"ButtonElView",{enumerable:!0,get:function(){return nt.ButtonElView}});Object.defineProperty(t,"CheckBoxElView",{enumerable:!0,get:function(){return tt.CheckBoxElView}});Object.defineProperty(t,"CheckBoxThreeStateElView",{enumerable:!0,get:function(){return it.CheckBoxThreeStateElView}});Object.defineProperty(t,"CommandElView",{enumerable:!0,get:function(){return rt.CommandElView}});Object.defineProperty(t,"HiddenElView",{enumerable:!0,get:function(){return ut.HiddenElView}});Object.defineProperty(t,"ImgElView",{enumerable:!0,get:function(){return ft.ImgElView}});Object.defineProperty(t,"InputElView",{enumerable:!0,get:function(){return et.InputElView}});Object.defineProperty(t,"RadioElView",{enumerable:!0,get:function(){return ot.RadioElView}});Object.defineProperty(t,"SpanElView",{enumerable:!0,get:function(){return st.SpanElView}});Object.defineProperty(t,"TextAreaElView",{enumerable:!0,get:function(){return ht.TextAreaElView}});Object.defineProperty(t,"TextBoxElView",{enumerable:!0,get:function(){return ct.TextBoxElView}});Object.defineProperty(t,"DblClick",{enumerable:!0,get:function(){return lt.DblClick}});Object.defineProperty(t,"JQueryUtils",{enumerable:!0,get:function(){return at.JQueryUtils}});Object.defineProperty(t,"$",{enumerable:!0,get:function(){return at.$}});__exportStar(vt,t);t.VERSION="4.0.7";var yt=i.bootstrapper;r.initContentFactory();yt.registerSvc("ITooltipService",u.createToolTipSvc());yt.registerSvc("IDatepicker",f.createDatepickerSvc());yt.registerSvc("IUIErrorsService",e.createUIErrorsSvc());yt.loadOwnStyle("jriapp_ui")});define("jriapp_ru",["require","exports","jriapp_shared/lang","jriapp/bootstrapper"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.assign(i.STRS,{PAGER:{firstText:"<<",lastText:">>",previousText:"<",nextText:">",pageInfo:"Записи с <span class='ria-pager-info-num'>{0}<\/span> по <span class='ria-pager-info-num'>{1}<\/span> из <span class='ria-pager-info-num'>{2}<\/span>",firstPageTip:"на 1 страницу",prevPageTip:"назад на {0}",nextPageTip:"вперед на {0}",lastPageTip:"последняя страница",showingTip:"записи от {0} до {1} из {2}",showTip:"показать записи от {0} до {1} из {2}"},VALIDATE:{errorInfo:"Ошибки:",errorField:"поле:"},TEXT:{txtEdit:"Редактировать",txtAddNew:"Добавить",txtDelete:"Удалить",txtCancel:"Отмена",txtOk:"ОК",txtRefresh:"Обновить",txtAskDelete:"Вы уверены, что хотите удалить запись?",txtSubmitting:"Сохранение данных ...",txtSave:"Сохранить",txtClose:"Закрыть",txtField:"Поле"}});i.assign(i.ERRS,{ERR_OBJ_ALREADY_REGISTERED:"Объект с именем: {0} уже зарегестрирован и не может быть перезаписан",ERR_OPTIONS_ALREADY_REGISTERED:"Опции с именем: {0} уже зарегестрированы и не могут быть перезаписаны",ERR_APP_NEED_JQUERY:"Проект зависит от JQuery и не может без него правильно работать",ERR_ASSERTION_FAILED:'Утверждение "{0}" не сработало',ERR_BINDING_CONTENT_NOT_FOUND:"BindingContent не найден",ERR_DBSET_READONLY:"Набор данных: {0} только для чтения и не может редактироваться",ERR_DBSET_INVALID_FIELDNAME:"В наборе данных: {0} не существует поля с именем: {1}",ERR_FIELD_READONLY:"Поле только для чтения и не может быть отредактировано",ERR_FIELD_ISNOT_NULLABLE:"Поле не может быть пустым и должно быть заполнено",ERR_FIELD_WRONG_TYPE:"Значение {0} имеет неверный тип данных. Оно должно иметь тип данных: {1}",ERR_FIELD_MAXLEN:"Значение иммет длинну большую чем разрешено в программе: {0}",ERR_FIELD_DATATYPE:"Неизвестный тип данных: {0}",ERR_FIELD_REGEX:"Значение {0} не прошло проверку на правильность",ERR_FIELD_RANGE:"Значение {0} выходит за диапазон {1} разрешенных значений",ERR_EVENT_INVALID:"Неверное имя события: {0}",ERR_EVENT_INVALID_FUNC:"Неверная функция для события",ERR_MODULE_NOT_REGISTERED:"Модуль: {0} не зарегистрирован",ERR_MODULE_ALREDY_REGISTERED:"Модуль: {0} уже зарегистрирован",ERR_PROP_NAME_EMPTY:"Имя свойства объекта пусто",ERR_PROP_NAME_INVALID:'Объект не имеет свойства с именем: "{0}"',ERR_GLOBAL_SINGLTON:"Объект Global должен быть в единственном экземпляре",ERR_TEMPLATE_ALREADY_REGISTERED:"Шаблон с именем: {0} уже зарегистрирован",ERR_TEMPLATE_NOTREGISTERED:"Шаблон с именем: {0} не зарегистрирован",ERR_TEMPLATE_GROUP_NOTREGISTERED:"Группа шаблонов: {0} не зарегистрирована",ERR_TEMPLATE_HAS_NO_ID:"Шаблон внутри тэга SCRIPT должен иметь аттрибут ID",ERR_OPTIONS_HAS_NO_ID:"Опции внутри тэга SCRIPT должны иметь аттрибут ID",ERR_CONVERTER_NOTREGISTERED:"Конвертор: {0} не зарегистрирован",ERR_OPTIONS_NOTREGISTERED:"Опции: {0} не зарегистрированы",ERR_JQUERY_DATEPICKER_NOTFOUND:"Приложение зависит от JQuery.UI.datepicker и не может без него правильно работать",ERR_PARAM_INVALID:"Параметр: {0} имеет неправильное значение: {1}",ERR_PARAM_INVALID_TYPE:"Параметр: {0} имеет неверный тип. Его тип должен быть {1}",ERR_KEY_IS_EMPTY:"Значение ключа не должно быть пустым",ERR_KEY_IS_NOTFOUND:"Нет сущности с ключом: {0}",ERR_ITEM_IS_ATTACHED:"Неверная операция, по причине: Сущность уже была прикреплена к набору данных",ERR_ITEM_IS_DETACHED:"Неверная операция, по причине: Сущность не прикреплена к набору данных",ERR_ITEM_IS_NOTFOUND:"Неверная операция, по причине: Сущность не найдена",ERR_ITEM_NAME_COLLISION:'В наборе данных "{0}" имя поля: "{1}" уже существует в сущности и не может быть декларирована повторно',ERR_DICTKEY_IS_NOTFOUND:"Неверное имя ключа: {0} в словаре. Поле с таким именем не существует",ERR_DICTKEY_IS_EMPTY:"Ключевое свойство: {0} в словаре должно быть заполненным",ERR_CONV_INVALID_DATE:"Не могу перевести строку: {0} в значение для даты (времени)",ERR_CONV_INVALID_NUM:"Не могу перевести строку: {0} в значение для числа",ERR_QUERY_NAME_NOTFOUND:"Не могу найти запрос с именем: {0}",ERR_QUERY_BETWEEN:'Оператор "BETWEEN" требует два значения',ERR_QUERY_OPERATOR_INVALID:"Неверный оператор {0} в запросе",ERR_OPER_REFRESH_INVALID:"Невозможно обновить сущность в текущем состоянии",ERR_CALC_FIELD_DEFINE:'Поле: "{0}" имеет неверное описание: Вычисляемые поля могут зависеть только от полей сущности',ERR_CALC_FIELD_SELF_DEPEND:'Поле: "{0}" имеет неверное описание: Вычисляемые поля не могут зависеть от самих себя',ERR_DOMAIN_CONTEXT_INITIALIZED:"DbContext уже был иннициализирован",ERR_DOMAIN_CONTEXT_NOT_INITIALIZED:"DbContext не был иннициализирован",ERR_SVC_METH_PARAM_INVALID:"Неверный значение {1} параметра {0} для вызова сервис-метода: {2}",ERR_DB_LOAD_NO_QUERY:"Параметр для запроса требует заполненного значения",ERR_DBSET_NAME_INVALID:"Неверное имя набора данных: {0}",ERR_APP_NAME_NOT_UNIQUE:"Имя приложения: {0} уже зарегистрировано",ERR_ELVIEW_NOT_REGISTERED:"Не могу найти element view: {0}",ERR_ELVIEW_NOT_CREATED:"Не могу создать element view для элемента с Тэгом: {0}",ERR_BIND_TARGET_EMPTY:"Binding target is empty",ERR_BIND_TGTPATH_INVALID:"Binding targetPath has invalid value: {0}",ERR_BIND_MODE_INVALID:"Binding mode has invalid value: {0}",ERR_BIND_TARGET_INVALID:"Binding target must be a descendant of BaseObject",ERR_EXPR_BRACES_INVALID:"Expression {0} has no closing braces",ERR_APP_SETUP_INVALID:"Application's setUp method parameter must be a valid function",ERR_GRID_DATASRC_INVALID:"DataGrid's datasource must be a descendant of Collection type",ERR_COLLECTION_CHANGETYPE_INVALID:"Invalid Collection change type value: {0}",ERR_GRID_COLTYPE_INVALID:"Invalid Column type type value: {0}",ERR_PAGER_DATASRC_INVALID:"Pager datasource must be a descendant of Collection type",ERR_STACKPNL_DATASRC_INVALID:"StackPanel datasource must be a descendant of Collection type",ERR_STACKPNL_TEMPLATE_INVALID:"StackPanel templateID is not provided in the options",ERR_LISTBOX_DATASRC_INVALID:"ListBox datasource must be a descendant of Collection type",ERR_DATAFRM_DCTX_INVALID:"DataForm's dataContext must be a descendant of BaseObject type",ERR_DCTX_HAS_NO_FIELDINFO:"DataContext has no getFieldInfo method",ERR_TEMPLATE_ID_INVALID:"Элемент с TemplateID: {0} не существует",ERR_ITEM_DELETED_BY_ANOTHER_USER:"Запись была удалена другим пользователем",ERR_ACCESS_DENIED:"Операция не разрешена. Попросите администратора дать Вам права для ее осуществления",ERR_CONCURRENCY:"Запись была изменена другим пользователем. Обновите запись перед ее редактированием.",ERR_VALIDATION:"Проверка на корректность не прошла успешно. Проверьте правильность введенных данных",ERR_SVC_VALIDATION:"Проверка на корректность: {0}",ERR_SVC_ERROR:"Ошибка сервера: {0}",ERR_UNEXPECTED_SVC_ERROR:"Неожиданная ошибка сервера: {0}",ERR_ASSOC_NAME_INVALID:"Invalid association name: {0}",ERR_DATAVIEW_DATASRC_INVALID:"TDataView datasource must not be null and should be descendant of Collection type",ERR_DATAVIEW_FILTER_INVALID:"TDataView fn_filter option must be valid function which accepts entity and returns boolean value"});r.bootstrapper.addOnInitialize(function(n){var t=n.getSvc("IDatepicker");if(!t)throw new Error("IDatepicker service is not registered");$.datepicker.regional.ru={closeText:"Закрыть",prevText:"&#x3c;Пред",nextText:"След&#x3e;",currentText:"Сегодня",monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthNamesShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],dayNames:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],dayNamesShort:["вск","пнд","втр","срд","чтв","птн","сбт"],dayNamesMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],dateFormat:"dd.mm.yy",firstDay:1,isRTL:!1};t.datepickerRegion="ru"})});